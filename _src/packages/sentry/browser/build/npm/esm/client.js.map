{"version":3,"file":"client.js","sources":["../../../../../../../node_modules/@sentry/browser/build/npm/esm/client.js"],"sourcesContent":["import { Client, getSDKSource, applySdkMetadata, _INTERNAL_flushLogsBuffer, addAutoIpAddressToUser, addAutoIpAddressToSession } from '@sentry/core';\nimport { eventFromException, eventFromMessage } from './eventbuilder.js';\nimport { WINDOW } from './helpers.js';\n\nconst DEFAULT_FLUSH_INTERVAL = 5000;\n\n/**\n * Configuration options for the Sentry Browser SDK.\n * @see @sentry/core Options for more information.\n */\n\n/**\n * The Sentry Browser SDK Client.\n *\n * @see BrowserOptions for documentation on configuration options.\n * @see SentryClient for usage documentation.\n */\nclass BrowserClient extends Client {\n\n  /**\n   * Creates a new Browser SDK instance.\n   *\n   * @param options Configuration options for this SDK.\n   */\n   constructor(options) {\n    const opts = {\n      // We default this to true, as it is the safer scenario\n      parentSpanIsAlwaysRootSpan: true,\n      ...options,\n    };\n    const sdkSource = WINDOW.SENTRY_SDK_SOURCE || getSDKSource();\n    applySdkMetadata(opts, 'browser', ['browser'], sdkSource);\n\n    super(opts);\n\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const client = this;\n    const { sendDefaultPii, _experiments } = client._options;\n    const enableLogs = _experiments?.enableLogs;\n\n    if (opts.sendClientReports && WINDOW.document) {\n      WINDOW.document.addEventListener('visibilitychange', () => {\n        if (WINDOW.document.visibilityState === 'hidden') {\n          this._flushOutcomes();\n          if (enableLogs) {\n            _INTERNAL_flushLogsBuffer(client);\n          }\n        }\n      });\n    }\n\n    if (enableLogs) {\n      client.on('flush', () => {\n        _INTERNAL_flushLogsBuffer(client);\n      });\n\n      client.on('afterCaptureLog', () => {\n        if (client._logFlushIdleTimeout) {\n          clearTimeout(client._logFlushIdleTimeout);\n        }\n\n        client._logFlushIdleTimeout = setTimeout(() => {\n          _INTERNAL_flushLogsBuffer(client);\n        }, DEFAULT_FLUSH_INTERVAL);\n      });\n    }\n\n    if (sendDefaultPii) {\n      client.on('postprocessEvent', addAutoIpAddressToUser);\n      client.on('beforeSendSession', addAutoIpAddressToSession);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n   eventFromException(exception, hint) {\n    return eventFromException(this._options.stackParser, exception, hint, this._options.attachStacktrace);\n  }\n\n  /**\n   * @inheritDoc\n   */\n   eventFromMessage(\n    message,\n    level = 'info',\n    hint,\n  ) {\n    return eventFromMessage(this._options.stackParser, message, level, hint, this._options.attachStacktrace);\n  }\n\n  /**\n   * @inheritDoc\n   */\n   _prepareEvent(\n    event,\n    hint,\n    currentScope,\n    isolationScope,\n  ) {\n    event.platform = event.platform || 'javascript';\n\n    return super._prepareEvent(event, hint, currentScope, isolationScope);\n  }\n}\n\nexport { BrowserClient };\n//# sourceMappingURL=client.js.map\n"],"names":["DEFAULT_FLUSH_INTERVAL","BrowserClient","Client","options","opts","sdkSource","WINDOW","getSDKSource","applySdkMetadata","client","sendDefaultPii","_experiments","enableLogs","_INTERNAL_flushLogsBuffer","addAutoIpAddressToUser","addAutoIpAddressToSession","exception","hint","eventFromException","message","level","eventFromMessage","event","currentScope","isolationScope"],"mappings":"8hBAIA,MAAMA,EAAyB,IAa/B,MAAMC,UAAsBC,CAAO,CAOhC,YAAYC,EAAS,CACpB,MAAMC,EAAO,CAEX,2BAA4B,GAC5B,GAAGD,CACJ,EACKE,EAAYC,EAAO,mBAAqBC,EAAc,EAC5DC,EAAiBJ,EAAM,UAAW,CAAC,SAAS,EAAGC,CAAS,EAExD,MAAMD,CAAI,EAGV,MAAMK,EAAS,KACT,CAAE,eAAAC,EAAgB,aAAAC,CAAc,EAAGF,EAAO,SAC1CG,EAAaD,GAAc,WAE7BP,EAAK,mBAAqBE,EAAO,UACnCA,EAAO,SAAS,iBAAiB,mBAAoB,IAAM,CACrDA,EAAO,SAAS,kBAAoB,WACtC,KAAK,eAAgB,EACjBM,GACFC,EAA0BJ,CAAM,EAG5C,CAAO,EAGCG,IACFH,EAAO,GAAG,QAAS,IAAM,CACvBI,EAA0BJ,CAAM,CACxC,CAAO,EAEDA,EAAO,GAAG,kBAAmB,IAAM,CAC7BA,EAAO,sBACT,aAAaA,EAAO,oBAAoB,EAG1CA,EAAO,qBAAuB,WAAW,IAAM,CAC7CI,EAA0BJ,CAAM,CACjC,EAAET,CAAsB,CACjC,CAAO,GAGCU,IACFD,EAAO,GAAG,mBAAoBK,CAAsB,EACpDL,EAAO,GAAG,oBAAqBM,CAAyB,EAE9D,CAKG,mBAAmBC,EAAWC,EAAM,CACnC,OAAOC,EAAmB,KAAK,SAAS,YAAaF,EAAWC,EAAM,KAAK,SAAS,gBAAgB,CACxG,CAKG,iBACCE,EACAC,EAAQ,OACRH,EACA,CACA,OAAOI,EAAiB,KAAK,SAAS,YAAaF,EAASC,EAAOH,EAAM,KAAK,SAAS,gBAAgB,CAC3G,CAKG,cACCK,EACAL,EACAM,EACAC,EACA,CACA,OAAAF,EAAM,SAAWA,EAAM,UAAY,aAE5B,MAAM,cAAcA,EAAOL,EAAMM,EAAcC,CAAc,CACxE,CACA","x_google_ignoreList":[0]}