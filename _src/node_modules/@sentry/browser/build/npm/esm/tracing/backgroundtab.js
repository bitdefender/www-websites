import{DEBUG_BUILD as a}from"../debug-build.js";import{WINDOW as o}from"../helpers.js";import{getActiveSpan as d,getRootSpan as s,spanToJSON as m}from"../../../../../core/build/esm/utils/spanUtils.js";import{logger as c}from"../../../../../core/build/esm/utils-hoist/logger.js";import{SPAN_STATUS_ERROR as u}from"../../../../../core/build/esm/tracing/spanstatus.js";function b(){o.document?o.document.addEventListener("visibilitychange",()=>{const e=d();if(!e)return;const t=s(e);if(o.document.hidden&&t){const n="cancelled",{op:i,status:r}=m(t);a&&c.log(`[Tracing] Transaction: ${n} -> since tab moved to the background, op: ${i}`),r||t.setStatus({code:u,message:n}),t.setAttribute("sentry.cancellation_reason","document.hidden"),t.end()}}):a&&c.warn("[Tracing] Could not set up background tab detection due to lack of global document")}export{b as registerBackgroundTabDetection};
//# sourceMappingURL=backgroundtab.js.map
