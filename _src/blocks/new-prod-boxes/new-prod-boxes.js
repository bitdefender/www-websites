const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["scripts/lib-franklin.js","scripts/page.js"])))=>i.map(i=>d[i]);
import{__vitePreload as Ue}from"../../_virtual/preload-helper.js";import{checkIfNotProductPage as Ye,formatPrice as Le,matchHeights as v}from"../../scripts/utils/utils.js";import"../../scripts/libs/store/resolver/resolver.js";import{Store as je,ProductInfo as xe}from"../../scripts/libs/store/store.js";function Ie(t,l,u){let s="discounted||full";return t==="monthly"&&(s=l==="true"?"discounted-monthly-no-decimal||full-monthly":"discounted-monthly||full-monthly",u.endsWith("m")&&(s=l==="true"?"discounted-no-decimal||full":"discounted||full")),s}async function Te(t,l,u=null,s=null,x=null,i=null,e=""){let h=document.createElement("div"),o=document.createElement("span"),f=Ie(x,i,t);o.setAttribute("data-store-price",f);let c='data-store-price="full"',p='data-store-price="discounted||full"';return i==="true"&&(c='data-store-price="full-no-decimal"',p='data-store-price="discounted-no-decimal||full-no-decimal"'),h.innerHTML=`
      <div class="hero-aem__price mt-3">
        <div>
          <span class="prod-oldprice" ${c} data-store-hide="no-price=discounted"></span>
          <span class="prod-save" data-store-hide="no-price=discounted">${l} <span data-store-discount="percentage"></span> </span>
        </div>
        <div class="newprice-container mt-2">
          <span class="prod-newprice"> ${o.outerHTML}  ${e&&`<sup class="per-m">${e.textContent.replace("0","")}</sup>`}</span>
        </div>
        ${s?`<div class="billed">${s.innerHTML.replace("0",`<span class="newprice-2" ${p}></span>`)}</div>`:""}
        <a data-store-buy-link href="#" class="button primary no-arrow">${u?.innerText}</a>
      </div>`,h}function $e(t,l,u,s,x,i="default"){const e=document.createElement("div");e.classList.add("plan-switcher"),e.classList.toggle("addon",i==="addon");let h=["yearly","monthly","3-rd-button"];return i==="addon"&&(h=["add-on-yearly","add-on-monthly"]),Array.from(t.children).forEach((o,f)=>{let c=o.textContent,p=h[f],m=u[f],T=s[f],g=x[f],L=f===0?"checked":"";o.textContent.match(/\[checked\]/g)&&(c=c.replace("[checked]",""),L="checked"),m&&(e.innerHTML+=`
        <input data-store-click-set-product data-store-product-id="${m}" data-store-product-option="${T}-${g}" data-store-product-department="consumer" type="radio" id="${p}-${m.trim()}" name="${l}-${i}" value="${l}-${p}-${m.trim()}" ${L}>
        <label for="${p}-${m.trim()}" class="radio-label">${c}</label><br>
      `)}),e}function Re(t){return Array.from(t).map(l=>`<ul>${Array.from(l.querySelectorAll("tr")).map(x=>{const i=Array.from(x.querySelectorAll("td"));let e=i.length>0&&i[0].textContent.trim()!==""?`${i[0].innerHTML}`:"";const h=i.length>1&&i[1].textContent.trim()!==""?`<span class="white-pill-content">${i[1].innerHTML}</span>`:"";let o="";if(e===""&&(o+="d-none"),e.indexOf("?pill")!==-1){let c=e.match(/\?pill (\w+)/),p=e.match(/<span class="[^"]*">(.*?)<\/span>/);if(c){let m=i[0].querySelector("span");const T=document.createElement("span");if(T.classList.add("blue-pill"),T.innerHTML=`${c[1]}${p?p[0]:""}`,e=e.replace(c[0],`${T.outerHTML}`),m){let g=0;e=e.replace(new RegExp(m.outerHTML,"g"),L=>(g+=1,g===2?"":L))}}}return(e.indexOf("&lt;pill")!==-1||e.indexOf("&lt;")!==-1)&&(o+=" has_arrow",e=e.replace("&lt;-","")),(e.indexOf("-&gt;")!==-1||e.indexOf("&gt;")!==-1)&&(o+=" has_arrow_right",e=e.replace("-&gt;",'<span class="arrow-right"></span>')),e.indexOf("[checkmark]")!==-1&&(e=e.replace("[checkmark]",'<span class="checkmark"></span>')),e.indexOf("[add-on]")!==-1&&(e=e.replace("[add-on]","")),e.indexOf("&lt;&lt;add-on-newprice&gt;&gt;")!==-1&&(e=e.replace("&lt;&lt;add-on-newprice&gt;&gt;",'<span class="add-on-newprice"></span>')),e.indexOf("&lt;&lt;add-on-oldprice&gt;&gt;")!==-1&&(e=e.replace("&lt;&lt;add-on-oldprice&gt;&gt;",'<span class="add-on-oldprice"></span>')),e.indexOf("&lt;&lt;add-on-percent-save&gt;&gt;")!==-1&&(e=e.replace("&lt;&lt;add-on-percent-save&gt;&gt;",'<span class="add-on-percent-save"></span>')),e.indexOf("[[")!==-1&&(e=e.replace("[[","(")),e.indexOf("]]")!==-1&&(e=e.replace("]]",")")),`<li class="${o}">${e}${h}</li>`}).join(" ")}</ul>`)}function We(t){let l=!1;return Array.from(t).map(u=>{Array.from(u.querySelectorAll("tr")).map(x=>{const i=Array.from(x.querySelectorAll("td"));(i.length>0&&i[0].textContent.trim()!==""?`${i[0].innerHTML}`:"").indexOf("[add-on]")!==-1&&(l=!0)})}),l}async function ze(t){const{products:l,familyProducts:u,monthlyProducts:s,pid:x,mainProduct:i,addOnProducts:e,addOnMonthlyProducts:h,type:o,hideDecimals:f,thirdRadioButtonProducts:c,saveText:p,addonProductName:m}=t.closest(".section").dataset,T=t.closest(".section");T.classList.add("we-container");let g=t.closest(".section").querySelector(".default-content-wrapper")?.children,L,M;g&&[...g].forEach(n=>{n.innerHTML.includes("&lt;slider-1 ")&&(n.innerHTML=n.innerHTML.replace("&lt;slider-1 ",""),L=n.innerHTML,n.remove()),n.innerHTML.includes("&lt;slider-2 ")&&(n.innerHTML=n.innerHTML.replace("&lt;slider-2 ",""),M=n.innerHTML,n.remove())});let B=document.createElement("div");if(L&&M){B.classList.add("switchBox"),B.innerHTML=`
      <label class="switch">
        <input type="checkbox" id="switchCheckbox">
        <span class="slider round">

        </span>
        <span class="label right">${L}</span>
        <span class="label left">${M}</span>
      </label>
    `;let n=B.querySelector("#switchCheckbox");n.addEventListener("change",()=>{n.checked?(t.querySelectorAll(".family-box").forEach(d=>{d.style.display="block"}),t.querySelectorAll(".individual-box").forEach(d=>{d.style.display="none"})):(t.querySelectorAll(".family-box").forEach(d=>{d.style.display="none"}),t.querySelectorAll(".individual-box").forEach(d=>{d.style.display="block"}))})}const b=l&&l.replaceAll(" ","").split(","),ge=u&&u.replaceAll(" ","").split(","),Q=b.concat(ge),X=s&&s.replaceAll(" ","").split(","),Z=c&&c.replaceAll(" ","").split(","),N=e&&e.replaceAll(" ","").split(","),ee=N&&N.slice(0,b.length),te=h&&h.replaceAll(" ","").split(","),re=[];if(b.length>=5&&t.classList.add("five-cards"),Q.length&&[...t.children].map(async(n,r)=>{const w=n.querySelector("tbody"),[d,$,ne,j,q,ie,I,R,le,de,ae,ve,W]=[...w.querySelectorAll(":scope > tr")],[S,D,k]=Q[r].split("/"),[we,Se,Ae]=X?X[r].split("/"):[],[Pe,Me,be]=Z?Z[r].split("/"):[],[A,H,O]=N?N[r].split("/"):[],[qe,He,Oe]=te?te[r].split("/"):[],se=de.querySelectorAll("table"),Ce=Re(se);re.push(I);let oe=We(se),F=n.querySelector('a[href*="#buylink"]');F?F.classList.add("button","primary"):F=R.querySelector("a");let ce=document.createElement("div");q&&s&&(ce=$e(q,r,[S,we,Pe],[D,Se,Me],[k,Ae,be]));let G=document.createElement("div");oe&&e&&h&&(G=$e(q,r,[A,qe],[H,He],[O,Oe],"addon"));let V=document.createElement("div");if(ne){let a=ne.children;a=Array.from(a),a.forEach(y=>{V.innerHTML+=`<div class="blueTag">${y.innerHTML}</div>`})}let U=R?.querySelectorAll("a")[1];U&&U.classList.add("button","secondary","no-arrow");let pe=I?.children[0];Array.from(q?.children)?.forEach((a,y)=>{a.textContent.match(/\[checked\]/g)&&(pe=I.children[y])});let z="main-product-loaded";Ye()&&(z="product-loaded");const ue=document.createElement("div");let J="";const he=$.querySelector("a");if($.textContent.trim())if(he){const a=he.getAttribute("href"),y=$.textContent.replace(/(Bitdefender)(?!\s*<br>)/i,"$1<br>");J=`<h4><a href="${a}" title="${$.textContent}">${y}</a></h4>`}else J=`<h4>${$.innerHTML}</h4>`;ue.innerHTML=`
          <div class="prod_box${d.innerText.trim()&&" hasGreenTag"} ${r<b.length?"individual-box":"family-box"}"
          data-store-context data-store-id="${S}" data-store-option="${D}-${k}" data-store-department="consumer" ${b.some(a=>a.includes(S))?`data-store-event="${z}"`:""}>
            <div class="inner_prod_box">
              ${d.innerText.trim()?`<div class="greenTag2">${d.innerText.trim()}</div>`:""}
              ${J}

              <div class="blueTagsWrapper">${V.innerText.trim()?`${V.innerHTML.trim()}`:""}</div>
              ${j.innerText.trim()?`<p class="subtitle${j.innerText.trim().split(/\s+/).length>8?" fixed_height":""}">${j.innerHTML}</p>`:""}
              <hr />
              ${W?.innerText.trim()?`<p class="subtitle-2${W.innerText.trim().split(/\s+/).length>8?" fixed_height":""}">${W.innerText.trim()}</p>`:""}
              ${q?ce.outerHTML:""}
              <div class="hero-aem__prices await-loader"></div>
              ${U?U.outerHTML:""}
              ${le.innerText.trim()?`<div class="undeBuyLink">${le.innerText.trim()}</div>`:""}
              <hr />
              ${de.innerText.trim()?`<div class="benefitsLists">${Ce}</div>`:""}
              <div class="add-on-product" style="display: none;">
                ${ae?"<hr>":""}
                ${G.outerHTML?G.outerHTML:""}
                ${m?`<h4>${m}</h4>`:""}
                <div class="hero-aem__prices__addon"></div>
              </div>
            </div>
          </div>`,t.children[r].outerHTML=ue.innerHTML;let Ee=await Te(S,p,R.querySelector("a"),pe,o,f,ie);t.children[r].querySelector(".hero-aem__prices").appendChild(Ee);let K;oe&&e&&(K=await Te(A,p,ve.querySelector("a"),ae,o,f,ie),t.children[r].querySelector(".hero-aem__prices__addon").appendChild(K));let Y=t.children[r].querySelector(".checkmark");if(Y){let a=Y.closest("ul");a.classList.add("checkmark-list");let y=Y.closest("li");y.removeChild(Y);let C=document.createElement("input");C.setAttribute("type","checkbox"),C.classList.add("checkmark");let P=document.createElement("li");P.innerHTML=`
          ${C.outerHTML}
          <div>${y.innerHTML}</div>`,y.replaceWith(P),t.children[r].querySelector(".add-on-product").setAttribute("data-store-context",""),t.children[r].querySelector(".add-on-product").setAttribute("data-store-id",A),t.children[r].querySelector(".add-on-product").setAttribute("data-store-option",`${H}-${O}`),t.children[r].querySelector(".add-on-product").setAttribute("data-store-department","consumer"),ee&&ee.some(_=>_.includes(A))&&t.children[r].querySelector(".add-on-product").setAttribute("data-store-event",z);let fe=await je.getProducts([new xe(S),new xe(A)]),me=fe[S],E=fe[A];if(E){let _=E.getOption(H,O).getDiscountedPrice("value")-me.getOption(D,k).getDiscountedPrice("value");_=Le(_,me.getCurrency());let _e=P.querySelector(".add-on-newprice");_e.textContent=_;let Be=P.querySelector(".add-on-oldprice");Be.textContent=Le(E.getOption(H,O).getPrice("value"),E.getCurrency());let Ne=P.querySelector(".add-on-percent-save");Ne.textContent=`${K.querySelector(".prod-save").textContent} ${E.getOption(H,O).getDiscount("percentageWithProcent")}`;let ye=P.querySelector(".checkmark");ye.addEventListener("change",()=>{ye.checked?(a.classList.add("checked"),t.children[r].querySelector(".add-on-product").style.display="block"):(a.classList.remove("checked"),t.children[r].querySelector(".add-on-product").style.display="none")})}}}),L&&M&&t.parentNode.insertBefore(B,t),[...t.children].forEach((n,r)=>{n.querySelectorAll(".plan-switcher input").forEach((w,d)=>{w.addEventListener("change",()=>{let $=re[r].children[d]?.innerHTML;$&&(n.querySelector(".billed").innerHTML=$)})})}),window.hj=window.hj||function(...r){(hj.q=hj.q||[]).push(...r)},hj("event","new-prod-boxes"),!(window.location.href.includes("www-landing-pages")||window.location.href.includes("bitdefender.com/pages"))){const{decorateIcons:n}=await Ue(async()=>{const{decorateIcons:r}=await import("../../scripts/lib-franklin.js");return{decorateIcons:r}},__vite__mapDeps([0,1]));n(t.closest(".section"))}T.classList.contains("same-height-lists")&&t.querySelector(".prod_box")?.querySelectorAll("ul")?.forEach((w,d)=>{v(t,`div > ul:nth-of-type(${d+1})`)}),v(t,".subtitle"),v(t,".subtitle-2"),v(t,"h2"),v(t,"h4"),v(t,".plan-switcher"),v(t,".blueTagsWrapper")}export{ze as default};
//# sourceMappingURL=new-prod-boxes.js.map
