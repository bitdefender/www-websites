import{createNanoBlock as m,getDatasetFromSection as b,renderNanoBlocks as E}from"../../scripts/utils/utils.js";const u={blockDataset:null},y=new Map;function g(e){e.style.height=`${e.scrollHeight}px`;const t=()=>{e.removeEventListener("transitionend",t),e.style.height="auto"};e.addEventListener("transitionend",t),e.classList.add("expanded")}function f(e){e.style.height=`${e.scrollHeight}px`,requestAnimationFrame(()=>{e.classList.remove("expanded"),e.style.height=0})}function L(e){return t=>{let s=null;t.target.tagName!=="A"?s=t.target.closest("a"):s=t.target,s.classList.contains("is-open")?(s.classList.remove("is-open"),s.parentNode.children.length>1&&s.parentNode.querySelectorAll(".features-tabs-content").forEach(a=>{f(a)})):(s.classList.add("is-open"),s.parentNode.children.length>1&&s.parentNode.querySelectorAll(".features-tabs-content").forEach(a=>{g(a)}),e.querySelectorAll("li").forEach(a=>{a!==s.parentNode&&(a.children[0].classList.remove("is-open"),a.querySelectorAll(".features-tabs-content").forEach(r=>{f(r)}))}))}}function v(e){const t=document.createElement("ul");return t.classList.add("features-tabs"),e.querySelectorAll("h4").forEach(s=>{const a=document.createElement("li");t.appendChild(a);const r=document.createElement("a");r.setAttribute("href","#"),r.addEventListener("click",c=>{c.preventDefault(),L(t)(c)}),s.childNodes.forEach(c=>{c.nodeType===Node.TEXT_NODE?r.appendChild(document.createTextNode(c.textContent)):r.appendChild(c)}),r.classList.add("features-tabs-title"),a.appendChild(r),r.querySelectorAll(".tag").forEach(c=>{a.appendChild(c)});const l=document.createElement("div");l.classList.add("features-tabs-content"),a.appendChild(l);let n=s.nextElementSibling;for(;n&&n.tagName!=="H4";)l.appendChild(n),n=s.nextElementSibling;t.appendChild(a),s.remove()}),t}function A(e){const t=e.querySelector(".button-container > .button");t&&(t.href="#",t.setAttribute("data-store-buy-link",""))}function N(e,t,s){const a=u.blockDataset.defaultSelection??"5-1",r=document.createElement("div");r.classList.add("price-element-wrapper");const l=document.createElement("div");l.classList.add("prod-oldprice","await-loader"),l.setAttribute("data-store-price","full"),l.setAttribute("data-store-hide","no-price=discounted");const n=document.createElement("DIV");return n.classList.add("price"),n.classList.add("await-loader"),e.setAttribute("data-store-context",""),e.setAttribute("data-store-id",s),e.setAttribute("data-store-option",a),e.setAttribute("data-store-department","consumer"),e.setAttribute("data-store-event","main-product-loaded"),n.setAttribute("data-store-price","discounted||full"),r.appendChild(l),r.appendChild(n),A(e),r}function S(e,t,s){const{defaultSelection:a}=u.blockDataset,[r,l]=u.blockDataset.price.split(","),n=document.createElement("DIV");return n.classList.add("products-sideview-radio"),n.innerHTML=`
    <input type="radio" name="type" id="monthly"
    data-store-click-set-product data-store-product-id="${l}"
    data-store-product-department="consumer"
    data-product-type="monthly" ${a.split("-")[0]===l?"checked":""}/>
    <label for="monthly">${t??"Monthly"}</label>

    <input type="radio" name="type" id="yearly" data-store-click-set-product
    data-store-product-id="${r}"
    data-store-product-department="consumer"
    data-product-type="yearly" ${a.split("-")[0]===r?"checked":""}/>
    <label for="yearly">${s??"Yearly"}</label>
  `,n}function C(e){let t=e.querySelectorAll(".tag-blue");if(!t.length){const s=e.querySelector("ul");s?.classList.add("benefits-list"),s?.querySelectorAll("li")?.forEach(r=>{const l=document.createElement("span");l.classList.add("tag-blue"),r.insertAdjacentElement("beforeend",l)}),t=e.querySelectorAll(".tag-blue")}return t}function h(e,t,s){if(!s)return;const a=C(e),r=[...t.options].find(p=>p.hasAttribute("selected")),l=[...t.options].indexOf(r),i=s[l].slice(1,-1).split(",").map(p=>{const d=p.trim().replace(/['"]+/g,"");return d.includes("-icon")?`${Number(d.split("-icon")[0])}-icon`:Number(d)});let o=0;a.forEach(p=>{if(o<i.length){const d=i[o++];p.innerHTML=`${typeof d=="string"?d.replace("-icon",""):d}x ${typeof d=="string"&&d.includes("-icon")?'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><circle cx="12" cy="7" r="4" fill="white" /><path d="M12 14c-4.418 0-8 2.686-8 6v1h16v-1c0-3.314-3.582-6-8-6z" fill="white" /></svg>':""}`}})}function $(e,...t){const s=t.filter(i=>i&&!Number.isNaN(Number(i))).map(i=>Number(i)),a=Number(u.blockDataset.defaultSelection?.split("-")[1])||s[1],r=document.createElement("div");r.classList.add("products-sideview-selector");const l=`members-select-${Math.random().toString(36).substr(2,9)}`;r.innerHTML=`
    <label for="${l}">Choose number of members</label>
    <select id="${l}"
      data-store-click-set-devices>
        ${s.sort((i,o)=>i-o).map(i=>`
          <option value="${i}" ${i===a?"selected":""}>${i===1?`${i} member`:`${i} members`} </option>
        `).join("")}
    </select>
  `;const n=r.querySelector("select"),c=e.parentElement.parentElement.dataset;return n.value=a,n.addEventListener("change",i=>{[...n.options].forEach(o=>o.removeAttribute("selected")),[...n.options].find(o=>o.value===i.target.value)?.setAttribute("selected",""),h(e,n,c.benefits.split(",,"))}),h(e,n,c.benefits?.split(",,")),r}m("price",N);m("monthlyYearly",S);m("selectMembers",$);function x(){u.blockDataset.selectmembers.trim().split(",").forEach((t,s)=>y.set(s,Number(t)))}function M(e){const t=b(e);u.blockDataset=t,x(),e.firstElementChild.classList.add("d-flex"),e.firstElementChild.firstElementChild.classList.add("pricing-wrapper"),e.firstElementChild.lastElementChild.classList.add("features-wrapper"),E(e.firstElementChild,e);const s=[...e.firstElementChild.children];e.classList.add(`features-${s.length}-cols`);const a=e.children[0].children[1];a.appendChild(v(a))}export{M as default};
//# sourceMappingURL=products-sideview.js.map
