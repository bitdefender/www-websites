{"version":3,"file":"bitdefender-central.js","sources":["../../../src/blocks/bitdefender-central/bitdefender-central.js"],"sourcesContent":["function embedYoutube(url, autoplay) {\n  const usp = new URLSearchParams(url.search);\n  const suffix = autoplay ? '&muted=1&autoplay=0&enablejsapi=1' : '';\n  let vid = usp.get('v') ? encodeURIComponent(usp.get('v')) : '';\n  const embed = url.pathname;\n  if (url.origin.includes('youtu.be')) {\n    [, vid] = url.pathname.split('/');\n  }\n  const modalContainer = document.createElement('dialog');\n  modalContainer.classList.add('modal-container');\n\n  const modalContent = document.createElement('div');\n  modalContent.classList.add('modal-content');\n  modalContainer.appendChild(modalContent);\n\n  const closeModal = () => modalContainer.close();\n  const close = document.createElement('div');\n  close.classList.add('modal-close');\n  modalContent.append(close);\n\n  const iframe = document.createElement('iframe');\n  iframe.width = 783;\n  iframe.height = 440;\n  iframe.src = `https://www.youtube.com${vid ? `/embed/${vid}?rel=0&v=${vid}${suffix}` : embed}`;\n  iframe.title = 'YouTube video player';\n  iframe.frameborder = 0;\n  iframe.allow = 'autoplay; fullscreen; accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture';\n  iframe.allowFullscreen = true;\n  iframe.loading = 'lazy';\n  modalContent.appendChild(iframe);\n  close.addEventListener('click', () => {\n    iframe.contentWindow.postMessage('{\"event\":\"command\",\"func\":\"stopVideo\",\"args\":\"\"}', '*');\n    closeModal();\n  });\n  return modalContainer;\n  // `<div style=\"left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;\">\n  //     <iframe src=\"https://www.youtube.com${vid ? `/embed/${vid}?rel=0&v=${vid}${suffix}` : embed}\" style=\"border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;\"\n  // eslint-disable-next-line max-len\n  //     allow=\"autoplay; fullscreen; picture-in-picture; encrypted-media; accelerometer; gyroscope; picture-in-picture\" allowfullscreen=\"\" scrolling=\"no\" title=\"Content from Youtube\" loading=\"lazy\"></iframe>\n  //   </div>`;\n}\n\nfunction decorateLinkedPictures(main) {\n  main.querySelectorAll('picture').forEach((picture) => {\n    // this condition checks if the picture is part of some content block ( rte )\n    // and not a direct element in some DIV block\n    // that could have different behaviour for some blocks (ex: columns )\n    if (picture.closest('div.block') && picture.parentElement.tagName !== 'DIV') {\n      const next = picture.parentNode.nextElementSibling;\n      if (next) {\n        const a = next.querySelector('a');\n        const link = a?.textContent;\n        /* Modal video */\n        if (a && link.startsWith('https://') && link.includes('fragments')) {\n          a.innerHTML = '';\n          a.className = 'video-placeholder';\n          a.appendChild(picture);\n          const overlayPlayButton = document.createElement('span');\n          overlayPlayButton.className = 'video-placeholder-play';\n          a.appendChild(overlayPlayButton);\n          a.addEventListener('click', async (event) => {\n            event.preventDefault();\n            // eslint-disable-next-line no-use-before-define\n          });\n          const up = a.parentElement;\n          if (up.childNodes.length === 1 && (up.tagName === 'P' || up.tagName === 'DIV')) {\n            up.classList.add('modal-video-container');\n          }\n          return;\n        }\n        // Basic linked image\n        if (a && link.startsWith('https://')) {\n          a.innerHTML = '';\n          a.className = 'linked-image';\n          const pictureParent = picture.parentNode;\n          a.append(picture);\n          if (pictureParent.children.length === 0) {\n            pictureParent.parentNode.removeChild(pictureParent);\n          }\n          const up = a.parentElement;\n          if (up.childNodes.length === 1 && (up.tagName === 'P' || up.tagName === 'DIV')) {\n            up.classList.add('linked-image-container');\n          }\n        }\n      }\n    }\n  });\n}\n\nfunction decorateButtons(element) {\n  const wrapButtonText = (a) => ((a.innerHTML.startsWith('<'))\n    ? `${a.querySelector('span.icon')?.outerHTML || ''}<span class=\"button-text\">${a.textContent}</span>`\n    : `<span class=\"button-text\">${a.textContent}</span>${a.querySelector('span.icon')?.outerHTML || ''}`\n  );\n  element.querySelectorAll('a').forEach((a) => {\n    if (a.closest('.nav-brand') || a.closest('.nav-sections')) {\n      return;\n    }\n    a.title = a.title || a.textContent;\n    if (a.href !== a.textContent) {\n      const up = a.parentElement;\n      const twoup = a.parentElement.parentElement;\n      const threeup = a.parentElement.parentElement?.parentElement;\n\n      if (!a.querySelector('img')) {\n        // Example: <p><strong><a href=\"example.com\">Text</a></strong></p>\n        if (up.childNodes.length === 1 && up.tagName === 'STRONG'\n          && twoup.childNodes.length === 1 && twoup.tagName === 'P') {\n          a.className = 'button primary';\n          twoup.classList.add('button-container');\n          up.replaceWith(a);\n          a.innerHTML = wrapButtonText(a);\n          return;\n        }\n        if (up.childNodes.length === 1 && up.tagName === 'EM'\n            && twoup.childNodes.length === 1 && twoup.tagName === 'STRONG'\n            && threeup?.childNodes.length === 1 && threeup?.tagName === 'P') {\n          a.className = 'button secondary';\n          threeup.classList.add('button-container');\n          up.replaceWith(a);\n          a.innerHTML = wrapButtonText(a);\n          return;\n        }\n        // Example: <p><a href=\"example.com\">Text</a> (example.com)</p>\n        if (up.childNodes.length === 1 && up.tagName === 'P' && a.href.includes('/fragments/')) {\n          a.className = 'button modal';\n          up.classList.add('button-container');\n          return;\n        }\n        // Example: <p><a href=\"example.com\">Text</a> <em>50% Discount</em></p>\n        if (up.childNodes.length === 3 && up.tagName === 'P' && a.nextElementSibling?.tagName === 'EM') {\n          a.className = 'button';\n          up.classList.add('button-container');\n          a.innerHTML = wrapButtonText(a);\n          a.dataset.modal = a.nextSibling.textContent.trim().slice(1, -1);\n          a.nextSibling.remove();\n          return;\n        }\n        // Example: <p><a href=\"example.com\">? Text</a></p>\n        if (up.childNodes.length === 1 && up.tagName === 'P' && up.innerText.startsWith('?')) {\n          a.className = 'info-button modal';\n          up.classList.add('info-button-container');\n          a.textContent = a.textContent.slice(1).trim();\n          a.title = a.title.slice(1).trim();\n          return;\n        }\n        // Example: <p><a href=\"example.com\">Text</a></p>\n        if (up.childNodes.length === 1 && (up.tagName === 'P' || up.tagName === 'DIV')) {\n          a.className = 'button'; // default\n          up.classList.add('button-container');\n          a.innerHTML = wrapButtonText(a);\n        }\n      }\n    }\n  });\n}\n\nexport default async function decorate(block, options) {\n  const {\n    // eslint-disable-next-line no-unused-vars\n    videoUrl,\n  } = block.closest('.section').dataset;\n\n  if (options) {\n    // eslint-disable-next-line no-param-reassign\n    block = block.querySelector('.block');\n    decorateLinkedPictures(block);\n    decorateButtons(block);\n\n    const wrapper = block.querySelector('.video-placeholder');\n    block.appendChild(embedYoutube(new URL(videoUrl), true));\n    const modalContainer = block.querySelector('dialog');\n    wrapper.addEventListener('click', () => {\n      modalContainer.showModal();\n    });\n  }\n  const firstButton = block.querySelector('a.button');\n  if (firstButton) {\n    firstButton.classList.add('blue');\n  }\n\n  window.dispatchEvent(new CustomEvent('shadowDomLoaded'), {\n    bubbles: true,\n    composed: true, // This allows the event to cross the shadow DOM boundary\n  });\n}\n"],"names":["embedYoutube","url","autoplay","usp","suffix","vid","embed","modalContainer","modalContent","closeModal","close","iframe","decorateLinkedPictures","main","picture","next","a","link","overlayPlayButton","event","up","pictureParent","decorateButtons","element","wrapButtonText","twoup","threeup","decorate","block","options","videoUrl","wrapper","firstButton"],"mappings":"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"}