{"version":3,"file":"quote-carousel.js","sources":["../../../src/blocks/quote-carousel/quote-carousel.js"],"sourcesContent":["import { createTag } from '../../scripts/utils/utils.js';\nimport { decorateIcons } from '../../scripts/lib-franklin.js';\n\nconst SLIDE_PREFIX = 'carousel-slide-';\nconst CONTROL_PREFIX = 'carousel-control-';\n\nfunction createSlide(item, index) {\n  const paragraphs = Array.from(item.querySelectorAll('p'));\n  const quote = paragraphs.find((paragraph) => {\n    const strongOrEm = paragraph.querySelector('strong, em');\n    return !strongOrEm && paragraph.innerHTML !== '';\n  });\n\n  const author = item.querySelector('p > strong');\n  const description = item.querySelector('p > em');\n  if (!quote) {\n    return null;\n  }\n\n  return createTag(\n    'div',\n    {\n      class: 'slide',\n      id: `${SLIDE_PREFIX}${index}`,\n      role: 'tabpanel',\n      'aria-hidden': 'true',\n      'aria-describedby': `${CONTROL_PREFIX}${index}`,\n      tabindex: '-1',\n    },\n    `<div class=\"quote\">\n        <span class=\"icon icon-dark-blue-quote\"/>\n    </div>\n    <div class=\"quote-content\">\n        <h4>${quote?.innerHTML}</h4>\n        <h5>${author?.textContent}</h5>\n        <p>${description?.innerHTML}</p>\n    </div>`,\n  );\n}\n\nfunction getCurrentSlideIndex(slides) {\n  return [...slides.children].findIndex((slide) => slide.classList.contains('active'));\n}\n\nfunction updateControlsState(block, nextIndex) {\n  const dots = block.querySelector('.slides-dots');\n  const currentActive = dots.querySelector('.active');\n  if (currentActive) {\n    currentActive.classList.remove('active');\n    const btn = currentActive.querySelector('button');\n    btn.removeAttribute('aria-selected');\n    btn.setAttribute('tabindex', '-1');\n  }\n  const nextActive = dots.children[nextIndex];\n  if (nextActive) {\n    nextActive.classList.add('active');\n    const btn = nextActive.querySelector('button');\n    btn.setAttribute('aria-selected', 'true');\n    btn.setAttribute('tabindex', '0');\n  }\n}\n\nfunction updateSlideState(nextIndex, block) {\n  const slides = block.querySelector('.slides');\n  const currentIndex = getCurrentSlideIndex(slides);\n  slides.children[currentIndex].classList.remove('active');\n  slides.children[nextIndex].classList.add('active');\n  const translateX = -nextIndex * 100;\n  slides.style.transform = `translateX( ${translateX}% )`;\n  [...slides.children].forEach((slide, index) => {\n    if (index === nextIndex) {\n      slide.removeAttribute('tabindex');\n      slide.setAttribute('aria-hidden', 'false');\n    } else {\n      slide.setAttribute('tabindex', '-1');\n      slide.setAttribute('aria-hidden', 'true');\n    }\n  });\n  updateControlsState(block, nextIndex);\n}\n\nfunction addDotsListeners(dotsControls, slides) {\n  [...dotsControls.children].forEach((dot, index) => {\n    dot.addEventListener('click', (event) => {\n      event.preventDefault();\n      updateSlideState(index, slides.parentElement);\n    });\n  });\n}\n\nfunction createDotsControls(slides) {\n  const dots = createTag('ul', { class: 'slides-dots', role: 'tablist' });\n  const slidesNumber = slides.children.length;\n  [...slides.children].forEach((slide, slideIndex) => {\n    const ariaIndex = slideIndex + 1;\n    const btn = createTag(\n      'button',\n      {\n        id: `${CONTROL_PREFIX}${ariaIndex}`,\n        class: 'dot',\n        role: 'tab',\n        type: 'button',\n        tabindex: '-1',\n        'aria-controls': `${SLIDE_PREFIX}${ariaIndex}`,\n        'aria-label': `${ariaIndex} of ${slidesNumber}`,\n      },\n      `${ariaIndex}`,\n    );\n    const li = createTag('li', { role: 'presentation' }, btn);\n    dots.append(li);\n  });\n  return dots;\n}\n\nexport default async function decorate(block) {\n  const slides = createTag('div', { class: 'slides' });\n  let slideIndex = 1;\n  [...block.children].forEach((item) => {\n    const slide = createSlide(item, slideIndex);\n    if (slide) {\n      slideIndex += 1;\n      slides.append(slide);\n    }\n  });\n\n  slides.children[0].classList.add('active');\n  const dotsControls = createDotsControls(slides, block);\n\n  /* Add carousel action button if it exists */\n  const controlsElements = [dotsControls];\n  const button = block.querySelector('.button-container');\n  if (button) {\n    const slidesAction = createTag('div', { class: 'slides-action' });\n    slidesAction.append(button);\n    controlsElements.push(slidesAction);\n  }\n  const slidesControls = createTag('div', { class: 'slides-controls' }, controlsElements);\n  const slidesContainer = createTag('div', { class: 'slides-container' }, [slides, slidesControls]);\n  block.replaceChildren(slidesContainer);\n  updateControlsState(block, 0);\n  addDotsListeners(dotsControls, slides);\n  decorateIcons(block);\n}\n"],"names":[],"mappings":"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"}