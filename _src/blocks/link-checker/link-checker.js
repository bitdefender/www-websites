import{AdobeDataLayerService as m}from"../../node_modules/@repobit/dex-data-layer/dist/src/adobe-data-layer-service/index.js";import"../../node_modules/@repobit/dex-utils/dist/src/index.js";import{UserDetectedEvent as y}from"../../node_modules/@repobit/dex-data-layer/dist/src/events/user-detected-event/index.js";import{WindowLoadStartedEvent as C}from"../../node_modules/@repobit/dex-data-layer/dist/src/events/window-load-started-event/index.js";import{WindowLoadedEvent as w}from"../../node_modules/@repobit/dex-data-layer/dist/src/events/window-loaded-event/index.js";import{BotPrevention as S}from"../../scripts/utils/bot-prevention.js";class E{static createMessage(n,a,i){let o=a;/^https?:\/\//i.test(a)||(o=`http://${a}`),o=new URL(o),o.hostname.startsWith("www.")||(o.hostname=`www.${o.hostname}`);const t={1:"safe",2:"so_far_so_good_1",3:"so_far_so_good_2",4:"malware & phishing",5:"malware",6:"c&c",7:"malvertising & fraud & phishing",8:"fraud",9:"phishing",10:"malvertising",11:"pua",12:"homograph",13:"miner",14:"miner-server",15:"spam",16:"malware-hd",17:"untrusted",18:"malicious",other:"other"},s=t[n]||t.other,r=s.includes("safe")||s.includes("so_far_so_good_1")||s.includes("so_far_so_good_2");let c=i[s.toLowerCase()];return c=c.replace("<domain-name>",o.hostname),c?{text:c,className:r?"result safe":"result danger",status:s}:{text:`Status: ${s}`,className:"result warning"}}}function b(e,n,a){const i=a[n.status.toLowerCase()]||a.default;e.querySelector("h1").textContent=i}const _=e=>new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-_]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+@]*)*(\\?[;&a-z\\d%\\/_@.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e);async function T(e,n,a,i,o){const t=n.value.trim();if(!t||!_(t)){a.textContent="Please enter a valid URL",a.className="result danger";return}n.closest(".input-container").classList.add("loader-circle");let s=await fetch("https://eu.nimbus.bitdefender.net/tools/link-checker",{method:"POST",headers:{"Content-Type":"application/json","X-Nimbus-ClientID":"81b10964-a3c1-44f6-b5ac-7eac82db3ab1"},body:JSON.stringify({url:t})});if(s.status===401){const l=await s.json(),p=await S.solveChallange(l);s=await fetch("https://eu.nimbus.bitdefender.net/tools/link-checker",{method:"POST",headers:{"Content-Type":"application/json","X-Nimbus-ClientID":"81b10964-a3c1-44f6-b5ac-7eac82db3ab1"},body:JSON.stringify({url:t,pow_challenge:l.pow_challenge,pow_solution:p.nonces})})}if(!s.ok){a.innerHTML=`
      <strong>Something went wrong</strong><br>
      The system encountered an error while trying to check the link you provided. Please try again in a few minutes.`,a.className="result danger no-response",n.closest(".input-container").classList.remove("loader-circle");return}const r=await s.json(),{status:c}=r,d=E.createMessage(c,t,i);a.textContent=d.text,a.className=d.className,e.closest(".section").classList.add(d.className.split(" ")[1]),n.setAttribute("disabled",""),document.getElementById("inputDiv").textContent=t,b(e,d,o),n.closest(".input-container").classList.remove("loader-circle"),m.push(new C(l=>(l.name+=`:${d.status}`,l))),m.push(new y),m.push(new w)}async function k(e){const n=["danger","safe"],a=e.closest(".section");n.forEach(s=>{a.classList.contains(s)&&a.classList.remove(s)});const i=e.querySelector("#link-checker-input"),o=e.querySelector(".result"),t=e.querySelector("h1");i.removeAttribute("disabled"),i.value="",o.className="result",t.textContent="Is This Link Really Safe?",m.push(new C({})),m.push(new y),m.push(new w)}function q(e){e.style.maxWidth=`${e.offsetWidth}px`,e.style.maxHeight=`${e.offsetHeight}px`;const n=document.createElement("div");return n.classList.add("share-popup"),e.insertAdjacentElement("beforeend",n),n}function A(e,n,a){const i=window.location.href;if(navigator.clipboard.writeText(i),e.querySelector(".buttons-container")){const t=e.querySelector(".share-popup")||q(n);t.textContent=`${a}`;const s=Math.abs((t.offsetWidth-n.offsetWidth)/2);t.style=`transform:translateX(-${s}px); opacity: 1`,setTimeout(()=>{t.style=`transform:translateX(-${s}px); opacity:0;`},2e3)}}function N(e){const n={};return Array.from(e.querySelectorAll("div")).find(o=>{const t=o.querySelector("p");return t&&t.textContent.includes("<status-messages>")}).querySelectorAll("p").forEach((o,t)=>{if(t===0)return;const s=o.textContent.split(":");if(s.length>=2){const r=s[0].trim(),c=s.slice(1).join(":").trim();n[r.toLowerCase()]=c}}),n}function P(e){const n={},a=Array.from(e.querySelectorAll("div")).find(o=>{const t=o.querySelector("p");return t&&t.textContent.includes("<titles-change>")});return a.classList.add("status-titles"),a.querySelectorAll("p").forEach((o,t)=>{if(t===0)return;const s=o.textContent.split(":");if(s.length>=2){const r=s[0].trim(),c=s.slice(1).join(":").trim();n[r.toLowerCase()]=c}}),a.remove(),n}function R(e){const{clipboardText:n}=e.closest(".section").dataset;e.querySelector(":scope > div:nth-child(3)").classList.add("privacy-policy");const i=N(e),o=P(e),t=document.createElement("div");t.classList.add("link-checker-form");const s=document.createElement("div");s.classList.add("input-container"),t.appendChild(s);const r=document.createElement("input");r.type="text",r.placeholder="example-url.com",r.id="link-checker-input";const c=document.createElement("span");c.id="copy-to-clipboard";const d=document.createElement("p");d.setAttribute("id","inputDiv");const l=document.createElement("div");l.className="input-container__container",l.appendChild(r),e.prepend(d),l.appendChild(c),s.appendChild(l),c.addEventListener("click",async()=>{try{const f=await navigator.clipboard.readText();r.value+=f}catch{}});const p=document.createElement("button");p.textContent="Check URL",p.classList.add("check-url"),s.appendChild(p);const u=document.createElement("div");u.className="result",t.appendChild(u);const g=document.createElement("div");g.classList.add("buttons-container");const h=document.createElement("button");h.innerHTML="<span>Share Link Checker</span>",h.classList.add("share-button");const v=document.createElement("button");v.innerHTML="<span>Check Another Link</span>",v.classList.add("check-another-button"),g.appendChild(h),g.appendChild(v),t.appendChild(g),e.querySelectorAll(":scope > div")[1].replaceWith(t);const[L,x]=e.querySelectorAll("picture");L.classList.add("safe-image"),x.classList.add("danger-image"),p.addEventListener("click",()=>T(e,r,u,i,o)),v.addEventListener("click",()=>k(e)),h.addEventListener("click",f=>{f.preventDefault(),A(e,h,n)}),r.addEventListener("input",()=>{r.value.trim()===""&&(u.textContent="",u.className="")}),r.addEventListener("paste",()=>{u.textContent="",u.className=""})}export{R as default};
//# sourceMappingURL=link-checker.js.map
