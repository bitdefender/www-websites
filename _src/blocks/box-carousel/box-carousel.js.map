{"version":3,"file":"box-carousel.js","sources":["../../../src/blocks/box-carousel/box-carousel.js"],"sourcesContent":["import { debounce } from '@repobit/dex-utils';\nimport { decorateIcons } from '../../scripts/lib-franklin.js';\nimport { isView } from '../../scripts/utils/utils.js';\n\nexport default async function decorate(block) {\n  const [titleEl, ...slides] = [...block.children];\n  let currentSlideIndex = 0;\n\n  const countItems = slides.length;\n  let countClass = `has-${countItems}-items`;\n  if (countItems > 3 && countItems < 7) {\n    countClass = 'has-3-7-items';\n  }\n  if (countItems > 7) {\n    countClass = 'has-more-items';\n  }\n  block.classList.add(countClass);\n\n  const isTestimonials = block.closest('.section').classList.contains('testimonials');\n\n  const carouselItemStyle = {\n    margin: 20,\n  };\n\n  function isFirstIndex() {\n    return currentSlideIndex === 0;\n  }\n\n  function isLastIndex() {\n    return currentSlideIndex === slides.length - 3;\n  }\n\n  function scrollCarousel(offset, carousel) {\n    const carouselItem = block.querySelector('.carousel-item');\n    carousel.style.transform = `translateX(${-1 * offset * (carouselItem.offsetWidth + carouselItemStyle.margin)}px)`;\n  }\n\n  function getCarousel() {\n    return block.querySelector('.carousel');\n  }\n\n  function updateDisabledArrow() {\n    const leftArrowEl = block.querySelector('.left-arrow');\n    const rightArrowEl = block.querySelector('.right-arrow');\n\n    leftArrowEl.classList.remove('disabled');\n    rightArrowEl.classList.remove('disabled');\n\n    if (isLastIndex()) {\n      block.querySelector('.right-arrow').classList.add('disabled');\n      return;\n    }\n\n    if (isFirstIndex()) {\n      block.querySelector('.left-arrow').classList.add('disabled');\n    }\n  }\n\n  function leftArrowHandler(e) {\n    e.preventDefault();\n    if (isFirstIndex()) {\n      return;\n    }\n    currentSlideIndex -= 1;\n    scrollCarousel(currentSlideIndex, getCarousel());\n    updateDisabledArrow(currentSlideIndex);\n  }\n\n  function rightArrowHandler(e) {\n    e.preventDefault();\n    if (isLastIndex()) {\n      return;\n    }\n    currentSlideIndex += 1;\n    scrollCarousel(currentSlideIndex, getCarousel());\n    updateDisabledArrow(currentSlideIndex);\n  }\n\n  function renderArrows() {\n    block.classList.remove('scrollable');\n\n    if (isView('desktop')) {\n      const cardsNotFullyVisible = window.innerWidth > 767;\n      return cardsNotFullyVisible ? `\n      <a href class=\"arrow disabled left-arrow\">\n        <svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 752 752\" preserveAspectRatio=\"xMidYMid meet\">\n          <g transform=\"translate(0,752) scale(0.1,-0.1)\">\n            <path fill=\"#000\" d=\"M4415 5430 c-92 -20 -148 -113 -125 -203 10 -37 83 -114 638 -669\n            l627 -628 -2011 0 -2011 0 -43 -23 c-73 -38 -108 -129 -79 -204 15 -42 68 -92\n            109 -103 22 -6 753 -10 2035 -10 l2000 0 -611 -604 c-354 -351 -618 -619 -628\n            -639 -70 -149 79 -302 222 -228 21 11 374 358 804 788 843 845 803 799 778\n            896 -10 37 -95 125 -788 820 -427 428 -788 784 -802 791 -35 18 -79 24 -115\n            16z\"></path>\n          </g>\n        </svg>\n      </a>\n      <a href class=\"arrow right-arrow\">\n        <svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 752 752\" preserveAspectRatio=\"xMidYMid meet\">\n          <g transform=\"translate(0,752) scale(0.1,-0.1)\">\n            <path fill=\"#000\" d=\"M4415 5430 c-92 -20 -148 -113 -125 -203 10 -37 83 -114 638 -669\n            l627 -628 -2011 0 -2011 0 -43 -23 c-73 -38 -108 -129 -79 -204 15 -42 68 -92\n            109 -103 22 -6 753 -10 2035 -10 l2000 0 -611 -604 c-354 -351 -618 -619 -628\n            -639 -70 -149 79 -302 222 -228 21 11 374 358 804 788 843 845 803 799 778\n            896 -10 37 -95 125 -788 820 -427 428 -788 784 -802 791 -35 18 -79 24 -115\n            16z\"></path>\n          </g>\n        </svg>\n      </a>\n    ` : '';\n    }\n\n    block.classList.add('scrollable');\n    return '';\n  }\n\n  function render() {\n    block.classList.add('default-content-wrapper');\n\n    block.innerHTML = `\n    <div class=\"carousel-header\">\n      <div class=\"title\">${titleEl?.children[0]?.innerHTML}</div>\n      <div class=\"arrows d-flex\">${renderArrows()}</div>\n    </div>\n\n    <div class=\"carousel-container\">\n        <div class=\"carousel\">\n          ${slides.map((slide) => `\n            <div class=\"carousel-item\">\n                ${isTestimonials ? `\n                  <div class=\"img-container\">\n                    ${slide.children[0]?.children[0]?.innerHTML}\n                  </div>\n                ` : slide.children[0]?.children[0]?.innerHTML}\n\n                <p class=\"title\">\n                    ${slide.children[0]?.children[1]?.textContent}\n                </p>\n\n                ${isTestimonials ? `\n                  <div class=\"subtitle-secondary\">\n                    ${slide.children[0]?.children[2]?.innerHTML}\n                  </div>\n\n                  <div class=\"subtitle\">\n                    ${slide.children[0]?.children[3]?.innerHTML}\n                  </div>\n                ` : `\n                   <div class=\"subtitle\">\n                      ${slide.children[0]?.children[2]?.innerHTML}\n                   </div>\n                `}\n            </div>\n          `).join('')}\n        </div>\n    </div>\n  `;\n\n    decorateIcons(block);\n\n    const leftArrowEl = block.querySelector('.left-arrow');\n    const rightArrowEl = block.querySelector('.right-arrow');\n\n    if (leftArrowEl && rightArrowEl) {\n      leftArrowEl.removeEventListener('click', leftArrowHandler);\n      rightArrowEl.removeEventListener('click', rightArrowHandler);\n\n      leftArrowEl.addEventListener('click', leftArrowHandler);\n      rightArrowEl.addEventListener('click', rightArrowHandler);\n    }\n  }\n\n  render();\n\n  window.addEventListener('resize', debounce(render, 250));\n}\n"],"names":["decorate","block","titleEl","slides","currentSlideIndex","countItems","countClass","isTestimonials","carouselItemStyle","isFirstIndex","isLastIndex","scrollCarousel","offset","carousel","carouselItem","getCarousel","updateDisabledArrow","leftArrowEl","rightArrowEl","leftArrowHandler","e","rightArrowHandler","renderArrows","isView","render","slide","decorateIcons","debounce"],"mappings":"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"}