import"../../packages/repobit/dex-utils/dist/src/index.js";import{createTag as b,matchHeights as a}from"../../scripts/utils/utils.js";import{debounce as A}from"../../packages/repobit/dex-utils/dist/src/utils.js";function v(){return window.innerWidth<=767?1:3}function q(t){return Math.ceil(t.children.length/v())}function g(t,i){const s=t.querySelector(".columns.carousel > div:first-child"),r=v(),c=-(t.clientWidth*i)/r;s.style.transform=`translateX(${c}px)`,s.style.transition="transform 0.5s ease"}function w(t){g(t,0)}function x(t,i){i.querySelector(".active-button")?.classList.remove("active-button"),t.classList.add("active-button")}function C(t,i){const s=document.createElement("div");return s.className="carousel-buttons",Array.from({length:t},(r,c)=>{const l=document.createElement("button");return l.setAttribute("aria-label",`Slide ${c+1}`),l.addEventListener("click",()=>{l.classList.contains("active-button")||(g(i,c),x(l,s))}),s.appendChild(l),l}),s.firstChild?.classList.add("active-button"),s}function p(t,i=!1){const s=t.querySelector(".columns.carousel > div");i&&(s.style.transform="translateX(0px)");const r=C(q(s),t);t.querySelector(".carousel-buttons")?.remove(),t.appendChild(r),w(t)}function I(){document.querySelectorAll(".columns.text-over-image > div > div").forEach(i=>{const s=i.querySelector("img");if(s){const r=s.getAttribute("src");i.style.backgroundImage=`url(${r})`;const c=s.closest("p");c&&c.remove()}})}function N(t){const{linksOpenInNewTab:i,type:s,maxElementsInColumn:r,products:c,breadcrumbs:l,aliases:y}=t.closest(".section").dataset,S=[...t.firstElementChild.children];if(t.classList.add(`columns-${S.length}-cols`),[...t.children].forEach(e=>{[...e.children].forEach(n=>{const o=n.querySelector("picture");if(o){const d=o.closest("div");d&&d.children.length===1&&d.classList.add("columns-img-col")}else{const d=[...e.children];if(d.length===1)n.closest("div").classList.add("columns-title-col");else{const f=d.indexOf(n.closest("div"));n.closest("div").classList.add("columns-text-col"),f?n.closest("div").classList.add("columns-right-col"):n.closest("div").classList.add("columns-left-col")}}})}),l&&t.classList.contains("creators-banner")){const e=b("div",{class:"breadcrumb"});t.querySelector(".columns-left-col")?.prepend(e)}const h=c?.split(",");h&&[...t.children].forEach((e,n)=>{[...e.children].forEach((o,d)=>{const[f,L,E]=h[d].trim().split("/");o.setAttribute("data-store-context",""),o.setAttribute("data-store-id",f),o.setAttribute("data-store-option",`${E}-${L}`),o.setAttribute("data-store-department","consumer"),o.querySelector('a[href*="#buylink"]')?.setAttribute("data-store-buy-link","")})}),y?.split(",").forEach((e,n)=>{[...t.children].forEach(o=>{o.children[n]?.querySelector("a.button.modal")?.setAttribute("data-store-id",e.trim())})}),i==="true"&&t.querySelectorAll(".button-container > a").forEach(e=>{e.target="_blank",e.rel="noopener noreferrer"}),t.classList.contains("text-over-image")&&I(),t.classList.contains("carousel")&&p(t),window.addEventListener("resize",A(()=>{t.classList.contains("carousel")&&p(t,!0)},250)),window.dispatchEvent(new Event("resize"));const m=document.querySelector(".columns-container[data-bg-image]");if(m){const e=m.getAttribute("data-bg-image");e&&m.style.setProperty("--bg-image-url",`url(${e})`)}if(s&&s==="video_left"){t.closest(".section").classList.add("video-left");const e=t.querySelector(".columns-img-col"),n=e.querySelector("tr:last-of-type").innerText.trim(),o=e.querySelector("img").getAttribute("src");e.innerHTML=`<video data-type="dam" data-video="" src="${n}" disableremoteplayback="" playsinline="" controls="" poster="${o}"></video>`}const u=document.querySelector(".chat-options");u&&(u.querySelectorAll(".button-container").forEach(n=>{n.previousElementSibling.classList.add("chat-options-text")}),a(u,".chat-options-text"),a(u,"table")),t.querySelectorAll("h3")?.forEach(e=>{e.textContent.includes("{GLOBAL_BIGGEST_DISCOUNT_PERCENTAGE}")&&e.classList.add("await-loader")}),t.closest(".section").classList.contains("v-5")&&r&&t.querySelectorAll(".columns-text-col")?.forEach(e=>{e.style["grid-row"]=`span ${r}`}),a(t,"h3"),a(t,"h4"),t.closest(".section").classList.contains("multi-blocks")&&(a(t.closest(".section"),".columns"),a(t.closest(".section"),"table"),a(t.closest(".section"),"p:nth-last-of-type(2)"),a(t.closest(".section"),".columns > div")),t.classList.contains("awards-fragment")&&a(t,"p:last-of-type")}export{N as default};
//# sourceMappingURL=columns.js.map
