{"version":3,"file":"fragment.js","sources":["../../../src/blocks/fragment/fragment.js"],"sourcesContent":["/*\n * Fragment Block\n * Include content from one Helix page in another.\n * https://www.hlx.live/developer/block-collection/fragment\n */\n\nimport {\n  decorateMain, getLanguageCountryFromPath,\n} from '../../scripts/scripts.js';\n\nimport {\n  loadBlocks,\n} from '../../scripts/lib-franklin.js';\n\n/**\n     * Loads a fragment.\n     * @param {string} path The path to the fragment\n     * @returns {HTMLElement} The root element of the fragment\n     */\nasync function loadFragment(path) {\n  const { country, language } = getLanguageCountryFromPath();\n  if (path && path.startsWith('/')) {\n    try {\n      // eslint-disable-next-line no-param-reassign\n      path = path.replace(/lang/g, `${language}-${country}`);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.log(error);\n    }\n    const resp = await fetch(`${path}.plain.html`);\n    if (resp.ok) {\n      const main = document.createElement('main');\n      main.innerHTML = await resp.text();\n      decorateMain(main);\n      await loadBlocks(main);\n      return main;\n    }\n  }\n  return null;\n}\n\nexport default async function decorate(block) {\n  const link = block.querySelector('a');\n  const path = link ? link.getAttribute('href') : block.textContent.trim();\n  const fragment = await loadFragment(path);\n  if (fragment) {\n    const fragmentSection = fragment.querySelector(':scope .section');\n    if (fragmentSection) {\n      block.closest('.section').classList.add(...fragmentSection.classList);\n      block.closest('.fragment-wrapper').replaceWith(...fragmentSection.childNodes);\n    }\n  }\n}\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;;;AAUA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY,CAAC,IAAI,EAAE;AAClC,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,0BAA0B,EAAE;AAC5D,EAAE,IAAI,IAAI,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;AACpC,IAAI,IAAI;AACR;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC;AAC5D,KAAK,CAAC,OAAO,KAAK,EAAE;AACpB;AACA,MAAM,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC;AACxB;AACA,IAAI,MAAM,IAAI,GAAG,MAAM,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;AAClD,IAAI,IAAI,IAAI,CAAC,EAAE,EAAE;AACjB,MAAM,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;AACjD,MAAM,IAAI,CAAC,SAAS,GAAG,MAAM,IAAI,CAAC,IAAI,EAAE;AACxC,MAAM,YAAY,CAAC,IAAI,CAAC;AACxB,MAAM,MAAM,UAAU,CAAC,IAAI,CAAC;AAC5B,MAAM,OAAO,IAAI;AACjB;AACA;AACA,EAAE,OAAO,IAAI;AACb;;AAEe,eAAe,QAAQ,CAAC,KAAK,EAAE;AAC9C,EAAE,MAAM,IAAI,GAAG,KAAK,CAAC,aAAa,CAAC,GAAG,CAAC;AACvC,EAAE,MAAM,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC,WAAW,CAAC,IAAI,EAAE;AAC1E,EAAE,MAAM,QAAQ,GAAG,MAAM,YAAY,CAAC,IAAI,CAAC;AAC3C,EAAE,IAAI,QAAQ,EAAE;AAChB,IAAI,MAAM,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,iBAAiB,CAAC;AACrE,IAAI,IAAI,eAAe,EAAE;AACzB,MAAM,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,eAAe,CAAC,SAAS,CAAC;AAC3E,MAAM,KAAK,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,WAAW,CAAC,GAAG,eAAe,CAAC,UAAU,CAAC;AACnF;AACA;AACA;;;;"}