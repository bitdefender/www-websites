{"version":3,"file":"fragment.js","sources":["../../../src/blocks/fragment/fragment.js"],"sourcesContent":["/*\n * Fragment Block\n * Include content from one Helix page in another.\n * https://www.hlx.live/developer/block-collection/fragment\n */\n\nimport {\n  decorateMain, getLanguageCountryFromPath,\n} from '../../scripts/scripts.js';\n\nimport {\n  loadBlocks,\n} from '../../scripts/lib-franklin.js';\n\n/**\n     * Loads a fragment.\n     * @param {string} path The path to the fragment\n     * @returns {HTMLElement} The root element of the fragment\n     */\nasync function loadFragment(path) {\n  const { country, language } = getLanguageCountryFromPath();\n  if (path && path.startsWith('/')) {\n    try {\n      // eslint-disable-next-line no-param-reassign\n      path = path.replace(/lang/g, `${language}-${country}`);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.log(error);\n    }\n    const resp = await fetch(`${path}.plain.html`);\n    if (resp.ok) {\n      const main = document.createElement('main');\n      main.innerHTML = await resp.text();\n      decorateMain(main);\n      await loadBlocks(main);\n      return main;\n    }\n  }\n  return null;\n}\n\nexport default async function decorate(block) {\n  const link = block.querySelector('a');\n  const path = link ? link.getAttribute('href') : block.textContent.trim();\n  const fragment = await loadFragment(path);\n  if (fragment) {\n    const fragmentSection = fragment.querySelector(':scope .section');\n    if (fragmentSection) {\n      block.closest('.section').classList.add(...fragmentSection.classList);\n      block.closest('.fragment-wrapper').replaceWith(...fragmentSection.childNodes);\n    }\n  }\n}\n"],"names":["loadFragment","path","country","language","getLanguageCountryFromPath","error","resp","main","decorateMain","loadBlocks","decorate","block","link","fragment","fragmentSection"],"mappings":"mJAmBA,eAAeA,EAAaC,EAAM,CAChC,KAAM,CAAE,QAAAC,EAAS,SAAAC,CAAU,EAAGC,EAA4B,EAC1D,GAAIH,GAAQA,EAAK,WAAW,GAAG,EAAG,CAChC,GAAI,CAEFA,EAAOA,EAAK,QAAQ,QAAS,GAAGE,CAAQ,IAAID,CAAO,EAAE,CACtD,OAAQG,EAAO,CAEd,QAAQ,IAAIA,CAAK,CACvB,CACI,MAAMC,EAAO,MAAM,MAAM,GAAGL,CAAI,aAAa,EAC7C,GAAIK,EAAK,GAAI,CACX,MAAMC,EAAO,SAAS,cAAc,MAAM,EAC1C,OAAAA,EAAK,UAAY,MAAMD,EAAK,KAAM,EAClCE,EAAaD,CAAI,EACjB,MAAME,EAAWF,CAAI,EACdA,CACb,CACA,CACE,OAAO,IACT,CAEe,eAAeG,EAASC,EAAO,CAC5C,MAAMC,EAAOD,EAAM,cAAc,GAAG,EAC9BV,EAAOW,EAAOA,EAAK,aAAa,MAAM,EAAID,EAAM,YAAY,KAAM,EAClEE,EAAW,MAAMb,EAAaC,CAAI,EACxC,GAAIY,EAAU,CACZ,MAAMC,EAAkBD,EAAS,cAAc,iBAAiB,EAC5DC,IACFH,EAAM,QAAQ,UAAU,EAAE,UAAU,IAAI,GAAGG,EAAgB,SAAS,EACpEH,EAAM,QAAQ,mBAAmB,EAAE,YAAY,GAAGG,EAAgB,UAAU,EAElF,CACA"}