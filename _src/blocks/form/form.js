import"../../node_modules/@repobit/dex-utils/dist/src/index.js";import{debounce as p}from"../../node_modules/@repobit/dex-utils/dist/src/utils.js";async function m(e){return(await(await fetch(e)).json()).data}const b=e=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase()),l=e=>{switch(e.type){case"email":if(!b(e.value))return!1;break;case"checkbox":if(!e.checked&&e.required)return!1;break}return!0},f=e=>{const t=e.parentElement.querySelector(".input-error-field");t&&t.classList.remove("global-display-none")},h=e=>{const t=e.parentElement.querySelector(".input-error-field");t&&t.classList.add("global-display-none")};function E(e){const t=e.querySelector('input[type="submit"]'),n=e.querySelectorAll('input:not([type="hidden"])');let i=!1;n.forEach(s=>{!i&&!l(s)&&(i=!0)}),t.disabled=i}async function y(e,t){e.preventDefault();try{const n=await import(t);n.default&&await n.default(e)}catch(n){console.log("failed to load module for lib-identity-exposed-onsubmit",n)}}const d=(e,t)=>{const n=e.nextElementSibling;n&&n.tagName==="LABEL"?(e.before(t),t.append(e,n)):(e.after(t),t.append(e))},L=(e,t)=>{e.dataset.containsErrorField&&l(e)?h(e):e.dataset.containsErrorField&&f(e),E(t)};async function A(e){const{pathname:t,search:n}=new URL(e),i=await m(`${t}${n}`),s=document.createElement("form");return s.setAttribute("method","post"),i.forEach((a,u)=>{const r=document.createElement("input");if(r.id=`form-${u}-${a.Field}`,r.setAttribute("type",a.Type),r.setAttribute("name",a.Field),r.setAttribute("placeholder",a.Default),r.setAttribute("value",a.Value),r.setAttribute("data-contains-error-field",!!a.Error),r.addEventListener("input",p(()=>L(r,s),100,!1)),a.Required&&a.Required.toLowerCase()==="true"&&(r.setAttribute("required",""),r.setAttribute("aria-required","true")),s.append(r),a.Label){const o=document.createElement("label");o.setAttribute("for",r.id),o.textContent=a.Label,s.append(o)}if(a.Type==="submit"&&(r.classList.add("disabled"),r.disabled=!0),a.Field==="handler"&&s.addEventListener("submit",o=>y(o,a.Value)),a.Type==="checkbox"){const o=document.createElement("div");o.classList.add("checkbox"),d(r,o)}if(a.Error){const o=document.createElement("div");o.classList.add("input-container-with-error");const c=document.createElement("p");c.classList.add("input-error-field","global-display-none"),c.textContent=a.Error,o.appendChild(c),r.classList.add("input-with-error-field"),d(r,o)}}),s}async function v(e){const t=await A(e.textContent.trim());t&&e.append(t)}export{A as createForm,v as default};
//# sourceMappingURL=form.js.map
