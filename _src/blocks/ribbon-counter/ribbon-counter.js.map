{"version":3,"file":"ribbon-counter.js","sources":["../../../src/blocks/ribbon-counter/ribbon-counter.js"],"sourcesContent":["/* eslint-disable camelcase, max-len */\nexport default function decorate(block) {\n  const parentSection = block.closest('.section');\n  const {\n    background_color, text_color, counter_ends_on, counter_headings, padding_top, padding_bottom, margin_top, margin_bottom,\n  } = parentSection.dataset;\n  const [, backgroundEl] = block.children;\n\n  if (background_color) parentSection.style.backgroundColor = background_color;\n  if (text_color) block.querySelector('*').style.color = text_color;\n  if (padding_top) block.style.paddingTop = `${padding_top}rem`;\n  if (padding_bottom) block.style.paddingBottom = `${padding_bottom}rem`;\n  if (margin_top) parentSection.style.marginTop = `${margin_top}rem`;\n  if (margin_bottom) parentSection.style.marginBottom = `${margin_bottom}rem`;\n\n  if (backgroundEl) {\n    const backgroundImgEl = backgroundEl.querySelector('img');\n    const backgroundImgSrc = backgroundImgEl?.getAttribute('src');\n\n    if (backgroundImgSrc) {\n      parentSection.style.backgroundImage = `url(\"${backgroundImgSrc}\")`;\n      // Remove the row after setting background\n      backgroundEl.remove();\n    }\n  }\n\n  if (counter_ends_on) {\n    const [daysLabel, hoursLabel, minsLabel, secLabel] = counter_headings ? counter_headings.split(',').map((v) => v.trim()) : ['d', 'h', 'm', 's'];\n\n    block.innerHTML = block.innerHTML.replace('[counter]', `\n      <strong class=\"ribbonCounter\"></strong>\n    `);\n\n    const countdownElement = block.querySelector('.ribbonCounter');\n    const targetDate = new Date(counter_ends_on).getTime();\n    let interval;\n\n    const updateCountdown = () => {\n      const now = new Date().getTime();\n      const distance = targetDate - now;\n\n      if (distance < 0) {\n        // countdownElement.innerHTML = \"Countdown ended!\";\n        parentSection.remove();\n        clearInterval(interval);\n        return;\n      }\n\n      const days = Math.floor(distance / (1000 * 60 * 60 * 24));\n      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));\n      const seconds = Math.floor((distance % (1000 * 60)) / 1000);\n\n      countdownElement.innerHTML = `${days}${daysLabel} : ${hours}${hoursLabel} : ${minutes}${minsLabel} : ${seconds}${secLabel}`;\n    };\n\n    interval = setInterval(updateCountdown, 1000);\n    updateCountdown();\n  }\n}\n"],"names":["decorate","block","parentSection","background_color","text_color","counter_ends_on","counter_headings","padding_top","padding_bottom","margin_top","margin_bottom","backgroundEl","backgroundImgSrc","daysLabel","hoursLabel","minsLabel","secLabel","v","countdownElement","targetDate","interval","updateCountdown","now","distance","days","hours","minutes","seconds"],"mappings":"AACe,SAASA,EAASC,EAAO,CACtC,MAAMC,EAAgBD,EAAM,QAAQ,UAAU,EACxC,CACJ,iBAAAE,EAAkB,WAAAC,EAAY,gBAAAC,EAAiB,iBAAAC,EAAkB,YAAAC,EAAa,eAAAC,EAAgB,WAAAC,EAAY,cAAAC,CAC3G,EAAGR,EAAc,QACZ,CAAG,CAAAS,CAAY,EAAIV,EAAM,SAS/B,GAPIE,IAAkBD,EAAc,MAAM,gBAAkBC,GACxDC,IAAYH,EAAM,cAAc,GAAG,EAAE,MAAM,MAAQG,GACnDG,IAAaN,EAAM,MAAM,WAAa,GAAGM,CAAW,OACpDC,IAAgBP,EAAM,MAAM,cAAgB,GAAGO,CAAc,OAC7DC,IAAYP,EAAc,MAAM,UAAY,GAAGO,CAAU,OACzDC,IAAeR,EAAc,MAAM,aAAe,GAAGQ,CAAa,OAElEC,EAAc,CAEhB,MAAMC,EADkBD,EAAa,cAAc,KAAK,GACd,aAAa,KAAK,EAExDC,IACFV,EAAc,MAAM,gBAAkB,QAAQU,CAAgB,KAE9DD,EAAa,OAAQ,EAE3B,CAEE,GAAIN,EAAiB,CACnB,KAAM,CAACQ,EAAWC,EAAYC,EAAWC,CAAQ,EAAIV,EAAmBA,EAAiB,MAAM,GAAG,EAAE,IAAKW,GAAMA,EAAE,KAAM,CAAA,EAAI,CAAC,IAAK,IAAK,IAAK,GAAG,EAE9IhB,EAAM,UAAYA,EAAM,UAAU,QAAQ,YAAa;AAAA;AAAA,KAEtD,EAED,MAAMiB,EAAmBjB,EAAM,cAAc,gBAAgB,EACvDkB,EAAa,IAAI,KAAKd,CAAe,EAAE,QAAS,EACtD,IAAIe,EAEJ,MAAMC,EAAkB,IAAM,CAC5B,MAAMC,EAAM,IAAI,KAAM,EAAC,QAAS,EAC1BC,EAAWJ,EAAaG,EAE9B,GAAIC,EAAW,EAAG,CAEhBrB,EAAc,OAAQ,EACtB,cAAckB,CAAQ,EACtB,MACR,CAEM,MAAMI,EAAO,KAAK,MAAMD,GAAY,IAAO,GAAK,GAAK,GAAG,EAClDE,EAAQ,KAAK,MAAOF,GAAY,IAAO,GAAK,GAAK,KAAQ,IAAO,GAAK,GAAG,EACxEG,EAAU,KAAK,MAAOH,GAAY,IAAO,GAAK,KAAQ,IAAO,GAAG,EAChEI,EAAU,KAAK,MAAOJ,GAAY,IAAO,IAAO,GAAI,EAE1DL,EAAiB,UAAY,GAAGM,CAAI,GAAGX,CAAS,MAAMY,CAAK,GAAGX,CAAU,MAAMY,CAAO,GAAGX,CAAS,MAAMY,CAAO,GAAGX,CAAQ,EAC1H,EAEDI,EAAW,YAAYC,EAAiB,GAAI,EAC5CA,EAAiB,CACrB,CACA"}