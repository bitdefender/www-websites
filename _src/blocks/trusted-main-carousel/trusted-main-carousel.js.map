{"version":3,"file":"trusted-main-carousel.js","sources":["../../../src/blocks/trusted-main-carousel/trusted-main-carousel.js"],"sourcesContent":["import { debounce } from '@repobit/dex-utils';\nimport { isView } from '../../scripts/utils/utils.js';\n\nexport default async function decorate(block) {\n  const slides = [...block.children];\n  const AUTOMATIC_SLIDING = {\n    enabled: true,\n    viewport: 'desktop',\n    slideDelay: 3 * 1000,\n  };\n\n  const state = {\n    currentStep: 0,\n    carouselIsFocused: false,\n    currentInterval: null,\n  };\n\n  const navItemsNames = slides.map((slideEl) => slideEl.children[0].firstElementChild.textContent);\n\n  block.classList.add('default-content-wrapper');\n  block.innerHTML = `\n    <div class=\"navigation-wrapper\">\n        <div class=\"first-nav\">\n          ${navItemsNames.map((navItemName, index) => `<div class=\"nav-item ${index === 0 ? 'active' : ''}\">${navItemName}</div>`).join('')}\n        </div>\n        \n        <div class=\"second-nav\">\n         <a href class=\"arrow disabled left-arrow\">\n            <svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 752 752\" preserveAspectRatio=\"xMidYMid meet\">\n              <g transform=\"translate(0,752) scale(0.1,-0.1)\">\n                <path fill=\"#000\" d=\"M4415 5430 c-92 -20 -148 -113 -125 -203 10 -37 83 -114 638 -669\n                l627 -628 -2011 0 -2011 0 -43 -23 c-73 -38 -108 -129 -79 -204 15 -42 68 -92\n                109 -103 22 -6 753 -10 2035 -10 l2000 0 -611 -604 c-354 -351 -618 -619 -628\n                -639 -70 -149 79 -302 222 -228 21 11 374 358 804 788 843 845 803 799 778\n                896 -10 37 -95 125 -788 820 -427 428 -788 784 -802 791 -35 18 -79 24 -115\n                16z\"></path>\n              </g>\n            </svg>\n          </a>\n         <a href class=\"arrow right-arrow\">\n            <svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 752 752\" preserveAspectRatio=\"xMidYMid meet\">\n              <g transform=\"translate(0,752) scale(0.1,-0.1)\">\n                <path fill=\"#000\" d=\"M4415 5430 c-92 -20 -148 -113 -125 -203 10 -37 83 -114 638 -669\n                l627 -628 -2011 0 -2011 0 -43 -23 c-73 -38 -108 -129 -79 -204 15 -42 68 -92\n                109 -103 22 -6 753 -10 2035 -10 l2000 0 -611 -604 c-354 -351 -618 -619 -628\n                -639 -70 -149 79 -302 222 -228 21 11 374 358 804 788 843 845 803 799 778\n                896 -10 37 -95 125 -788 820 -427 428 -788 784 -802 791 -35 18 -79 24 -115\n                16z\"></path>\n              </g>\n            </svg>\n          </a>\n        </div>\n    </div>\n    \n    <div class=\"content-wrapper\">\n        ${slides.map((slide, index) => `\n        <div class=\"slide ${index === 0 ? 'active' : ''}\">\n            ${slide.innerHTML}\n        </div>\n        `).join('')}\n    </div>\n  `;\n\n  const contentWrapper = block.querySelector('.content-wrapper');\n\n  const navItems = block.querySelectorAll('.nav-item');\n  const slideItems = block.querySelectorAll('.slide');\n  const leftArrow = block.querySelector('.left-arrow');\n  const rightArrow = block.querySelector('.right-arrow');\n  function selectNavItem(itemPosition) {\n    navItems.forEach((item) => item.classList.remove('active'));\n    navItems[itemPosition].classList.add('active');\n  }\n\n  function selectSlideItem(itemPosition) {\n    slideItems.forEach((item) => item.classList.remove('active'));\n    slideItems[itemPosition].classList.add('active');\n  }\n\n  function slideToSection(itemPosition) {\n    block.classList.add('scrolling');\n\n    const transformValue = -100 * (itemPosition);\n    const offset = 50 * itemPosition;\n    contentWrapper.style.transform = `translateX(calc(${transformValue}% - ${offset}px ))`;\n    setTimeout(() => {\n      block.classList.remove('scrolling');\n    }, 200);\n  }\n\n  function selectStep(itemPosition) {\n    state.currentStep = itemPosition;\n    selectNavItem(itemPosition);\n    selectSlideItem(itemPosition);\n    slideToSection(itemPosition);\n  }\n\n  function endAutomaticSliding(interval) {\n    clearInterval(interval || state.currentInterval);\n  }\n\n  function beginAutomaticSliding() {\n    if (!AUTOMATIC_SLIDING.enabled) return;\n\n    endAutomaticSliding();\n\n    if (state.carouselIsFocused || !isView(AUTOMATIC_SLIDING.viewport)) {\n      return;\n    }\n\n    const interval = setInterval(() => {\n      const isLastStep = state.currentStep === navItems.length - 1;\n      const nextStepToSelect = isLastStep ? 0 : (state.currentStep + 1);\n      selectStep(nextStepToSelect);\n\n      if (!isView(AUTOMATIC_SLIDING.viewport) || state.carouselIsFocused) {\n        endAutomaticSliding(interval);\n      }\n    }, AUTOMATIC_SLIDING.slideDelay);\n\n    state.currentInterval = interval;\n  }\n\n  function addEventListeners() {\n    block.addEventListener('mouseenter', () => {\n      state.carouselIsFocused = true;\n      endAutomaticSliding();\n    });\n\n    block.addEventListener('mouseleave', () => {\n      state.carouselIsFocused = false;\n      beginAutomaticSliding();\n    });\n\n    navItems.forEach((navEl, itemPosition) => {\n      navEl.addEventListener('click', () => {\n        selectStep(itemPosition);\n      });\n    });\n\n    leftArrow.addEventListener('click', (e) => {\n      e.preventDefault();\n\n      const isFirstStep = state.currentStep === 0;\n      if (isFirstStep) {\n        return;\n      }\n\n      selectStep(state.currentStep - 1);\n    });\n\n    rightArrow.addEventListener('click', (e) => {\n      e.preventDefault();\n\n      const isLastStep = state.currentStep === navItems.length - 1;\n      if (isLastStep) {\n        return;\n      }\n\n      selectStep(state.currentStep + 1);\n    });\n  }\n\n  addEventListeners();\n\n  beginAutomaticSliding();\n  window.addEventListener('resize', debounce(beginAutomaticSliding, 250));\n}\n"],"names":["decorate","block","slides","AUTOMATIC_SLIDING","state","navItemsNames","slideEl","navItemName","index","slide","contentWrapper","navItems","slideItems","leftArrow","rightArrow","selectNavItem","itemPosition","item","selectSlideItem","slideToSection","transformValue","offset","selectStep","endAutomaticSliding","interval","beginAutomaticSliding","isView","nextStepToSelect","addEventListeners","navEl","debounce"],"mappings":"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"}