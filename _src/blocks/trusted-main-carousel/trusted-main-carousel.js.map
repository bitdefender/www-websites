{"version":3,"file":"trusted-main-carousel.js","sources":["../../../src/blocks/trusted-main-carousel/trusted-main-carousel.js"],"sourcesContent":["import { debounce } from '@repobit/dex-utils';\nimport { isView } from '../../scripts/utils/utils.js';\n\nexport default async function decorate(block) {\n  const slides = [...block.children];\n  const AUTOMATIC_SLIDING = {\n    enabled: true,\n    viewport: 'desktop',\n    slideDelay: 3 * 1000,\n  };\n\n  const state = {\n    currentStep: 0,\n    carouselIsFocused: false,\n    currentInterval: null,\n  };\n\n  const navItemsNames = slides.map((slideEl) => slideEl.children[0].firstElementChild.textContent);\n\n  block.classList.add('default-content-wrapper');\n  block.innerHTML = `\n    <div class=\"navigation-wrapper\">\n        <div class=\"first-nav\">\n          ${navItemsNames.map((navItemName, index) => `<div class=\"nav-item ${index === 0 ? 'active' : ''}\">${navItemName}</div>`).join('')}\n        </div>\n        \n        <div class=\"second-nav\">\n         <a href class=\"arrow disabled left-arrow\">\n            <svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 752 752\" preserveAspectRatio=\"xMidYMid meet\">\n              <g transform=\"translate(0,752) scale(0.1,-0.1)\">\n                <path fill=\"#000\" d=\"M4415 5430 c-92 -20 -148 -113 -125 -203 10 -37 83 -114 638 -669\n                l627 -628 -2011 0 -2011 0 -43 -23 c-73 -38 -108 -129 -79 -204 15 -42 68 -92\n                109 -103 22 -6 753 -10 2035 -10 l2000 0 -611 -604 c-354 -351 -618 -619 -628\n                -639 -70 -149 79 -302 222 -228 21 11 374 358 804 788 843 845 803 799 778\n                896 -10 37 -95 125 -788 820 -427 428 -788 784 -802 791 -35 18 -79 24 -115\n                16z\"></path>\n              </g>\n            </svg>\n          </a>\n         <a href class=\"arrow right-arrow\">\n            <svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 752 752\" preserveAspectRatio=\"xMidYMid meet\">\n              <g transform=\"translate(0,752) scale(0.1,-0.1)\">\n                <path fill=\"#000\" d=\"M4415 5430 c-92 -20 -148 -113 -125 -203 10 -37 83 -114 638 -669\n                l627 -628 -2011 0 -2011 0 -43 -23 c-73 -38 -108 -129 -79 -204 15 -42 68 -92\n                109 -103 22 -6 753 -10 2035 -10 l2000 0 -611 -604 c-354 -351 -618 -619 -628\n                -639 -70 -149 79 -302 222 -228 21 11 374 358 804 788 843 845 803 799 778\n                896 -10 37 -95 125 -788 820 -427 428 -788 784 -802 791 -35 18 -79 24 -115\n                16z\"></path>\n              </g>\n            </svg>\n          </a>\n        </div>\n    </div>\n    \n    <div class=\"content-wrapper\">\n        ${slides.map((slide, index) => `\n        <div class=\"slide ${index === 0 ? 'active' : ''}\">\n            ${slide.innerHTML}\n        </div>\n        `).join('')}\n    </div>\n  `;\n\n  const contentWrapper = block.querySelector('.content-wrapper');\n\n  const navItems = block.querySelectorAll('.nav-item');\n  const slideItems = block.querySelectorAll('.slide');\n  const leftArrow = block.querySelector('.left-arrow');\n  const rightArrow = block.querySelector('.right-arrow');\n  function selectNavItem(itemPosition) {\n    navItems.forEach((item) => item.classList.remove('active'));\n    navItems[itemPosition].classList.add('active');\n  }\n\n  function selectSlideItem(itemPosition) {\n    slideItems.forEach((item) => item.classList.remove('active'));\n    slideItems[itemPosition].classList.add('active');\n  }\n\n  function slideToSection(itemPosition) {\n    block.classList.add('scrolling');\n\n    const transformValue = -100 * (itemPosition);\n    const offset = 50 * itemPosition;\n    contentWrapper.style.transform = `translateX(calc(${transformValue}% - ${offset}px ))`;\n    setTimeout(() => {\n      block.classList.remove('scrolling');\n    }, 200);\n  }\n\n  function selectStep(itemPosition) {\n    state.currentStep = itemPosition;\n    selectNavItem(itemPosition);\n    selectSlideItem(itemPosition);\n    slideToSection(itemPosition);\n  }\n\n  function endAutomaticSliding(interval) {\n    clearInterval(interval || state.currentInterval);\n  }\n\n  function beginAutomaticSliding() {\n    if (!AUTOMATIC_SLIDING.enabled) return;\n\n    endAutomaticSliding();\n\n    if (state.carouselIsFocused || !isView(AUTOMATIC_SLIDING.viewport)) {\n      return;\n    }\n\n    const interval = setInterval(() => {\n      const isLastStep = state.currentStep === navItems.length - 1;\n      const nextStepToSelect = isLastStep ? 0 : (state.currentStep + 1);\n      selectStep(nextStepToSelect);\n\n      if (!isView(AUTOMATIC_SLIDING.viewport) || state.carouselIsFocused) {\n        endAutomaticSliding(interval);\n      }\n    }, AUTOMATIC_SLIDING.slideDelay);\n\n    state.currentInterval = interval;\n  }\n\n  function addEventListeners() {\n    block.addEventListener('mouseenter', () => {\n      state.carouselIsFocused = true;\n      endAutomaticSliding();\n    });\n\n    block.addEventListener('mouseleave', () => {\n      state.carouselIsFocused = false;\n      beginAutomaticSliding();\n    });\n\n    navItems.forEach((navEl, itemPosition) => {\n      navEl.addEventListener('click', () => {\n        selectStep(itemPosition);\n      });\n    });\n\n    leftArrow.addEventListener('click', (e) => {\n      e.preventDefault();\n\n      const isFirstStep = state.currentStep === 0;\n      if (isFirstStep) {\n        return;\n      }\n\n      selectStep(state.currentStep - 1);\n    });\n\n    rightArrow.addEventListener('click', (e) => {\n      e.preventDefault();\n\n      const isLastStep = state.currentStep === navItems.length - 1;\n      if (isLastStep) {\n        return;\n      }\n\n      selectStep(state.currentStep + 1);\n    });\n  }\n\n  addEventListeners();\n\n  beginAutomaticSliding();\n  window.addEventListener('resize', debounce(beginAutomaticSliding, 250));\n}\n"],"names":[],"mappings":"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"}