import{target as v}from"../../scripts/target.js";import{Store as E,ProductInfo as _}from"../../scripts/libs/store/store.js";async function h(n){const r=n.closest(".section"),{product:l,custompid:P}=r.dataset;if(l){const[t,a,s]=l.split(","),I=(await v.getOffers({mboxNames:"exitPopupPid-mbox"}))?.promotion,p=(await E.getProducts([new _(t,"consumer",I||P,!0)]))[t],S=p.currency,x=p.regionId,c=p.getOption(Number(a),Number(s)),y=c.getDiscount("percentage"),b=c.priceDiscounted,w=c.price,u=n.querySelector("h5");u&&(u.innerHTML=u.innerHTML.replace("50%",`${y}%`));const e=n.querySelector("p.button-container a");e&&(e.textContent=e.textContent.replace("50%",`${y}%`),e.setAttribute("href",await c.getStoreUrl()),e.setAttribute("data-product",t),e.setAttribute("data-buy-price",b),e.setAttribute("data-old-price",w),e.setAttribute("data-currency",S),e.setAttribute("data-region",x),e.setAttribute("data-variation",`${a}u-${s}y`))}const o=document.createElement("span");o.id="exit-action",o.innerHTML='<img src="/_src/icons/close_x.JPG" alt="Bitdefender">',n.appendChild(o);const g=2,f=30;let i=parseInt(localStorage.getItem("popupDisplayCount")||0,10);const d=parseInt(localStorage.getItem("lastPopupDate")||0,10);function D(t){const a=f*24*60*60*1e3;return Date.now()-t>a}d&&D(d)&&(localStorage.removeItem("popupDisplayCount"),localStorage.removeItem("lastPopupDate"),i=0),document.addEventListener("mouseout",t=>{i<g&&t.clientY<0&&r&&(r.style.display="block",document.dispatchEvent(new Event("exit_popup_display")),window.exit_popup_display=!0,i+=1,localStorage.setItem("popupDisplayCount",i.toString()),localStorage.setItem("lastPopupDate",Date.now().toString()))});const m=()=>{const t=document.querySelector("main .exit-popup-container");t&&(t.style.display="none")};o&&o.addEventListener("click",m),r.addEventListener("click",m)}export{h as default};
//# sourceMappingURL=exit-popup.js.map
