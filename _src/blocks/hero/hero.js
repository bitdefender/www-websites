import"../../vendor/repobit/dex-utils/dist/src/index.js";import{createNanoBlock as A,createTag as p,getBrowserName as v,renderNanoBlocks as q}from"../../scripts/utils/utils.js";import E from"../../vendor/repobit/dex-utils/dist/src/user-agent/index.js";function x(t,r,o,n){const a=n.querySelector("a.button"),e=a.parentNode.nextElementSibling;switch(E.os){case"android":a.classList.add("android"),a.href=t.android.googlePlay,e.querySelectorAll("a").forEach((c,s)=>{c.textContent=t[r.split(",")[s].trim()].text,c.href=t[r.split(",")[s].trim()].link});break;case"ios":a.classList.add("ios"),a.href=t.ios.appStore,e.querySelectorAll("a").forEach((c,s)=>{c.textContent=t[o.split(",")[s].trim()].text,c.href=t[o.split(",")[s].trim()].link});break}}function w(t){const r=t.querySelector("h1"),o=t.querySelector("picture"),n=o?o.parentNode:!1;if(r&&o&&r.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_PRECEDING){const a=document.querySelector("div.hero");if(document.querySelector("div.hero div").classList.add("hero-content"),!(window.location.pathname.split("/").filter(d=>d).length===1)){const d=p("div",{class:"breadcrumb"});document.querySelector("div.hero div div:first-child").prepend(d)}const s=document.createElement("div");s.classList.add("hero-picture"),s.append(o),a.prepend(s),n.remove()}}A("discount",(t,r="{label}")=>{const[o,n,a]=t.split("/"),e=document.createElement("div");return e.classList.add("discount-bubble"),e.classList.add("await-loader"),e.setAttribute("data-store-context",""),e.setAttribute("data-store-id",o),e.setAttribute("data-store-option",`${n}-${a}`),e.setAttribute("data-store-department","consumer"),e.setAttribute("data-store-event","main-product-loaded"),e.setAttribute("data-store-hide","no-price=discounted;type=visibility"),e.innerHTML=`
    <span class="discount-bubble-0" data-store-discount="percentage">--%</span>
    <span class="discount-bubble-1">${r}</span>
  `,e});async function L(t){await q(t);const r=t?.querySelector(".discount-bubble");if(r){const{label:o}=t.closest(".section").dataset;o&&(r.innerHTML=r.innerHTML.replace("{label}",o));let n=r.previousElementSibling;for(;n;){if(n.matches(".button-container")){n.append(r);break}n=n.previousElementSibling}}}function T(t){const r=t.closest(".section"),{stopAutomaticModalRefresh:o,signature:n,percentProduct:a,firefoxUrl:e,buttonImage:c,iosLink:s,androidLink:d,windowsLink:f,macLink:b,androidTemplate:h,iosTemplate:y,appStoreLink:S,googlePlayLink:g,backgroundcolor:u,textcolor:m}=r.dataset;if(w(t),L(t),d&&s&&x({android:{link:d,googlePlay:g,text:"Android"},ios:{link:s,appStore:S,text:"iOS"},windows:{link:f,text:"Windows"},mac:{link:b,text:"macOS"}},h,y,t),[...t.querySelectorAll("img")].forEach(l=>l.setAttribute("loading","eager")),u&&(r.style.backgroundColor=u,t.style.backgroundColor=u),t.querySelector(".hero div.hero-content div")!==null){if(Array.from(document.querySelectorAll("ul")).filter(i=>i.querySelector("picture")).forEach(i=>i.classList.add("hero-awards")),n){const i=p("div",{class:"signature"});i.textContent=n,document.querySelector("div.hero div div:first-child").prepend(i)}if(m&&t.querySelectorAll(".hero-content > div, .hero-content > div *").forEach(i=>{i.style.color=m}),o==="true"&&t.querySelectorAll("a.modal.button").forEach(i=>{i.setAttribute("data-stop-automatic-modal-refresh",!0)}),c){const i=document.createElement("img");i.setAttribute("src",c),t.querySelector("a").insertAdjacentElement("afterbegin",i)}}if(a){const[l,i]=a.split(",");t.setAttribute("data-store-context",""),t.setAttribute("data-store-text-variable",""),t.setAttribute("data-store-id",l),t.setAttribute("data-store-department","consumer"),t.setAttribute("data-store-option",i),t.querySelector("div").classList.add("await-loader")}t.querySelector('.button-container a[href*="/consumer/thank-you"]')&&t.querySelector('.button-container a[href*="/consumer/thank-you"]').classList.add("await-loader"),e&&v()==="Firefox"&&(t.querySelector("a").href=e)}export{T as default};
//# sourceMappingURL=hero.js.map
