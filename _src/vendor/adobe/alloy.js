(function(){if(document.documentMode&&document.documentMode<11){console.warn("The Adobe Experience Cloud Web SDK does not support IE 10 and below.");return}var vt=function(e){return function(n){var r=n[0],t=n[1],a=n[2],o=a[0],i=a[1];e(o,i).then(r,t)}},jn="Chrome",Wn="Edge",zn="EdgeChromium",gt="Firefox",$n="IE",pt="Safari",Gn="Unknown",V=function(e,n){return e.indexOf(n)!==-1},mt=[jn,Wn,zn,$n,Gn],ht=function(e){return V(mt,e)};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Qn=Object.getOwnPropertySymbols,yt=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable;function Et(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function wt(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var n={},r=0;r<10;r++)n["_"+String.fromCharCode(r)]=r;var t=Object.getOwnPropertyNames(n).map(function(o){return n[o]});if(t.join("")!=="0123456789")return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(o){a[o]=o}),Object.keys(Object.assign({},a)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var It=wt()?Object.assign:function(e,n){for(var r,t=Et(e),a,o=1;o<arguments.length;o++){r=Object(arguments[o]);for(var i in r)yt.call(r,i)&&(t[i]=r[i]);if(Qn){a=Qn(r);for(var s=0;s<a.length;s++)Ct.call(r,a[s])&&(t[a[s]]=r[a[s]])}}return t},N=It,ue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ce(e,n){return n={exports:{}},e(n,n.exports),n.exports}var Ee=Ce(function(e,n){(function(r){var t;if(e.exports=r(),t=!0,!t){var a=window.Cookies,o=window.Cookies=r();o.noConflict=function(){return window.Cookies=a,o}}})(function(){function r(){for(var o=0,i={};o<arguments.length;o++){var s=arguments[o];for(var c in s)i[c]=s[c]}return i}function t(o){return o.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function a(o){function i(){}function s(u,d,l){if(!(typeof document>"u")){l=r({path:"/"},i.defaults,l),typeof l.expires=="number"&&(l.expires=new Date(new Date*1+l.expires*864e5)),l.expires=l.expires?l.expires.toUTCString():"";try{var f=JSON.stringify(d);/^[\{\[]/.test(f)&&(d=f)}catch{}d=o.write?o.write(d,u):encodeURIComponent(String(d)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),u=encodeURIComponent(String(u)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var v="";for(var g in l)l[g]&&(v+="; "+g,l[g]!==!0&&(v+="="+l[g].split(";")[0]));return document.cookie=u+"="+d+v}}function c(u,d){if(!(typeof document>"u")){for(var l={},f=document.cookie?document.cookie.split("; "):[],v=0;v<f.length;v++){var g=f[v].split("="),p=g.slice(1).join("=");!d&&p.charAt(0)==='"'&&(p=p.slice(1,-1));try{var m=t(g[0]);if(p=(o.read||o)(p,m)||t(p),d)try{p=JSON.parse(p)}catch{}if(l[m]=p,u===m)break}catch{}}return u?l[u]:l}}return i.set=s,i.get=function(u){return c(u,!1)},i.getJSON=function(u){return c(u,!0)},i.remove=function(u,d){s(u,"",r(d,{expires:-1}))},i.defaults={},i.withConverter=a,i}return a(function(){})})}),Y={get:Ee.get,set:Ee.set,remove:Ee.remove,withConverter:Ee.withConverter},te=function(e){return e==null};function Jn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,t)}return r}function I(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Jn(Object(r),!0).forEach(function(t){B(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function F(e){"@babel/helpers - typeof";return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},F(e)}function B(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function bt(e,n){if(e==null)return{};var r={},t=Object.keys(e),a,o;for(o=0;o<t.length;o++)a=t[o],!(n.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Xn(e,n){if(e==null)return{};var r=bt(e,n),t,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],!(n.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function _(e,n){return Rt(e)||Ot(e,n)||Yn(e,n)||Pt()}function R(e){return St(e)||Dt(e)||Yn(e)||At()}function St(e){if(Array.isArray(e))return Je(e)}function Rt(e){if(Array.isArray(e))return e}function Dt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ot(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var t=[],a=!0,o=!1,i,s;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(t.push(i.value),!(n&&t.length===n));a=!0);}catch(c){o=!0,s=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(o)throw s}}return t}}function Yn(e,n){if(e){if(typeof e=="string")return Je(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Je(e,n)}}function Je(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function At(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var x=function(e){return!te(e)&&!Array.isArray(e)&&F(e)==="object"},Tt=function e(n,r){Object.keys(r).forEach(function(t){if(x(n[t])&&x(r[t])){e(n[t],r[t]);return}n[t]=r[t]})},H=function(e){if(te(e))throw new TypeError('deepAssign "target" cannot be null or undefined');for(var n=Object(e),r=arguments.length,t=new Array(r>1?r-1:0),a=1;a<r;a++)t[a-1]=arguments[a];return t.forEach(function(o){return Tt(n,Object(o))}),n},we=function(e,n){return function(r){var t=n.split("."),a=t.reduce(function(o,i){return o[i]=o[i]||{},o[i]},e);H(a,r)}},K=function(){var e=[];return{add:function(r){e.push(r)},call:function(){for(var r=arguments.length,t=new Array(r),a=0;a<r;a++)t[a]=arguments[a];return Promise.all(e.map(function(o){return o.apply(void 0,t)}))}}},Xe=function(e){var n=e.logger,r=e.cookieJar;return I(I({},r),{},{set:function(a,o,i){n.info("Setting cookie",I({name:a,value:o},i)),r.set(a,o,i)}})},kt=function(){var e=0,n=Promise.resolve();return{addTask:function(t){e+=1;var a=function(){return t().finally(function(){e-=1})};return n=n.then(a,a),n},get length(){return e}}},Nt=function(){for(var e=[],n=0;n<256;n++){for(var r=n,t=0;t<8;t++)r=r&1?3988292384^r>>>1:r>>>1;e.push(r)}return function(a,o){a=unescape(encodeURIComponent(a)),o||(o=0),o=o^-1;for(var i=0;i<a.length;i++){var s=(o^a.charCodeAt(i))&255;o=o>>>8^e[s]}return o=o^-1,o>>>0}}(),Ye=function(){var e={};return e.promise=new Promise(function(n,r){e.resolve=n,e.reject=r}),e},Mt=function(e,n){return e.substr(-n.length)===n},_n=function(e,n){for(var r=0;r<e.length;r+=1){var t=e[r];if(n(t,r,e))return t}},oe=function(e,n){return e.appendChild(n)},xt=function(n,r){Object.keys(r).forEach(function(t){if(t==="style"&&x(r[t])){var a=r[t];Object.keys(a).forEach(function(o){n.style[o]=a[o]})}else n[t]=r[t]})},Z=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:document,o=a.createElement(e);return Object.keys(n).forEach(function(i){o.setAttribute(i,n[i])}),xt(o,r),t.forEach(function(i){return oe(o,i)}),o},qt="BODY",Lt="IFRAME",Ie="IMG",Ut="DIV",be="STYLE",de="SCRIPT",Ht="HEAD",Ft=function(e){var n=e.src,r=e.currentDocument,t=r===void 0?document:r;return new Promise(function(a,o){var i={src:n},s={onload:a,onerror:o,onabort:o};Z(Ie,i,s,[],t)})},z=function(e){return typeof e=="function"},D=function(e){return Array.isArray(e)&&e.length>0},Se=function(e){return Array.isArray(e)?e:e==null?[]:[].slice.call(e)},Bt=/^\s*>/,Re=function(e,n){if(!Bt.test(n))return Se(e.querySelectorAll(n));var r="alloy-"+Date.now();try{return e.classList.add(r),Se(e.querySelectorAll("."+r+" "+n))}finally{e.classList.remove(r)}},_e=function(e,n){return e.substr(0,n.length)===n},Ke=":shadow",Vt=function(n){return n.split(Ke)},jt=function(n,r){var t=r.trim(),a=_e(t,">");if(!a)return t;if(window.document.documentMode)return t.substring(1).trim();var o=n instanceof Element||n instanceof HTMLDocument?":scope":":host";return o+" "+t},Wt=function(e,n){if(!window.document.documentElement.attachShadow)return Re(e,n.replace(Ke,""));var r=Vt(n);if(r.length<2)return Re(e,n);for(var t=e,a=0;a<r.length;a+=1){var o=jt(t,r[a]),i=Re(t,o);if(i.length===0||!i[0]||!i[0].shadowRoot)return i;t=i[0].shadowRoot}},zt=function(e){return e.indexOf(Ke)!==-1},$=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;return zt(e)?Wt(n,e):Re(n,e)},Kn="MutationObserver",$t="requestAnimationFrame",Gt={childList:!0,subtree:!0},Qt="visibilityState",Jt="visible",Xt=100,Yt=5e3,Ze=function(n){return new Error("Could not find: "+n)},en=function(n){return new Promise(n)},_t=function(n){return z(n[Kn])},Kt=function(n,r,t,a,o){return en(function(i,s){var c=new n[Kn](function(){var u=o(t);D(u)&&(c.disconnect(),i(u))});setTimeout(function(){c.disconnect(),s(Ze(t))},a),c.observe(r,Gt)})},Zt=function(n){return n[Qt]===Jt},eo=function(n,r,t,a){return en(function(o,i){var s=function c(){var u=a(r);if(D(u)){o(u);return}n[$t](c)};s(),setTimeout(function(){i(Ze(r))},t)})},no=function(n,r,t){return en(function(a,o){var i=function s(){var c=t(n);if(D(c)){a(c);return}setTimeout(s,Xt)};i(),setTimeout(function(){o(Ze(n))},r)})},Zn=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Yt,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:window,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:document,o=n(e);return D(o)?Promise.resolve(o):_t(t)?Kt(t,a,e,r,n):Zt(a)?eo(t,e,r,n):no(e,r,n)},ro=function(e,n){return n.matches?n.matches(e):n.msMatchesSelector(e)},le=function(e){var n=e.parentNode;return n?n.removeChild(e):null},to={name:"Adobe Alloy"},oo={style:{display:"none",width:0,height:0}},ao=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.appendNode,r=n===void 0?oe:n,t=e.awaitSelector,a=t===void 0?Zn:t,o=e.createNode,i=o===void 0?Z:o,s=e.fireImage,c=s===void 0?Ft:s,u=c,d,l=function(){return a(qt).then(function(g){var p=_(g,1),m=p[0];return d||(d=i(Lt,to,oo),r(m,d))})},f=function(g){var p=g.src;return l().then(function(m){var h=m.contentWindow.document;return c({src:p,currentDocument:h})})};return function(v){var g=v.hideReferrer,p=v.url;return g?f({src:p}):u({src:p})}},G=function(e){return x(e)&&Object.keys(e).length===0},io=function e(n,r){return te(n)||!x(n)?n:Object.keys(n).reduce(function(t,a){var o=n[a];if(x(o)){var i=e(o,r);return G(i)?t:I(I({},t),{},B({},a,i))}return r(o)?I(I({},t),{},B({},a,o)):t},{})},nn=function(e,n){return Array.prototype.concat.apply([],e.map(n))},er="com.adobe.alloy.",so=function(e,n){return e.slice(-n)},De=er+"getTld",co=function(e,n){for(var r="",t=e.location.hostname.toLowerCase().split("."),a=1;a<t.length&&!n.get(De);)a+=1,r=so(t,a).join("."),n.set(De,De,{domain:r});return n.remove(De,{domain:r}),r},nr="kndctr",rn=function(e){return e.replace("@","_")},tn=function(e,n){return nr+"_"+rn(e)+"_"+n},uo="identity",lo="consent",fo="cluster",rr=function(e){var n=e.orgId,r=tn(n,uo);return function(){return!!Y.get(r)}},tr=function(n,r,t){return{getItem:function(o){try{return n[r].getItem(t+o)}catch{return null}},setItem:function(o,i){try{return n[r].setItem(t+o,i),!0}catch{return!1}},clear:function(){try{return Object.keys(n[r]).forEach(function(o){_e(o,t)&&n[r].removeItem(o)}),!0}catch{return!1}}}},vo=function(e){return function(n){var r=er+n;return{session:tr(e,"sessionStorage",r),persistent:tr(e,"localStorage",r)}}},go=function(e,n){return e.filter(function(r){return V(n,r)})},or=function(e){return typeof e=="boolean"},Oe=function(e){return typeof e=="number"&&!isNaN(e)},ar=function(e){var n=parseInt(e,10);return Oe(n)&&e===n},po=function(e,n){return n.indexOf(nr+"_"+rn(e)+"_")===0},fe=function(e){return typeof e=="string"},Q=function(e){return fe(e)&&e.length>0},mo=function(e,n){var r=new Map;return function(){var t=arguments.length<=0?void 0:arguments[0];if(r.has(t))return r.get(t);var a=e.apply(void 0,arguments);return r.set(t,a),a}},q=function(){},J=function(e,n,r){var t=String(e),a=String(r);if(t.length>=n||a.length===0)return t;for(var o=n-t.length;o>a.length;)a+=a;return a.slice(0,o)+t},ho=function(e){if(te(e)||F(e)!=="object")return null;var n=io(e,function(r){return te(r)?!1:!!(or(r)||Oe(r)||Q(r)||D(r))});return G(n)?null:n};function yo(e,n){return Object.prototype.hasOwnProperty.call(e,n)}var Co=function(n,r,t,a){r=r||"&",t=t||"=";var o={};if(typeof n!="string"||n.length===0)return o;var i=/\+/g;n=n.split(r);var s=1e3;a&&typeof a.maxKeys=="number"&&(s=a.maxKeys);var c=n.length;s>0&&c>s&&(c=s);for(var u=0;u<c;++u){var d=n[u].replace(i,"%20"),l=d.indexOf(t),f,v,g,p;l>=0?(f=d.substr(0,l),v=d.substr(l+1)):(f=d,v=""),g=decodeURIComponent(f),p=decodeURIComponent(v),yo(o,g)?Array.isArray(o[g])?o[g].push(p):o[g]=[o[g],p]:o[g]=p}return o},ve=function(n){switch(F(n)){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}},Eo=function(n,r,t,a){return r=r||"&",t=t||"=",n===null&&(n=void 0),F(n)==="object"?Object.keys(n).map(function(o){var i=encodeURIComponent(ve(o))+t;return Array.isArray(n[o])?n[o].map(function(s){return i+encodeURIComponent(ve(s))}).join(r):i+encodeURIComponent(ve(n[o]))}).join(r):a?encodeURIComponent(ve(a))+t+encodeURIComponent(ve(n)):""},ae=Ce(function(e,n){n.decode=n.parse=Co,n.encode=n.stringify=Eo});ae.decode,ae.parse,ae.encode,ae.stringify;for(var Ae={parse:function(n){return typeof n=="string"&&(n=n.trim().replace(/^[?#&]/,"")),ae.parse(n)},stringify:function(n){return ae.stringify(n)}},ir=function(e){return e instanceof Error?e:new Error(e)},sr=function(e){var n=e.error,r=e.message;try{n.message=r}catch{}},Pe=function(e){var n=e.error,r=e.message,t=ir(n),a=r+`
Caused by: `+t.message;return sr({error:t,message:a}),t},wo=function(e){return fe(e)&&e.toLowerCase()==="true"},ie=function(e,n){if(Oe(e)||fe(e)){var r=Math.round(Number(e));if(!isNaN(r))return r}return n},Io=function(e){var n=e.getFullYear(),r=J(e.getMonth()+1,2,"0"),t=J(e.getDate(),2,"0"),a=J(e.getHours(),2,"0"),o=J(e.getMinutes(),2,"0"),i=J(e.getSeconds(),2,"0"),s=J(e.getMilliseconds(),3,"0"),c=ie(e.getTimezoneOffset(),0),u=c>0?"-":"+",d=J(Math.floor(Math.abs(c)/60),2,"0"),l=J(Math.abs(c)%60,2,"0");return n+"-"+r+"-"+t+"T"+a+":"+o+":"+i+"."+s+u+d+":"+l},bo=Ce(function(e){var n=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var t=new Array(16);e.exports=function(){for(var o=0,i;o<16;o++)(o&3)===0&&(i=Math.random()*4294967296),t[o]=i>>>((o&3)<<3)&255;return t}}}),cr=[],Te=0;Te<256;++Te)cr[Te]=(Te+256).toString(16).substr(1);function So(e,n){var r=n||0,t=cr;return[t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]]].join("")}var Ro=So;function Do(e,n,r){var t=n&&r||0;typeof e=="string"&&(n=e==="binary"?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||bo)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,n)for(var o=0;o<16;++o)n[t+o]=a[o];return n||Ro(a)}var on=Do,ke=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=function(o,i){return n(e(o,i),i)};return N(t,e,r),t},O=function(e,n,r){var t=function(o,i){return o==null?o:n(o,i)};return ke(e,t,r)},P=function(e,n,r,t){if(!e)throw new Error("'"+r+"': Expected "+t+", but got "+JSON.stringify(n)+".")},Oo=function(e,n){return P(or(e),e,n,"true or false"),e},Ao=function(e,n){return P(z(e),e,n,"a function"),e},Po=function(e){return function(n,r){P(Array.isArray(n),n,r,"an array");var t=[],a=n.map(function(o,i){try{return e(o,r+"["+i+"]")}catch(s){t.push(s.message);return}});if(t.length)throw new Error(t.join(`
`));return a}},To=function(e){return function(n){return n??e}},ko=function(e){return function(n,r){return P(n===e,n,r,""+e),n}},No=function(e){return function(n,r){P(x(n),n,r,"an object");var t=[],a={};if(Object.keys(n).forEach(function(o){var i=n[o],s=r?r+"."+o:o;try{var c=e(i,s);c!==void 0&&(a[o]=c)}catch(u){t.push(u.message)}}),t.length)throw new Error(t.join(`
`));return a}},ur=function(e,n){return function(r,t){return P(r>=n,r,t,e+" greater than or equal to "+n),r}},Mo=function(e){return function(n,r){var t=[];if(Object.keys(n).forEach(function(a){if(!e[a]){var o=r?r+"."+a:a;t.push("'"+o+"': Unknown field.")}}),t.length)throw new Error(t.join(`
`));return n}},an=function(e){return function(n,r){return x(n)?P(!G(n),n,r,e):P(n.length>0,n,r,e),n}},xo=function(e){return function(n,r){P(x(n),n,r,"an object");var t=[],a={};if(Object.keys(e).forEach(function(o){var i=n[o],s=e[o],c=r?r+"."+o:o;try{var u=s(i,c);u!==void 0&&(a[o]=u)}catch(d){t.push(d.message)}}),Object.keys(n).forEach(function(o){Object.prototype.hasOwnProperty.call(a,o)||(a[o]=n[o])}),t.length)throw new Error(t.join(`
`));return a}},qo=function(e,n){return function(r,t){var a=_n(e,function(o){try{return o(r,t),!0}catch{return!1}});return P(a,r,t,n),r}},Lo=function(){var e=[];return function(n,r){return P(e.indexOf(n)===-1,n,r,"a unique value across instances"),e.push(n),n}},Uo=function(e){for(var n=Object.create(null),r=0;r<e.length;r+=1){var t=e[r];if(t in n)return!1;n[t]=!0}return!0},Ho=function(){return function(e,n){P(Uo(e),e,n,"array values to be unique")}},Fo=/^[a-z0-9.-]{1,}$/i,Bo=function(e,n){return P(Fo.test(e),e,n,"a valid domain"),e},Vo=function(e,n){return P(ar(e),e,n,"an integer"),e},jo=function(e,n){return P(Oe(e),e,n,"a number"),e},Wo=function(e){try{return new RegExp(e)!==null}catch{return!1}},zo=function(e,n){return P(Wo(e),e,n,"a regular expression"),e},$o=function(e,n){if(e==null)throw new Error("'"+n+"' is a required option");return e},Go=function(e,n){return P(fe(e),e,n,"a string"),e},L=function(n){return n};L.default=function(n){return ke(this,To(n))},L.required=function(){return ke(this,$o)};var Qo=function(){return O(this,Bo)},Jo=function(n){return O(this,ur("an integer",n))},Xo=function(n){return O(this,ur("a number",n))},Yo=function(){return O(this,Vo,{minimum:Jo})},_o=function(){return O(this,an("a non-empty string"))},Ko=function(){return O(this,an("a non-empty array"))},dr=function(){return O(this,an("a non-empty object"))},Zo=function(){return O(this,zo)},lr=function(){return O(this,Lo())},ea=function(){return O(this,Ho())},na=function(n,r){return ke(this,qo(n,r))},ra=function(){return O(this,L)},ta=function(n){return O(this,Po(n),{nonEmpty:Ko,uniqueItems:ea})},oa=function(){return O(this,Oo)},aa=function(){return O(this,Ao)},ia=function(n){return O(this,ko(n))},sa=function(){return O(this,jo,{minimum:Xo,integer:Yo,unique:lr})},ca=function(n){return O(this,No(n),{nonEmpty:dr})},ua=function(n){var r=function(){return O(this,Mo(n))};return O(this,xo(n),{noUnknownFields:r,nonEmpty:dr})},da=function(){return O(this,Go,{regexp:Zo,domain:Qo,nonEmpty:_o,unique:lr})},la=na.bind(L),Ne=ra.bind(L),j=ta.bind(L),W=oa.bind(L),fr=aa.bind(L),vr=ia.bind(L);sa.bind(L);var gr=ca.bind(L),T=ua.bind(L),A=da.bind(L),pr=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return la(r.map(vr),"one of these values: ["+JSON.stringify(r)+"]")},fa="ambiguous",va="authenticated",ga="loggedOut",mr=gr(j(T({authenticatedState:pr(fa,va,ga),id:A(),namespace:T({code:A()}).noUnknownFields(),primary:W(),xid:A()}).noUnknownFields()).required()),ge=T({}),hr="alloy_debug",pa=function(e){var n=e.console,r=e.locationSearch,t=e.createLogger,a=e.instanceName,o=e.createNamespacedStorage,i=e.getMonitors,s=Ae.parse(r),c=o("instance."+a+"."),u=c.session.getItem("debug"),d=u==="true",l=u===null,f=function(){return d},v=function(p,m){var h=m.fromConfig;(!h||l)&&(d=p),h||(c.session.setItem("debug",p.toString()),l=!1)};return s[hr]!==void 0&&v(wo(s[hr]),{fromConfig:!1}),{setDebugEnabled:v,logger:t({getDebugEnabled:f,context:{instanceName:a},getMonitors:i,console:n}),createComponentLogger:function(p){return t({getDebugEnabled:f,context:{instanceName:a,componentName:p},getMonitors:i,console:n})}}},ma=["onComponentsRegistered","onBeforeEvent","onBeforeRequest","onResponse","onRequestFailure","onClick"],ha=function(n,r){return function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return Promise.all(n.getLifecycleCallbacks(r).map(function(i){return new Promise(function(s){s(i.apply(void 0,a))})}))}},ya=function(n){return function(){for(var r=arguments.length,t=new Array(r),a=0;a<r;a++)t[a]=arguments[a];return Promise.resolve().then(function(){return n.apply(void 0,t)})}},Ca=function(e){return ma.reduce(function(n,r){return n[r]=ya(ha(e,r)),n},{})},yr=function(n,r){return function(){var t;try{t=n.apply(void 0,arguments)}catch(a){throw Pe({error:a,message:r})}return t instanceof Promise&&(t=t.catch(function(a){throw Pe({error:a,message:r})})),t}},Ea=function(){var e={},n={},r=function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=go(Object.keys(e),Object.keys(i));if(s.length)throw new Error("[ComponentRegistry] Could not register "+o+" "+("because it has existing command(s): "+s.join(",")));Object.keys(i).forEach(function(c){var u=i[c];u.commandName=c,u.run=yr(u.run,"["+o+"] An error occurred while executing the "+c+" command."),e[c]=u})},t=function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Object.keys(i).forEach(function(s){n[s]=n[s]||[],n[s].push(yr(i[s],"["+o+"] An error occurred while executing the "+s+" lifecycle hook."))})};return{register:function(o,i){var s=i.commands,c=i.lifecycle;r(o,s),t(o,c)},getCommand:function(o){return e[o]},getCommandNames:function(){return Object.keys(e)},getLifecycleCallbacks:function(o){return n[o]||[]}}},wa=function(e){var n=e.logger,r=e.sendFetchRequest,t=e.sendBeaconRequest,a=e.isRequestRetryable,o=e.getRequestRetryDelay;return function(i){var s=i.requestId,c=i.url,u=i.payload,d=i.useSendBeacon,l=JSON.stringify(u),f=JSON.parse(l);n.logOnBeforeNetworkRequest({url:c,requestId:s,payload:f});var v=function g(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,m=d?t:r;return m(c,l).then(function(h){var E=a({response:h,retriesAttempted:p});if(E){var w=o({response:h,retriesAttempted:p});return new Promise(function(C){setTimeout(function(){C(g(p+1))},w)})}var y;try{y=JSON.parse(h.body)}catch{}return n.logOnNetworkResponse(I(I({requestId:s,url:c,payload:f},h),{},{parsedBody:y,retriesAttempted:p})),{statusCode:h.statusCode,body:h.body,parsedBody:y,getHeader:h.getHeader}})};return v().catch(function(g){throw n.logOnNetworkError({requestId:s,url:c,payload:f,error:g}),Pe({error:g,message:"Network request failed."})})}},Ia=function(e){var n=e.logger;return function(r){if(r){var t=r.split(";");if(t.length>=2&&t[1].length>0)try{var a=parseInt(t[1],10);if(!isNaN(a))return{regionId:a}}catch{}n.warn('Invalid adobe edge: "'+r+'"')}return{}}},sn="in",Cr="out",Er="pending",se="general",wr="declinedConsent",Me="default",cn="initial",un="new",dn=function(n){var r=new Error(n);return r.code=wr,r.message=n,r},ba=function(e){var n=e.logger,r=[],t=function(){for(;r.length;)r.shift().resolve()},a=function(){for(;r.length;)r.shift().reject(dn("The user declined consent."))},o=function(){return Promise.reject(new Error("Consent has not been initialized."))},i=function(){return Promise.resolve()},s=function(){return Promise.resolve()},c=function(){return Promise.reject(dn("No consent preferences have been set."))},u=function(){return Promise.reject(dn("The user declined consent."))},d=function(f){if(f)return Promise.reject(new Error("Consent is pending."));var v=Ye();return r.push(v),v.promise};return{in:function(f){f===Me?this.awaitConsent=i:(f===cn?n.info("Loaded user consent preferences. The user previously consented."):f===un&&this.awaitConsent!==s&&n.info("User consented."),t(),this.awaitConsent=s)},out:function(f){f===Me?(n.warn("User consent preferences not found. Default consent of out will be used."),this.awaitConsent=c):(f===cn?n.warn("Loaded user consent preferences. The user previously declined consent."):f===un&&this.awaitConsent!==u&&n.warn("User declined consent."),a(),this.awaitConsent=u)},pending:function(f){f===Me&&n.info("User consent preferences not found. Default consent of pending will be used. Some commands may be delayed."),this.awaitConsent=d},awaitConsent:o,withConsent:function(){return this.awaitConsent(!0)}}},Sa=function(e){var n=e.generalConsentState,r=e.logger,t=function(o,i){switch(o[se]){case sn:n.in(i);break;case Cr:n.out(i);break;case Er:n.pending(i);break;default:r.warn("Unknown consent value: "+o[se]);break}};return{initializeConsent:function(o,i){i[se]?t(i,cn):t(o,Me)},setConsent:function(o){t(o,un)},suspend:function(){n.pending()},awaitConsent:function(){return n.awaitConsent()},withConsent:function(){return n.withConsent()}}},Ra=function(){var e={},n,r,t=!1,a=!1,o=!0,i=function(u){if(a)throw new Error(u+" cannot be called after event is finalized.")},s={setUserXdm:function(u){i("setUserXdm"),n=u},setUserData:function(u){i("setUserData"),r=u},mergeXdm:function(u){i("mergeXdm"),u&&H(e,{xdm:u})},mergeMeta:function(u){i("mergeMeta"),u&&H(e,{meta:u})},mergeQuery:function(u){i("mergeQuery"),u&&H(e,{query:u})},documentMayUnload:function(){t=!0},finalize:function(u){if(!a&&(n&&s.mergeXdm(n),r&&(e.data=r),a=!0,u)){o=!1;var d={xdm:e.xdm||{},data:e.data||{}},l=u(d);o=l!==!1,e.xdm=d.xdm||{},e.data=d.data||{},G(e.xdm)&&delete e.xdm,G(e.data)&&delete e.data}},getDocumentMayUnload:function(){return t},isEmpty:function(){return G(e)&&(!n||G(n))&&(!r||G(r))},shouldSend:function(){return o},getViewName:function(){if(!(!n||!n.web||!n.web.webPageDetails))return n.web.webPageDetails.viewName},toJSON:function(){if(!a)throw new Error("toJSON called before finalize");return e}};return s},Da="Retry-After",Oa="x-adobe-edge",Aa=function(e){var n=e.extractEdgeInfo;return function(r){var t=r.content,a=t===void 0?{}:t,o=r.getHeader,i=a.handle,s=i===void 0?[]:i,c=a.errors,u=c===void 0?[]:c,d=a.warnings,l=d===void 0?[]:d;return{getPayloadsByType:function(v){return nn(s.filter(function(g){return g.type===v}),function(g){return g.payload})},getErrors:function(){return u},getWarnings:function(){return l},getEdge:function(){return n(o(Oa))},toJSON:function(){return a}}}},ln="configure",fn="setDebug",Pa=function(e){var n=e.logger,r=e.configureCommand,t=e.setDebugCommand,a=e.handleError,o=e.validateCommandOptions,i,s=function(u,d){var l;if(u===ln){if(i)throw new Error("The library has already been configured and may only be configured once.");l=function(){return i=r(d),i.then(function(){})}}else{if(!i)throw new Error("The library must be configured first. Please do so by executing the configure command.");u===fn?l=function(){return t(d)}:l=function(){return i.then(function(v){var g=v.getCommand(u);if(!g||!z(g.run)){var p=[ln,fn].concat(v.getCommandNames()).join(", ");throw new Error("The "+u+" command does not exist. List of available commands: "+p+".")}var m=o({command:g,options:d});return g.run(m)},function(){return n.warn("An error during configuration is preventing the "+u+" command from executing."),new Promise(function(){})})}}return l};return function(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(d){var l=s(c,u);n.logOnBeforeCommand({commandName:c,options:u}),d(l())}).catch(function(d){return a(d,c+" command")}).catch(function(d){throw n.logOnCommandRejected({commandName:c,options:u,error:d}),d}).then(function(d){var l=x(d)?d:{};return n.logOnCommandResolved({commandName:c,options:u,result:l}),l})}},Ta="https://adobe.ly/3sHgQHb",ka=function(e){var n=e.command,r=e.options,t=n.commandName,a=n.documentationUri,o=a===void 0?Ta:a,i=n.optionsValidator,s=r;if(i)try{s=i(r)}catch(u){var c="Invalid "+t+` command options:
	 - `+u+" For command documentation see: "+o;throw new Error(c)}return s},Na=function(e){var n=e.options,r=T({type:A(),xdm:T({eventType:A(),identityMap:mr}),data:T({}),documentUnloading:W(),renderDecisions:W(),decisionScopes:j(A()).uniqueItems(),personalization:T({decisionScopes:j(A()).uniqueItems(),surfaces:j(A()).uniqueItems()}),datasetId:A(),mergeId:A(),edgeConfigOverrides:ge}).required().noUnknownFields();return r(n)},Ma=function(e){var n=e.options,r=T({renderDecisions:W(),responseHeaders:gr(A().required()),responseBody:T({handle:j(T({type:A().required(),payload:Ne().required()})).required()}).required()}).noUnknownFields();return r(n)},vn=function(n){var r=n.eventManager,t=n.logger;return{commands:{sendEvent:{documentationUri:"https://adobe.ly/3GQ3Q7t",optionsValidator:function(o){return Na({options:o})},run:function(o){var i=o.xdm,s=o.data,c=o.documentUnloading,u=c===void 0?!1:c,d=o.type,l=o.mergeId,f=o.renderDecisions,v=f===void 0?!1:f,g=o.decisionScopes,p=g===void 0?[]:g,m=o.personalization,h=m===void 0?{}:m,E=o.datasetId,w=o.edgeConfigOverrides,y=r.createEvent();u&&y.documentMayUnload(),y.setUserXdm(i),y.setUserData(s),d&&y.mergeXdm({eventType:d}),l&&y.mergeXdm({eventMergeId:l});var C={renderDecisions:v,decisionScopes:p,personalization:h};return w&&(C.edgeConfigOverrides=w),E&&(t.warn("The 'datasetId' option has been deprecated. Please use 'edgeConfigOverrides.experience_platform.datasets.event' instead."),C.edgeConfigOverrides=w||{},H(C.edgeConfigOverrides,{com_adobe_experience_platform:{datasets:{event:{datasetId:E}}}})),r.sendEvent(y,C)}},applyResponse:{documentationUri:"",optionsValidator:function(o){return Ma({options:o})},run:function(o){var i=o.renderDecisions,s=i===void 0?!1:i,c=o.responseHeaders,u=c===void 0?{}:c,d=o.responseBody,l=d===void 0?{handle:[]}:d,f=r.createEvent();return r.applyResponse(f,{renderDecisions:s,responseHeaders:u,responseBody:l})}}}}};vn.namespace="DataCollector",vn.configValidators={};var xa=function(n){var r=n.eventManager,t=n.lifecycle,a=n.handleError;return function(o){var i=o.target,s=r.createEvent();return s.documentMayUnload(),t.onClick({event:s,clickedElement:i}).then(function(){return s.isEmpty()?Promise.resolve():r.sendEvent(s)}).then(q).catch(function(c){a(c,"click collection")})}},qa=function(e){var n=e.eventManager,r=e.lifecycle,t=e.handleError,a=xa({eventManager:n,lifecycle:r,handleError:t});document.addEventListener("click",a,!0)},La={clickCollectionEnabled:W().default(!0),downloadLinkQualifier:A().regexp().default("\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$"),onBeforeLinkClickSend:fr()},Ua=function(e){var n=e.getLinkDetails,r=e.config,t=e.logger,a=r.clickCollectionEnabled;return a?function(o){var i=o.targetElement,s=o.event,c=n({targetElement:i,config:r,logger:t});c&&(s.mergeXdm(c.xdm),s.setUserData(c.data))}:function(){}},Ha=function(e){var n=e.window,r=e.getLinkName,t=e.getLinkRegion,a=e.getAbsoluteUrlFromAnchorElement,o=e.findSupportedAnchorElement,i=e.determineLinkType;return function(s){var c=s.targetElement,u=s.config,d=s.logger,l=o(c);if(!l){d.info("This link click event is not triggered because the HTML element is not an anchor.");return}var f=a(n,l);if(!f){d.info("This link click event is not triggered because the HTML element doesn't have an URL.");return}var v=i(n,u,f,l),g=t(l),p=r(l),m=u.onBeforeLinkClickSend,h={xdm:{eventType:"web.webinteraction.linkClicks",web:{webInteraction:{name:p,region:g,type:v,URL:f,linkClicks:{value:1}}}},data:{},clickedElement:c};if(!m)return h;var E=m(h);if(E!==!1)return h;d.info("This link click event is not triggered because it was canceled in onBeforeLinkClickSend.")}},Fa=function(n){return n&&/^[a-z0-9]+:\/\//i.test(n)},Ba=function(n,r){var t=n.location,a=r.href?r.href:"",o=r.protocol,i=r.host;if(!Fa(a)){o||(o=t.protocol?t.protocol:""),o=o?o+"//":"",i||(i=t.host?t.host:"");var s="";if(a.substring(0,1)!=="/"){var c=t.pathname.lastIndexOf("/");c=c<0?0:c,s=t.pathname.substring(0,c)}a=""+o+i+s+"/"+a}return a},Va=function(n){return!!(n.href&&(n.tagName==="A"||n.tagName==="AREA")&&(!n.onclick||!n.protocol||n.protocol.toLowerCase().indexOf("javascript")<0))},ja=function(n,r,t){var a=new RegExp(n);return t.download?!0:a.test(r.toLowerCase())},Wa=function(n,r){var t=n.location.hostname.toLowerCase();return!(r.toLowerCase().indexOf(t)>=0)},ee=function(n){return n&&n.replace(/\s+/g," ").trim()},za=function(n,r,t,a){var o="other";return ja(r.downloadLinkQualifier,t,a)?o="download":Wa(n,t)&&(o="exit"),o},$a=function(n){for(var r=n;r;){if(Va(r))return r;r=r.parentNode}return null},Ga=/^(SCRIPT|STYLE|LINK|CANVAS|NOSCRIPT|#COMMENT)$/i,Qa=function(n){return!(n&&n.nodeName&&n.nodeName.match(Ga))},Ja=function e(n){var r=[],t=!1;if(Qa(n)){if(r.push(n),n.childNodes){var a=Array.prototype.slice.call(n.childNodes);a.forEach(function(o){var i=e(o);r=r.concat(i.supportedNodes),t=t||i.includesUnsupportedNodes})}}else t=!0;return{supportedNodes:r,includesUnsupportedNodes:t}},Ir=function(n,r,t){var a;return(!t||t===n.nodeName.toUpperCase())&&(a=n.getAttribute(r)),a},Xa=function(n){var r={texts:[]};return n.supportedNodes.forEach(function(t){t.getAttribute&&(r.alt||(r.alt=ee(t.getAttribute("alt"))),r.title||(r.title=ee(t.getAttribute("title"))),r.inputValue||(r.inputValue=ee(Ir(t,"value","INPUT"))),r.imgSrc||(r.imgSrc=ee(Ir(t,"src","IMG")))),t.nodeValue&&r.texts.push(t.nodeValue)}),r},Ya=function(e){var n=ee(e.innerText||e.textContent),r=Ja(e);if(!n||r.includesUnsupportedNodes){var t=Xa(r);n=ee(t.texts.join("")),n||(n=t.alt||t.title||t.inputValue||t.imgSrc)}return n||""},_a=/^(HEADER|MAIN|FOOTER|NAV)$/i,Ka=function(n){var r;return n.role==="region"&&Q(n["aria-label"])&&(r=n["aria-label"]),r},Za=function(n){var r;return n&&n.nodeName&&n.nodeName.match(_a)&&(r=n.nodeName),r},ei=function(e){for(var n=e.parentNode,r;n;){if(r=ee(n.id||Ka(n)||Za(n)),r)return r;n=n.parentNode}return"BODY"},br=Ha({window,getLinkName:Ya,getLinkRegion:ei,getAbsoluteUrlFromAnchorElement:Ba,findSupportedAnchorElement:$a,determineLinkType:za}),xe=function(n){var r=n.config,t=n.eventManager,a=n.handleError,o=n.logger,i=Ua({getLinkDetails:br,config:r,logger:o});return{lifecycle:{onComponentsRegistered:function(c){var u=c.lifecycle;qa({eventManager:t,lifecycle:u,handleError:a})},onClick:function(c){var u=c.event,d=c.clickedElement;i({targetElement:d,event:u})}}}};xe.namespace="ActivityCollector",xe.configValidators=La,xe.buildOnInstanceConfiguredExtraParams=function(e){var n=e.config,r=e.logger;return{getLinkDetails:function(a){return br({targetElement:a,config:n,logger:r})}}};var Sr=function(n,r){return"ID sync "+(r?"succeeded":"failed")+": "+n.spec.url},ni=function(e){var n=e.fireReferrerHideableImage,r=e.logger;return function(t){var a=t.filter(function(o){return o.type==="url"});return a.length?Promise.all(a.map(function(o){return n(o.spec).then(function(){r.info(Sr(o,!0))}).catch(function(){r.error(Sr(o,!1))})})).then(q):Promise.resolve()}},ri={thirdPartyCookiesEnabled:W().default(!0),idMigrationEnabled:W().default(!0)},ti=T({namespaces:j(vr("ECID")).nonEmpty().uniqueItems().default(["ECID"]),edgeConfigOverrides:ge}).noUnknownFields().default({namespaces:["ECID"]}),oi=T({url:A().required().nonEmpty(),edgeConfigOverrides:ge}).required().noUnknownFields(),ai=function(e){var n=e.addEcidQueryToPayload,r=e.addQueryStringIdentityToPayload,t=e.ensureSingleIdentity,a=e.setLegacyEcid,o=e.handleResponseForIdSyncs,i=e.getEcidFromResponse,s=e.getIdentity,c=e.consent,u=e.appendIdentityToUrl,d=e.logger,l,f={};return{lifecycle:{onBeforeRequest:function(g){var p=g.request,m=g.onResponse,h=g.onRequestFailure;return n(p.getPayload()),r(p.getPayload()),t({request:p,onResponse:m,onRequestFailure:h})},onResponse:function(g){var p=g.response;return l||(l=i(p),l&&a(l)),f=N(f,p.getEdge()),o(p)}},commands:{getIdentity:{optionsValidator:ti,run:function(g){return c.awaitConsent().then(function(){return l?void 0:s(g)}).then(function(){return{identity:{ECID:l},edge:f}})}},appendIdentityToUrl:{optionsValidator:oi,run:function(g){return c.withConsent().then(function(){return l?void 0:s(g)}).then(function(){return{url:u(l,g.url)}}).catch(function(p){return d.warn("Unable to append identity to url. "+p.message),g})}}}}},ii=function(e){var n=e.config,r=e.getEcidFromVisitor,t=e.apexDomain,a=e.isPageSsl,o=e.cookieJar,i=n.idMigrationEnabled,s=n.orgId,c="AMCV_"+s,u=function(){var l=null,f="s_ecid",v=o.get(f)||o.get(c);if(v){var g=/(^|\|)MCMID\|(\d+)($|\|)/,p=v.match(g);p&&(l=p[2])}return l};return{getEcid:function(){if(i){var l=u();return l?Promise.resolve(l):r()}return Promise.resolve()},setEcid:function(l){if(i&&u()!==l){var f=a?{sameSite:"none",secure:!0}:{};o.set(c,"MCMID|"+l,I({domain:t,expires:390},f))}}}},si=function(e){var n=e.logger;return new Promise(function(r,t){if(x(window.adobe)&&x(window.adobe.optIn)){var a=window.adobe.optIn;n.info("Delaying request while waiting for legacy opt-in to let Visitor retrieve ECID from server."),a.fetchPermissions(function(){a.isApproved([a.Categories.ECID])?(n.info("Received legacy opt-in approval to let Visitor retrieve ECID from server."),r()):t(new Error("Legacy opt-in was declined."))},!0)}else r()})},ci=function(e){var n=e.Visitor;return z(n)&&z(n.getInstance)&&n},ui=function(e){var n=e.logger,r=e.orgId,t=e.awaitVisitorOptIn;return function(){var a=ci(window);return a?t({logger:n}).then(function(){return n.info("Delaying request while using Visitor to retrieve ECID from server."),new Promise(function(o){var i=a.getInstance(r,{});i.getMarketingCloudVisitorID(function(s){n.info("Resuming previously delayed request that was waiting for ECID from Visitor."),o(s)},!0)})}).catch(function(o){o?n.info(o.message+", retrieving ECID from experience edge"):n.info("An error occurred while obtaining the ECID from Visitor.")}):Promise.resolve()}},di=function(e){var n=e.processIdSyncs;return function(r){return n(r.getPayloadsByType("identity:exchange"))}},li=function(e){var n=e.doesIdentityCookieExist,r=e.setDomainForInitialIdentityPayload,t=e.addLegacyEcidToPayload,a=e.awaitIdentityCookie,o=e.logger,i,s=function(u){return r(u),t(u.getPayload())};return function(c){var u=c.request,d=c.onResponse,l=c.onRequestFailure;if(n())return u.setIsIdentityEstablished(),Promise.resolve();if(i){o.info("Delaying request while retrieving ECID from server.");var f=i;return i=f.catch(function(){return a({onResponse:d,onRequestFailure:l})}),f.then(function(){o.info("Resuming previously delayed request."),u.setIsIdentityEstablished()}).catch(function(){return s(u)})}return i=a({onResponse:d,onRequestFailure:l}),s(u)}},ce="ECID",fi=function(e){e.mergeQuery({identity:{fetch:[ce]}})},vi=function(n){return function(r){for(var t=Object.keys(n),a=0;a<t.length;a+=1){var o=t[a],i=n[o];if(i.test(r))return o}return Gn}},gi=mo(function(e){var n;return vi((n={},B(n,Wn,/Edge\/([0-9\._]+)/),B(n,zn,/Edg\/([0-9\.]+)/),B(n,jn,/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/),B(n,gt,/Firefox\/([0-9\.]+)(?:\s|$)/),B(n,$n,/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/),B(n,pt,/Version\/([0-9\._]+).*Safari/),n))(e.navigator.userAgent)}),pi=function(e){var n=e.thirdPartyCookiesEnabled,r=e.areThirdPartyCookiesSupportedByDefault;return function(t){n&&r(gi(window))&&t.setUseIdThirdPartyDomain()}},mi=function(e){var n=e.getLegacyEcid,r=e.addEcidToPayload;return function(t){return t.hasIdentity(ce)?Promise.resolve():n().then(function(a){a&&r(t,a)})}},hi="adobe_mc",yi=300,Ci=function(e){var n=e.locationSearch,r=e.dateProvider,t=e.orgId,a=e.logger;return function(o){if(!o.hasIdentity(ce)){var i=Ae.parse(n),s=i[hi];if(s!==void 0){var c=s.split("|").reduce(function(f,v){var g=v.split("="),p=_(g,2),m=p[0],h=p[1];return f[m]=h,f},{}),u=parseInt(c.TS,10),d=c.MCMID,l=decodeURIComponent(c.MCORGID);r().getTime()/1e3<=u+yi&&l===t&&d?(a.info("Found valid ECID identity "+d+" from the adobe_mc query string parameter."),o.addIdentity(ce,{id:d})):a.info("Detected invalid or expired adobe_mc query string parameter.")}}}},Ei=function(e,n){e.addIdentity(ce,{id:n})},wi=function(e){var n=e.doesIdentityCookieExist,r=e.orgId;return function(t){var a=t.onResponse,o=t.onRequestFailure;return new Promise(function(i,s){a(function(){if(n())i();else{var c=new Error("An identity was not set properly. Please verify that the org ID "+r+" configured in Alloy matches the org ID specified in the edge configuration.");throw s(c),c}}),o(function(){n()?i():s(new Error("No identity was set on response."))})})}},Ii=function(e){var n=e.getPayloadsByType("identity:result"),r=_n(n,function(t){return t.namespace&&t.namespace.code===ce});return r?r.id:void 0},bi=function(e){var n=e.sendEdgeNetworkRequest,r=e.createIdentityRequestPayload,t=e.createIdentityRequest,a=e.globalConfigOverrides;return function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=o.namespaces,s=o.edgeConfigOverrides,c=r(i),u=t(c);return c.mergeConfigOverride(a),c.mergeConfigOverride(s),n({request:u})}},Rr=function(e){return function(n,r){e.xdm=e.xdm||{},e.xdm.identityMap=e.xdm.identityMap||{},e.xdm.identityMap[n]=e.xdm.identityMap[n]||[],e.xdm.identityMap[n].push(r)}},gn=function(e){var n=e.payload,r=e.getAction,t=e.getUseSendBeacon,a=on(),o=!1,i=!1;return{getId:function(){return a},getPayload:function(){return n},getAction:function(){return r({isIdentityEstablished:i})},getUseSendBeacon:function(){return t({isIdentityEstablished:i})},getUseIdThirdPartyDomain:function(){return o},setUseIdThirdPartyDomain:function(){o=!0},setIsIdentityEstablished:function(){i=!0}}},Si=function(e){var n=function(t){var a=t.isIdentityEstablished;return e.getDocumentMayUnload()&&a};return gn({payload:e,getAction:function(t){var a=t.isIdentityEstablished;return n({isIdentityEstablished:a})?"collect":"interact"},getUseSendBeacon:n})},pn=function(e){var n=e.content,r=e.addIdentity,t=e.hasIdentity,a=we(n,"meta.configOverrides");return{mergeMeta:we(n,"meta"),mergeState:we(n,"meta.state"),mergeQuery:we(n,"query"),mergeConfigOverride:function(i){return a(ho(i))},addIdentity:r,hasIdentity:t,toJSON:function(){return n}}},Dr=function(e){return function(n){return(e.xdm&&e.xdm.identityMap&&e.xdm.identityMap[n])!==void 0}},Ri=function(){var e={},n=pn({content:e,addIdentity:Rr(e),hasIdentity:Dr(e)});return n.addEvent=function(r){e.events=e.events||[],e.events.push(r)},n.getDocumentMayUnload=function(){return(e.events||[]).some(function(r){return r.getDocumentMayUnload()})},n},Di="adb_validation_sessionid",Oi="validation.",Or="clientId",Ai=function(n){var r=n.persistent.getItem(Or);return r||(r=on(),n.persistent.setItem(Or,r)),r},Pi=function(e){var n=e.window,r=e.createNamespacedStorage,t=r(Oi);return function(){var a=Ae.parse(n.location.search),o=a[Di];if(!o)return"";var i=Ai(t),s=o+"|"+i;return"&"+Ae.stringify({adobeAepValidationToken:s})}},Ti=function(e){return gn({payload:e,getAction:function(){return"identity/acquire"},getUseSendBeacon:function(){return!1}})},ki=function(e){var n={query:{identity:{fetch:e}}};return pn({content:n,addIdentity:Rr(n),hasIdentity:Dr(n)})},Ni=/^([^?#]*)(\??[^#]*)(#?.*)$/,Mi=function(n){return n===""?"?":n==="?"?"":"&"},xi=function(e){var n=e.dateProvider,r=e.orgId;return function(t,a){var o=Math.round(n().getTime()/1e3),i=encodeURIComponent("TS="+o+"|MCMID="+t+"|MCORGID="+encodeURIComponent(r)),s=a.match(Ni),c=_(s,4),u=c[1],d=c[2],l=c[3],f=Mi(d);return""+u+d+f+"adobe_mc="+i+l}},mn=function(n){var r=n.config,t=n.logger,a=n.consent,o=n.fireReferrerHideableImage,i=n.sendEdgeNetworkRequest,s=n.apexDomain,c=r.orgId,u=r.thirdPartyCookiesEnabled,d=r.edgeConfigOverrides,l=ui({logger:t,orgId:c,awaitVisitorOptIn:si}),f=Xe({logger:t,cookieJar:Y}),v=ii({config:r,getEcidFromVisitor:l,apexDomain:s,cookieJar:f,isPageSsl:window.location.protocol==="https:"}),g=rr({orgId:c}),p=bi({sendEdgeNetworkRequest:i,createIdentityRequestPayload:ki,createIdentityRequest:Ti,globalConfigOverrides:d}),m=pi({thirdPartyCookiesEnabled:u,areThirdPartyCookiesSupportedByDefault:ht}),h=mi({getLegacyEcid:v.getEcid,addEcidToPayload:Ei}),E=Ci({locationSearch:window.document.location.search,dateProvider:function(){return new Date},orgId:c,logger:t}),w=wi({doesIdentityCookieExist:g,orgId:c}),y=li({doesIdentityCookieExist:g,setDomainForInitialIdentityPayload:m,addLegacyEcidToPayload:h,awaitIdentityCookie:w,logger:t}),C=ni({fireReferrerHideableImage:o,logger:t}),k=di({processIdSyncs:C}),b=xi({dateProvider:function(){return new Date},orgId:c});return ai({addEcidQueryToPayload:fi,addQueryStringIdentityToPayload:E,ensureSingleIdentity:y,setLegacyEcid:v.setEcid,handleResponseForIdSyncs:k,getEcidFromResponse:Ii,getIdentity:p,consent:a,appendIdentityToUrl:b,logger:t})};mn.namespace="Identity",mn.configValidators=ri;var qi=function(n,r){return"URL destination succeeded: "+n.spec.url},Li=function(e){var n=e.fireReferrerHideableImage,r=e.logger,t=e.cookieJar,a=e.isPageSsl,o=a?{sameSite:"none",secure:!0}:{},i=function(u){var d=u.filter(function(l){return l.type==="cookie"});d.forEach(function(l){var f=l.spec,v=f.name,g=f.value,p=f.domain,m=f.ttlDays;t.set(v,g||"",I({domain:p||"",expires:m||10},o))})},s=function(u){var d=u.filter(function(l){return l.type==="url"});return Promise.all(d.map(function(l){return n(l.spec).then(function(){r.info(qi(l))}).catch(function(){})})).then(q)};return function(c){return i(c),s(c)}},Ui=function(e){var n=e.processDestinations,r=function(o){var i=o.response,s=i.getPayloadsByType("activation:push");return n(s)},t=function(o){var i=o.response;return{destinations:i.getPayloadsByType("activation:pull")}};return function(a){var o=a.response;return r({response:o}).then(function(){return t({response:o})})}},hn=function(n){var r=n.logger,t=n.fireReferrerHideableImage,a=Y.withConverter({write:function(u){return encodeURIComponent(u)}}),o=Xe({logger:r,cookieJar:a}),i=Li({fireReferrerHideableImage:t,logger:r,cookieJar:o,isPageSsl:window.location.protocol==="https:"}),s=Ui({processDestinations:i});return{lifecycle:{onResponse:s},commands:{}}};hn.namespace="Audiences",hn.configValidators={};var yn="web",Hi="webapp",Cn="://",Ar="#",Fi=/^(\w+):\/\/([^/#]+)(\/[^#]*)?(#.*)?$/,Bi=/^(?:.*@)?(?:[a-z\d\u00a1-\uffff.-]+|\[[a-f\d:]+])(?::\d+)?$/,Vi=/^\/(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})*$/,ji=/^#(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})+$/,Pr=function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"/",r=n.length;r>0&&"/".indexOf(n.charAt(r-1))!==-1;)r-=1;return n.substring(0,r)||"/"},Wi=function(n){return Q(n)?n.toLowerCase():""},zi=function(n){return Q(n)?n.toLowerCase():""},$i=function(n){return Q(n)?Pr(n):"/"},Gi=function(n){var r=n.match(Fi);return r?{surfaceType:Wi(r[1]),authority:zi(r[2]),path:$i(r[3]),fragment:r[4]}:null},Qi=function(n){return""+n.surfaceType+Cn+n.authority+(n.path||"")+(n.fragment||"")},Tr=function(n){var r=n(),t=r.host.toLowerCase(),a=r.pathname;return yn+Cn+t+Pr(a)},Ji=function(n,r){return _e(n,Ar)?Tr(r)+n:n},Xi=function(n,r,t){var a=function(c){return t.warn(c),null};if(!Q(n))return a("Invalid surface: "+n);var o=Ji(n,r),i=Gi(o);return i===null?a("Invalid surface: "+n):V([yn,Hi],i.surfaceType)?!i.authority||!Bi.test(i.authority)?a("Invalid authority "+i.authority+" in surface: "+n):i.path&&!Vi.test(i.path)?a("Invalid path "+i.path+" in surface: "+n):i.fragment&&!ji.test(i.fragment)?a("Invalid fragment "+i.fragment+" in surface: "+n):i:a("Unsupported surface type "+i.surfaceType+" in surface: "+n)},Yi=function(n){return!!n&&n.indexOf(yn+Cn)===0&&n.indexOf(Ar)===-1},_i=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;return n.map(function(a){return Xi(a,r,t)}).filter(function(a){return!te(a)}).map(Qi)},ne="__view__",kr="https://ns.adobe.com/personalization/default-content-item",En="https://ns.adobe.com/personalization/dom-action",wn="https://ns.adobe.com/personalization/html-content-item",Ki="https://ns.adobe.com/personalization/json-content-item",Nr="https://ns.adobe.com/personalization/redirect-item",Zi="https://ns.adobe.com/personalization/measurement",es=function(n){V(n,ne)||n.push(ne)},ns=function(n,r){var t=Tr(r);V(n,t)||n.push(t)},Mr=function(n){return n.filter(function(r,t){return n.indexOf(r)===t})},rs=function(e){var n=e.getPageLocation,r=e.renderDecisions,t=e.decisionScopes,a=e.personalization,o=e.event,i=e.viewCache,s=e.logger,c=o.getViewName();return{isRenderDecisions:function(){return r},getViewName:function(){return c},hasScopes:function(){return t.length>0||D(a.decisionScopes)},hasSurfaces:function(){return D(a.surfaces)},hasViewName:function(){return Q(c)},createQueryDetails:function(){var d=R(t);D(a.decisionScopes)&&d.push.apply(d,R(a.decisionScopes));var l=_i(a.surfaces,n,s);this.isCacheInitialized()||(es(d),ns(l,n));var f=[kr,wn,Ki,Nr];return V(d,ne)&&f.push(En),{schemas:f,decisionScopes:Mr(d),surfaces:Mr(l)}},isCacheInitialized:function(){return i.isInitialized()},shouldFetchData:function(){return this.hasScopes()||this.hasSurfaces()||!this.isCacheInitialized()},shouldUseCachedData:function(){return this.hasViewName()&&this.isCacheInitialized()}}},ts="Rendering is disabled for authoring mode.",os="An error occurred while executing the redirect offer.",xr={propositions:[]},as=function(e){var n=e.logger,r=e.options,t=T({propositions:j(T(Ne())).nonEmpty(),metadata:T(Ne())}).required();try{return t(r)}catch(a){return n.warn("Invalid options for applyPropositions. No propositions will be applied.",a),xr}},is=function(e){var n=e.getPageLocation,r=e.logger,t=e.fetchDataHandler,a=e.viewChangeHandler,o=e.onClickHandler,i=e.isAuthoringModeEnabled,s=e.mergeQuery,c=e.viewCache,u=e.showContainers,d=e.applyPropositions,l=e.setTargetMigration;return{lifecycle:{onBeforeRequest:function(v){var g=v.request;return l(g),Promise.resolve()},onBeforeEvent:function(v){var g=v.event,p=v.renderDecisions,m=v.decisionScopes,h=m===void 0?[]:m,E=v.personalization,w=E===void 0?{}:E,y=v.onResponse,C=y===void 0?q:y,k=v.onRequestFailure,b=k===void 0?q:k;if(C(function(){return{propositions:[]}}),b(function(){return u()}),i()){r.warn(ts),s(g,{enabled:!1});return}var U=rs({getPageLocation:n,renderDecisions:p,decisionScopes:h,personalization:w,event:g,viewCache:c,logger:r});if(U.shouldFetchData()){var X=Ye();c.storeViews(X.promise),b(function(){return X.reject()}),t({decisionsDeferred:X,personalizationDetails:U,event:g,onResponse:C});return}if(U.shouldUseCachedData())return a({personalizationDetails:U,event:g,onResponse:C,onRequestFailure:b})},onClick:function(v){var g=v.event,p=v.clickedElement;o({event:g,clickedElement:p})}},commands:{applyPropositions:{optionsValidator:function(v){return as({logger:r,options:v})},run:d}}}},pe=function(e){return Z(Ut,{},{innerHTML:e})},ss=Ce(function(e,n){(function(r,t){e.exports=t(r)})(ue,function(r){if(r.CSS&&r.CSS.escape)return r.CSS.escape;var t=function(o){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var i=String(o),s=i.length,c=-1,u,d="",l=i.charCodeAt(0);++c<s;){if(u=i.charCodeAt(c),u==0){d+="�";continue}if(u>=1&&u<=31||u==127||c==0&&u>=48&&u<=57||c==1&&u>=48&&u<=57&&l==45){d+="\\"+u.toString(16)+" ";continue}if(c==0&&s==1&&u==45){d+="\\"+i.charAt(c);continue}if(u>=128||u==45||u==95||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122){d+=i.charAt(c);continue}d+="\\"+i.charAt(c)}return d};return r.CSS||(r.CSS={}),r.CSS.escape=t,t})}),cs=":eq(",us=/:eq\((\d+)\)/g,qr=function(n){return n.indexOf(cs)===-1},ds=function(n){return n.split(us).filter(Q)},ls=/(#|\.)(-?\w+)/g,fs=function(n,r,t){return""+r+ss(t)},vs=function(n){return n.replace(ls,fs)},gs=function(n){for(var r=[],t=vs(n.trim()),a=ds(t),o=a.length,i=0;i<o;){var s=a[i],c=a[i+1];c?r.push({sel:s,eq:Number(c)}):r.push({sel:s}),i+=2}return r},In=function(n){var r=document;if(qr(n))return $(n,r);for(var t=gs(n),a=t.length,o=[],i=r,s=0;s<a;){var c=t[s],u=c.sel,d=c.eq,l=$(u,i),f=l.length;if(f===0||d!=null&&d>f-1)break;if(s<a-1)if(d==null){var v=_(l,1);i=v[0]}else i=l[d];s===a-1&&(d==null?o=l:o=[l[d]]),s+=1}return o},Lr=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;return n.getElementById(e)},Ur=function(e,n,r){e.setAttribute(n,r)},me=function(e,n){return e.getAttribute(n)},ps=function(e,n){e.removeAttribute(n)},ms=function(e,n,r,t){var a;t?a=n+":"+r+" !"+t+";":a=n+":"+r+";",e.style.cssText+=";"+a},Hr=function(e){return e.parentNode},hs=function(e){return e.nextElementSibling},Fr=function(e,n){if(e){var r=Hr(e);r&&r.insertBefore(n,hs(e))}},bn=function(e,n){if(e){var r=Hr(e);r&&r.insertBefore(n,e)}},ys=function(e){var n=e.children;return n?Se(n):[]},he=function(e){var n=e.childNodes;return n?Se(n):[]},Cs=function(e){return e.firstElementChild},Sn,qe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;if(Sn===void 0){var n=e.querySelector("[nonce]");Sn=n&&(n.nonce||n.getAttribute("nonce"))}return Sn},Rn="alloy-prehiding",Es="{ visibility: hidden }",Le={},ws=function(n){if(!Le[n]){var r=qe(),t=I({},r&&{nonce:r}),a={textContent:n+" "+Es},o=Z(be,t,a);oe(document.head,o),Le[n]=o}},Br=function(n){var r=Le[n];r&&(le(r),delete Le[n])},Is=function(n){if(n){var r=Lr(Rn);if(!r){var t=qe(),a=I({id:Rn},t&&{nonce:t}),o={textContent:n},i=Z(be,a,o);oe(document.head,i)}}},Ue=function(){var n=Lr(Rn);n&&le(n)},bs=function(e,n){e.textContent=n},re="src",Ss=function(n){return n.tagName===Ie},Vr=function(n){return Z(Ie,{src:n})},He=function(n){var r=$(Ie,n);r.forEach(function(t){var a=me(t,re);a&&Vr(a)})},Rs=function(n,r){return n.tagName===r},Ds=function(n){return Rs(n,be)&&!me(n,re)},Fe=function(e){var n=$(be,e),r=n.length,t=qe();if(t)for(var a=0;a<r;a+=1){var o=n[a];Ds(o)&&(o.nonce=t)}};function Os(e){var n=this.constructor;return this.then(function(r){return n.resolve(e()).then(function(){return r})},function(r){return n.resolve(e()).then(function(){return n.reject(r)})})}var As=setTimeout;function jr(e){return!!(e&&typeof e.length<"u")}function Ps(){}function Ts(e,n){return function(){e.apply(n,arguments)}}function S(e){if(!(this instanceof S))throw new TypeError("Promises must be constructed via new");if(typeof e!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],zr(e,this)}function Wr(e,n){for(;e._state===3;)e=e._value;if(e._state===0){e._deferreds.push(n);return}e._handled=!0,S._immediateFn(function(){var r=e._state===1?n.onFulfilled:n.onRejected;if(r===null){(e._state===1?Dn:ye)(n.promise,e._value);return}var t;try{t=r(e._value)}catch(a){ye(n.promise,a);return}Dn(n.promise,t)})}function Dn(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&(F(n)==="object"||typeof n=="function")){var r=n.then;if(n instanceof S){e._state=3,e._value=n,On(e);return}else if(typeof r=="function"){zr(Ts(r,n),e);return}}e._state=1,e._value=n,On(e)}catch(t){ye(e,t)}}function ye(e,n){e._state=2,e._value=n,On(e)}function On(e){e._state===2&&e._deferreds.length===0&&S._immediateFn(function(){e._handled||S._unhandledRejectionFn(e._value)});for(var n=0,r=e._deferreds.length;n<r;n++)Wr(e,e._deferreds[n]);e._deferreds=null}function ks(e,n,r){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof n=="function"?n:null,this.promise=r}function zr(e,n){var r=!1;try{e(function(t){r||(r=!0,Dn(n,t))},function(t){r||(r=!0,ye(n,t))})}catch(t){if(r)return;r=!0,ye(n,t)}}S.prototype.catch=function(e){return this.then(null,e)},S.prototype.then=function(e,n){var r=new this.constructor(Ps);return Wr(this,new ks(e,n,r)),r},S.prototype.finally=Os,S.all=function(e){return new S(function(n,r){if(!jr(e))return r(new TypeError("Promise.all accepts an array"));var t=Array.prototype.slice.call(e);if(t.length===0)return n([]);var a=t.length;function o(s,c){try{if(c&&(F(c)==="object"||typeof c=="function")){var u=c.then;if(typeof u=="function"){u.call(c,function(d){o(s,d)},r);return}}t[s]=c,--a===0&&n(t)}catch(d){r(d)}}for(var i=0;i<t.length;i++)o(i,t[i])})},S.resolve=function(e){return e&&F(e)==="object"&&e.constructor===S?e:new S(function(n){n(e)})},S.reject=function(e){return new S(function(n,r){r(e)})},S.race=function(e){return new S(function(n,r){if(!jr(e))return r(new TypeError("Promise.race accepts an array"));for(var t=0,a=e.length;t<a;t++)S.resolve(e[t]).then(n,r)})},S._immediateFn=typeof setImmediate=="function"&&function(e){setImmediate(e)}||function(e){As(e,0)},S._unhandledRejectionFn=function(n){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};var Ns=typeof window<"u"&&window.Promise||typeof ue<"u"&&ue.Promise||S.default||S,Ms=function(n,r){return new Ns(function(t,a){r.onload=function(){t(r)},r.onerror=function(){a(new Error("Failed to load script "+n))}})},xs=function(n){var r=document.createElement("script");r.src=n,r.async=!0;var t=Ms(n,r);return document.getElementsByTagName("head")[0].appendChild(r),t},An=function(n,r){return!!n&&n.tagName===r},qs=function(n){return An(n,de)&&!me(n,re)},Ls=function(n){return An(n,de)&&me(n,re)},Be=function(n){for(var r=$(de,n),t=[],a=r.length,o=qe(),i=I({},o&&{nonce:o}),s=0;s<a;s+=1){var c=r[s];if(qs(c)){var u=c.textContent;u&&t.push(Z(de,i,{textContent:u}))}}return t},Ve=function(n){for(var r=$(de,n),t=[],a=r.length,o=0;o<a;o+=1){var i=r[o];if(Ls(i)){var s=me(i,re);s&&t.push(s)}}return t},je=function(n,r){r.forEach(function(t){n.appendChild(t),n.removeChild(t)})},We=function(n){return Promise.all(n.map(xs))},$r=function(e,n){var r=pe(n);Fe(r);var t=he(r),a=Be(r),o=Ve(r);return He(r),t.forEach(function(i){oe(e,i)}),je(e,a),We(o)},Us=function(n){var r=he(n);r.forEach(le)},Hs=function(e,n){Us(e),$r(e,n)},Gr=function(e,n){var r=pe(n);Fe(r);var t=he(r),a=Be(r),o=Ve(r),i=t.length,s=i-1;for(He(r);s>=0;){var c=t[s],u=Cs(e);u?bn(u,c):oe(e,c),s-=1}return je(e,a),We(o)},Qr=function(e,n){var r=pe(n);Fe(r);var t=he(r),a=Be(r),o=Ve(r);return He(r),t.forEach(function(i){bn(e,i)}),je(e,a),We(o)},Fs=function(e,n){Qr(e,n),le(e)},Bs=function(e,n){var r=pe(n);Fe(r);var t=he(r),a=Be(r),o=Ve(r);return He(r),t.forEach(function(i){Fr(e,i)}),je(e,a),We(o)},Vs=["priority"],Pn=function(e,n){var r=n.priority,t=Xn(n,Vs);Object.keys(t).forEach(function(a){ms(e,a,t[a],r)})},js=function(e,n){Object.keys(n).forEach(function(r){Ur(e,r,n[r])})},Ws=function(e,n){Ss(e)&&(Vr(n),ps(e,re),Ur(e,re,n))},zs=function(e,n){var r=n.from,t=n.to,a=ys(e),o=a[r],i=a[t];!o||!i||(r<t?Fr(i,o):bn(i,o))},$s=function(e,n){var r=e.selector,t=e.meta;return n({selector:r,meta:t}),Promise.resolve()},Gs=function(n,r,t){var a=n.map(function(o){return t(o,r)});return Promise.all(a)},M=function(n){return function(r){var t=r.selector,a=r.prehidingSelector,o=r.content,i=r.meta;return ws(a),Zn(t,In).then(function(s){return Gs(s,o,n)}).then(function(){return Br(a),{meta:i}},function(s){return Br(a),{meta:i,error:s}})}},Qs=function(e){return{setHtml:M(Hs),customCode:M(Gr),setText:M(bs),setAttribute:M(js),setImageSource:M(Ws),setStyle:M(Pn),move:M(Pn),resize:M(Pn),rearrange:M(zs),remove:M(le),insertAfter:M(Bs),insertBefore:M(Qr),replaceHtml:M(Fs),prependHtml:M(Gr),appendHtml:M($r),click:function(r){return $s(r,e)},defaultContent:function(r){return Promise.resolve({meta:r.meta})}}},Js=function(e){return fe(e)?!e.trim():!0},Xs="appendHtml",Ys="SCRIPT,LINK,STYLE",_s=function(n){var r=pe(n),t=$(Ys,r);return t.map(function(a){return a.outerHTML}).join("")},Ks=function(e){var n=N({},e),r=n.content,t=n.selector;if(Js(r))return n;var a=In(t);return An(a[0],Ht)&&(n.type=Xs,n.content=_s(r)),n},Zs="customCode",ec="BODY > *:eq(0)",nc=function(e){var n=e.selector,r=e.type;return r!==Zs||n!==ec?e:N({},e,{selector:"BODY"})},Jr=function(n,r,t){if(n.enabled){var a=JSON.stringify(r),o=t.message,i=t.stack,s="Failed to execute action "+a+". "+o+" "+(i?`
 `+i:"");n.error(s)}},rc=function(n,r){if(n.enabled){var t=JSON.stringify(r);n.info("Action "+t+" executed.")}},tc=function(n,r,t,a){var o=r[t];if(!o){var i=new Error('DOM action "'+t+'" not found');throw Jr(n,a[0],i),i}return o.apply(void 0,R(a))},oc=[Ks,nc],ac=function(n){return oc.reduce(function(r,t){return N(r,t(r))},n)},ic=function(e,n,r){var t=e.map(function(a){var o=ac(a),i=o.type;return tc(r,n,i,[o]).then(function(s){return rc(r,o),s}).catch(function(s){throw Jr(r,o,s),s})});return Promise.all(t)},sc="decisioning.propositionDisplay",cc="decisioning.propositionInteract",Tn={DISPLAY:"display",INTERACT:"interact"},uc=function(e){var n=e.eventManager,r=e.mergeDecisionsMeta;return function(t){var a=t.decisionsMeta,o=a===void 0?[]:a,i=t.documentMayUnload,s=i===void 0?!1:i,c=t.viewName,u=n.createEvent(),d={eventType:sc};return c&&(d.web={webPageDetails:{viewName:c}}),D(o)&&r(u,o,Tn.DISPLAY),u.mergeXdm(d),s&&u.documentMayUnload(),n.sendEvent(u)}},dc="defaultContent",lc=function(n){return n},fc=function(n,r){return n.characteristics&&n.characteristics.trackingLabel?N({trackingLabel:n.characteristics.trackingLabel},r):r},vc=function(n){var r={id:n.id,scope:n.scope,scopeDetails:n.scopeDetails};return n.items.map(function(t){return N({type:dc},t.data,{meta:fc(t,r)})})},gc=function(n,r){var t=nn(r,lc),a=[],o=new Set;return t.forEach(function(i){if(i){if(i.error){n.warn(i);return}var s=i.meta;o.has(s.id)||(o.add(s.id),a.push(s))}}),a},pc=function(e){var n=e.modules,r=e.logger,t=e.executeActions;return function(a){var o=a.map(function(i){var s=vc(i);return t(s,n,r)});return Promise.all(o).then(function(i){return gc(r,i)}).catch(function(i){r.error(i)})}},mc=function(e){var n=e.prehidingStyle,r=e.responseHandler,t=e.hideContainers,a=e.mergeQuery;return function(o){var i=o.decisionsDeferred,s=o.personalizationDetails,c=o.event,u=o.onResponse;s.isRenderDecisions()&&t(n),a(c,s.createQueryDetails()),u(function(d){var l=d.response;return r({decisionsDeferred:i,personalizationDetails:s,response:l})})}},hc=function(e,n){if(qr(e))return ro(e,n);for(var r=In(e),t=!1,a=0;a<r.length;a+=1)if(r[a]===n){t=!0;break}return t},yc=function(n,r,t){for(var a=document,o=a.documentElement,i=n,s=0;i&&i!==o;){if(hc(r,i)){var c=t(r),u=c.find(function(d){return d.trackingLabel});return u?{metas:c,label:u.trackingLabel,weight:s}:{metas:c}}i=i.parentNode,s+=1}return{metas:null}},Cc=function(n){return n.map(function(r){return delete r.trackingLabel,r})},Ec=function(n){return n.filter(function(r,t){var a=JSON.stringify(r);return t===n.findIndex(function(o){return JSON.stringify(o)===a})})},wc=function(e,n,r){for(var t=[],a="",o=Number.MAX_SAFE_INTEGER,i=0;i<n.length;i+=1){var s=yc(e,n[i],r),c=s.metas,u=s.label,d=s.weight;c&&(u&&d<=o&&(a=u,o=d),t.push.apply(t,R(Cc(c))))}return{decisionsMeta:Ec(t),eventLabel:a}},Ic=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return e.location.href.indexOf("adobe_authoring_enabled")!==-1},bc=1,kn=function(n,r,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",o={_experience:{decisioning:{propositions:r,propositionEventType:B({},t,bc)}}};a&&(o._experience.decisioning.propositionAction={label:a}),n.mergeXdm(o)},Xr=function(n,r){n.mergeQuery({personalization:I({},r)})},Sc=function(e){var n=e.mergeDecisionsMeta,r=e.collectClicks,t=e.getClickSelectors,a=e.getClickMetasBySelector;return function(o){var i=o.event,s=o.clickedElement,c=t();if(D(c)){var u=r(s,c,a),d=u.decisionsMeta,l=u.eventLabel;if(D(d)){var f={eventType:cc},v=d[0].scope;v!==ne&&(f.web={webPageDetails:{viewName:v}}),i.mergeXdm(f),n(i,d,Tn.INTERACT,l)}}}},Rc=function(){var e,n=Ye(),r=function(i){i.then(function(s){e===void 0&&(e={}),N(e,s),n.resolve()}).catch(function(){e===void 0&&(e={}),n.resolve()})},t=function(i){return n.promise.then(function(){return e[i]||[]})},a=function(){return e!==void 0};return{storeViews:r,getView:t,isInitialized:a}},ze=function(e){var n=e.decisions,r=e.renderAttempted;return n.map(function(t){return N({renderAttempted:r},t)})},$e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r={propositions:ze({decisions:e,renderAttempted:n})};return n||(r.decisions=e),r},Dc=function(e){var n=e.mergeDecisionsMeta,r=e.collect,t=e.executeDecisions,a=e.viewCache;return function(o){var i=o.personalizationDetails,s=o.event,c=o.onResponse,u=i.getViewName();return a.getView(u).then(function(d){return i.isRenderDecisions()?t(d).then(function(l){if(D(l)){n(s,l,Tn.DISPLAY),c(function(){return $e(d,!0)});return}c(function(){return r({decisionsMeta:[],viewName:u}),$e(d,!0)})}):(c(function(){return $e(d,!1)}),{})})}},Oc=function(e){return e===ne||Yi(e)},Ac="view",Pc=function(n,r){var t=[],a=[];return n.forEach(function(o){V(r,o.schema)?t.push(o):a.push(o)}),[t,a]},Yr=function(n,r){return{id:n.id,scope:n.scope,items:r,scopeDetails:n.scopeDetails}},Tc=function(n){var r=n.filter(function(a){var o=a.items,i=o===void 0?[]:o;return i.some(function(s){return s.schema===Zi})}),t=n.filter(function(a){return!V(r,a)});return{matchedDecisions:r,unmatchedDecisions:t}},_r=function(n){for(var r=arguments.length,t=new Array(r>1?r-1:0),a=1;a<r;a++)t[a-1]=arguments[a];var o=[],i=[];return n.forEach(function(s){var c=s.items,u=c===void 0?[]:c,d=Pc(u,t),l=_(d,2),f=l[0],v=l[1];D(f)&&o.push(Yr(s,f)),D(v)&&i.push(Yr(s,v))}),{matchedDecisions:o,unmatchedDecisions:i}},kc=function(n,r){n[r.scope]||(n[r.scope]=[]),n[r.scope].push(r)},Nc=function(n){return n.characteristics&&n.characteristics.scopeType&&n.characteristics.scopeType===Ac},Mc=function(n){var r=[],t=[],a={};return D(n)&&n.forEach(function(o){Oc(o.scope)?r.push(o):Nc(o.scopeDetails)?kc(a,o):t.push(o)}),{pageWideScopeDecisions:r,nonPageWideScopeDecisions:t,viewScopeDecisions:a}},xc=function(n){var r=_r(n,Nr),t=Tc(r.unmatchedDecisions),a=_r(t.unmatchedDecisions,En,kr),o=Mc(a.matchedDecisions),i=o.pageWideScopeDecisions,s=o.nonPageWideScopeDecisions,c=o.viewScopeDecisions;return{redirectDecisions:r.matchedDecisions,pageWideScopeDecisions:i,viewDecisions:c,nonAutoRenderableDecisions:[].concat(R(t.matchedDecisions),R(a.unmatchedDecisions),R(s))}},qc="personalization:decisions",Lc=function(e){var n=e.autoRenderingHandler,r=e.nonRenderingHandler,t=e.groupDecisions,a=e.handleRedirectDecisions,o=e.showContainers;return function(i){var s=i.decisionsDeferred,c=i.personalizationDetails,u=i.response,d=u.getPayloadsByType(qc),l=c.getViewName();if(d.length===0)return o(),s.resolve({}),{decisions:[],propositions:[]};var f=t(d),v=f.redirectDecisions,g=f.pageWideScopeDecisions,p=f.viewDecisions,m=f.nonAutoRenderableDecisions;return c.isRenderDecisions()&&D(v)?(s.resolve({}),a(v)):(s.resolve(p),c.isRenderDecisions()?n({viewName:l,pageWideScopeDecisions:g,nonAutoRenderableDecisions:m}):r({viewName:l,redirectDecisions:v,pageWideScopeDecisions:g,nonAutoRenderableDecisions:m}))}},Uc=function(n){return Object.keys(n).map(function(r){return{id:r,scope:n[r].scope,scopeDetails:n[r].scopeDetails,trackingLabel:n[r].trackingLabel}})},Hc=function(){var e={},n=function(o){e[o.selector]||(e[o.selector]={}),e[o.selector][o.meta.id]={scope:o.meta.scope,scopeDetails:o.meta.scopeDetails,trackingLabel:o.meta.trackingLabel}},r=function(){return Object.keys(e)},t=function(o){var i=e[o];return i?Uc(e[o]):{}};return{storeClickMetrics:n,getClickSelectors:r,getClickMetasBySelector:t}},Fc=function(n){var r=n[0],t=r.items,a=r.id,o=r.scope,i=r.scopeDetails,s=t[0].data.content;return{content:s,decisions:[{id:a,scope:o,scopeDetails:i}]}},Bc=function(e){var n=e.collect,r=e.window,t=e.logger,a=e.showContainers;return function(o){var i=Fc(o),s=i.content,c=i.decisions,u=!0;return n({decisionsMeta:c,documentMayUnload:u}).then(function(){r.location.replace(s)}).catch(function(){a(),t.warn(os)})}},Vc=function(n){var r=n.viewCache,t=n.viewName,a=n.pageWideScopeDecisions;return t?r.getView(t).then(function(o){return{pageWideScopeDecisions:a,viewPropositions:o}}):{pageWideScopeDecisions:a,viewPropositions:[]}},jc=function(e){var n=e.viewCache,r=e.executeDecisions,t=e.showContainers,a=e.collect;return function(o){var i=o.viewName,s=o.pageWideScopeDecisions,c=o.nonAutoRenderableDecisions;return Promise.resolve(s).then(function(u){return Vc({viewCache:n,viewName:i,pageWideScopeDecisions:u})}).then(function(u){return r(u.pageWideScopeDecisions).then(function(d){D(d)&&a({decisionsMeta:d})}),i&&r(u.viewPropositions).then(function(d){a({decisionsMeta:d,viewName:i})}),t(),[].concat(R(u.pageWideScopeDecisions),R(u.viewPropositions))}).then(function(u){return{decisions:R(c),propositions:[].concat(R(ze({decisions:u,renderAttempted:!0})),R(ze({decisions:c,renderAttempted:!1})))}})}},Wc=function(n){var r=n.viewCache,t=n.viewName,a=n.propositions;return t?r.getView(t).then(function(o){return[].concat(R(o),R(a))}):a},zc=function(n){var r=n.propositions;return{decisions:r,propositions:ze({decisions:r,renderAttempted:!1})}},$c=function(e){var n=e.viewCache;return function(r){var t=r.viewName,a=r.redirectDecisions,o=r.pageWideScopeDecisions,i=r.nonAutoRenderableDecisions,s=[].concat(R(a),R(o),R(i));return Promise.resolve(s).then(function(c){return Wc({viewCache:n,viewName:t,propositions:c})}).then(function(c){return zc({propositions:c})})}},Gc=[En,wn],Qc=function(e){var n=e.executeDecisions,r=function(c){return Gc.indexOf(c.schema)>-1},t=function(c){var u=c.items,d=c.metadataForScope;return u.filter(r).map(function(l){if(l.schema!==wn)return I({},l);if(x(d))return I(I({},l),{},{data:I(I({},l.data),{},{selector:d.selector,type:d.actionType})})}).filter(function(l){return l})},a=function(c){return!(c.scope===ne&&c.renderAttempted)},o=function(c){var u=c.propositions,d=c.metadata;return u.filter(a).map(function(l){if(D(l.items)){var f=l.id,v=l.scope,g=l.scopeDetails;return{id:f,scope:v,scopeDetails:g,items:t({items:l.items,metadataForScope:d[l.scope]})}}return l}).filter(function(l){return D(l.items)})},i=function(c){var u=c.propositions,d=c.metadata,l=o({propositions:u,metadata:d});return n(l).then(function(){return $e(l,!0)})};return function(s){var c=s.propositions,u=s.metadata,d=u===void 0?{}:u;return D(c)?i({propositions:c,metadata:d}):Promise.resolve(xr)}},Jc=function(e){var n=e.window;return function(){return n.location}},Xc=function(e){var n=e.targetMigrationEnabled;return n?function(r){r.getPayload().mergeMeta({target:{migration:!0}})}:q},Nn=function(n){var r=n.config,t=n.logger,a=n.eventManager,o=r.targetMigrationEnabled,i=r.prehidingStyle,s=uc({eventManager:a,mergeDecisionsMeta:kn}),c=Hc(),u=c.getClickMetasBySelector,d=c.getClickSelectors,l=c.storeClickMetrics,f=Jc({window}),v=Rc(),g=Qs(l),p=pc({modules:g,logger:t,executeActions:ic}),m=Bc({collect:s,window,logger:t,showContainers:Ue}),h=jc({viewCache:v,executeDecisions:p,showContainers:Ue,collect:s}),E=Qc({executeDecisions:p}),w=$c({viewCache:v}),y=Lc({autoRenderingHandler:h,nonRenderingHandler:w,groupDecisions:xc,handleRedirectDecisions:m,showContainers:Ue}),C=mc({prehidingStyle:i,responseHandler:y,hideContainers:Is,mergeQuery:Xr}),k=Sc({mergeDecisionsMeta:kn,collectClicks:wc,getClickSelectors:d,getClickMetasBySelector:u}),b=Dc({mergeDecisionsMeta:kn,collect:s,executeDecisions:p,viewCache:v}),U=Xc({targetMigrationEnabled:o});return is({getPageLocation:f,logger:t,fetchDataHandler:C,viewChangeHandler:b,onClickHandler:k,isAuthoringModeEnabled:Ic,mergeQuery:Xr,viewCache:v,showContainers:Ue,applyPropositions:E,setTargetMigration:U})};Nn.namespace="Personalization",Nn.configValidators={prehidingStyle:A().nonEmpty(),targetMigrationEnabled:W().default(!1)};var Yc=function(e){return function(n){var r={webPageDetails:{URL:e.location.href||e.location},webReferrer:{URL:e.document.referrer}};H(n,{web:r})}},_c=function(n){var r=n.screen.orientation;if(r==null||r.type==null)return null;var t=r.type.split("-");return t.length===0||t[0]!=="portrait"&&t[0]!=="landscape"?null:t[0]},Kc=function(n){if(z(n.matchMedia)){if(n.matchMedia("(orientation: portrait)").matches)return"portrait";if(n.matchMedia("(orientation: landscape)").matches)return"landscape"}return null},Zc=function(e){return function(n){var r=e.screen,t=r.width,a=r.height,o={},i=ie(a);i>=0&&(o.screenHeight=i);var s=ie(t);s>=0&&(o.screenWidth=s);var c=_c(e)||Kc(e);c&&(o.screenOrientation=c),Object.keys(o).length>0&&H(n,{device:o})}},eu=function(e){return function(n){var r=e.document.documentElement;r=r===void 0?{}:r;var t=r.clientWidth,a=r.clientHeight,o={type:"browser"},i=ie(t);i>=0&&(o.browserDetails={viewportWidth:i});var s=ie(a);s>=0&&(o.browserDetails=o.browserDetails||{},o.browserDetails.viewportHeight=s),H(n,{environment:o})}},nu=function(e){return function(n){var r=e(),t={},a=ie(r.getTimezoneOffset());a!==void 0&&(t.localTimezoneOffset=a),(a===void 0||Math.abs(a)<6e3)&&(t.localTime=Io(r)),H(n,{placeContext:t})}},ru=function(e){return function(n){var r=e().toISOString();H(n,{timestamp:r})}},tu="https://ns.adobe.com/experience/alloy",Kr="2.17.0",ou=function(e){var n={name:tu,version:Kr,environment:"browser"};H(e,{implementationDetails:n})},au=function(e,n,r,t){var a=e.context,o=nn(a,function(i,s){return r[i]?[r[i]]:(n.warn("Invalid context["+s+"]: '"+i+"' is not available."),[])}).concat(t);return{namespace:"Context",lifecycle:{onBeforeEvent:function(s){var c=s.event,u={};return Promise.all(o.map(function(d){return Promise.resolve(d(u,n))})).then(function(){return c.mergeXdm(u)})}}}},Zr=[["architecture","string"],["bitness","string"],["model","string"],["platformVersion","string"],["wow64","boolean"]],iu=function(n){return typeof n.userAgentData<"u"},su=function(e){return iu(e)?function(n,r){try{return e.userAgentData.getHighEntropyValues(Zr.map(function(t){return t[0]})).then(function(t){var a={};Zr.forEach(function(o){var i=_(o,2),s=i[0],c=i[1];Object.prototype.hasOwnProperty.call(t,s)&&F(t[s])===c&&(a[s]=t[s])}),H(n,{environment:{browserDetails:{userAgentClientHints:a}}})})}catch(t){return r.warn("Unable to collect user-agent client hints. "+t.message),q}}:q},cu=Yc(window),uu=Zc(window),du=eu(window),lu=nu(function(){return new Date}),fu=ru(function(){return new Date}),vu=su(navigator),et={web:cu,device:uu,environment:du,placeContext:lu},gu={highEntropyUserAgentHints:vu},pu=I(I({},et),gu),mu=[fu,ou],Mn=function(n){var r=n.config,t=n.logger;return au(r,t,pu,mu)};Mn.namespace="Context",Mn.configValidators={context:j(A()).default(Object.keys(et))};var hu=function(e){var n=e.storedConsent,r=e.taskQueue,t=e.defaultConsent,a=e.consent,o=e.sendSetConsentRequest,i=e.validateSetConsentOptions,s=e.consentHashStore,c=e.doesIdentityCookieExist,u=B({},se,t),d=n.read(),l=c(),f=d[se]!==void 0;(!l||!f)&&s.clear(),l||(n.clear(),d={}),a.initializeConsent(u,d);var v=function(){if(r.length===0){var p=n.read();p[se]!==void 0&&a.setConsent(p)}};return{commands:{setConsent:{optionsValidator:i,run:function(p){var m=p.consent,h=p.identityMap,E=p.edgeConfigOverrides;a.suspend();var w=s.lookup(m);return r.addTask(function(){return w.isNew()?o({consentOptions:m,identityMap:h,edgeConfigOverrides:E}):Promise.resolve()}).then(function(){return w.save()}).finally(v)}}},lifecycle:{onResponse:v,onRequestFailure:v}}},yu=function e(n){return Array.isArray(n)?n.map(function(r){return e(r)}):F(n)==="object"&&n!==null?Object.keys(n).sort().reduce(function(r,t){return r[t]=e(n[t]),r},{}):n},Cu=function(e){return Nt(JSON.stringify(yu(e)))},Eu=["standard","version"],xn=function(n){var r=n.standard,t=n.version;return r+"."+t},wu=function(e){var n=e.storage;return{clear:function(){n.clear()},lookup:function(t){var a={},o=function(s){var c=xn(s);s.standard,s.version;var u=Xn(s,Eu);return a[c]||(a[c]=Cu(u).toString()),a[c]};return{isNew:function(){return t.some(function(s){var c=xn(s),u=n.getItem(c);return u===null||u!==o(s)})},save:function(){t.forEach(function(s){var c=xn(s);n.setItem(c,o(s))})}}}}},Iu=function(){var e={},n=pn({content:e,addIdentity:function(t,a){e.identityMap=e.identityMap||{},e.identityMap[t]=e.identityMap[t]||[],e.identityMap[t].push(a)},hasIdentity:function(t){return(e.identityMap&&e.identityMap[t])!==void 0}});return n.setConsent=function(r){e.consent=r},n},bu=function(e){return gn({payload:e,getAction:function(){return"privacy/set-consent"},getUseSendBeacon:function(){return!1}})},Su=function(e){var n=e.parseConsentCookie,r=e.orgId,t=e.cookieJar,a=tn(r,lo);return{read:function(){var i=t.get(a);return i?n(i):{}},clear:function(){t.remove(a)}}},Ru=function(e){var n=e.createConsentRequestPayload,r=e.createConsentRequest,t=e.sendEdgeNetworkRequest,a=e.edgeConfigOverrides;return function(o){var i=o.consentOptions,s=o.identityMap,c=o.edgeConfigOverrides,u=n();u.setConsent(i),u.mergeConfigOverride(a),u.mergeConfigOverride(c),x(s)&&Object.keys(s).forEach(function(l){s[l].forEach(function(f){u.addIdentity(l,f)})});var d=r(u);return t({request:d}).then(function(){})}},Du=function(e){var n=e.split(";");return n.reduce(function(r,t){var a=t.split("="),o=_(a,2),i=o[0],s=o[1];return r[i]=s,r},{})},Ou=T({consent:j(Ne()).required().nonEmpty(),identityMap:mr,edgeConfigOverrides:ge}).noUnknownFields().required(),nt=function(n){var r=n.config,t=n.consent,a=n.sendEdgeNetworkRequest,o=n.createNamespacedStorage,i=r.orgId,s=r.defaultConsent,c=Su({parseConsentCookie:Du,orgId:i,cookieJar:Y}),u=kt(),d=Ru({createConsentRequestPayload:Iu,createConsentRequest:bu,sendEdgeNetworkRequest:a,edgeConfigOverrides:r.edgeConfigOverrides}),l=o(rn(i)+".consentHashes."),f=wu({storage:l.persistent}),v=rr({orgId:i});return hu({storedConsent:c,taskQueue:u,defaultConsent:s,consent:t,sendSetConsentRequest:d,validateSetConsentOptions:Ou,consentHashStore:f,doesIdentityCookieExist:v})};nt.namespace="Privacy";var Au=function(){return{eventMergeId:on()}},Pu=function(e){var n=e.createEventMergeId;return{commands:{createEventMergeId:{run:n}}}},qn=function(){return Pu({createEventMergeId:Au})};qn.namespace="EventMerge",qn.configValidators={};var Tu=function(n){var r=n.config,t=n.componentRegistry,a=[].concat(R(t.getCommandNames()),[ln,fn]).sort(),o=I({},r);return Object.keys(r).forEach(function(i){var s=r[i];typeof s=="function"&&(o[i]=s.toString())}),{version:Kr,configs:o,commands:a}},rt=function(n){var r=n.config,t=n.componentRegistry,a=Tu({config:r,componentRegistry:t});return{commands:{getLibraryInfo:{run:function(){return{libraryInfo:a}}}}}};rt.namespace="LibraryInfo";var ku=function(e){var n=e.response;return{inferences:n.getPayloadsByType("rtml:inferences")}},Ln=function(){return{lifecycle:{onResponse:ku},commands:{}}};Ln.namespace="MachineLearning",Ln.configValidators={};var tt=[vn,xe,mn,hn,Nn,Mn,nt,qn,rt,Ln],Nu="https://adobe.ly/3sHh553",Mu=function(n,r){var t={};return N(t,n),r.forEach(function(a){var o=a.configValidators;N(t,o)}),t},xu=function(n,r){try{var t=T(n).noUnknownFields().required();return t(r)}catch(a){throw new Error(`Resolve these configuration problems:
	 - `+a.message.split(`
`).join(`
	 - `)+`
For configuration documentation see: `+Nu)}},qu=function(n,r,t){return t.reduce(function(a,o){var i=o.buildOnInstanceConfiguredExtraParams;return i&&N(a,i({config:n,logger:r})),a},{})},Lu=function(e){var n=e.options,r=e.componentCreators,t=e.coreConfigValidators,a=e.createConfig,o=e.logger,i=e.setDebugEnabled,s=Mu(t,r),c=a(xu(s,n));i(c.debugEnabled,{fromConfig:!0});var u=qu(c,o,r);return o.logOnInstanceConfigured(I(I({},u),{},{config:c})),c},Uu=function(e){var n=e.componentCreators,r=e.lifecycle,t=e.componentRegistry,a=e.getImmediatelyAvailableTools;return n.forEach(function(o){var i=o.namespace,s=a(i),c;try{c=o(s)}catch(u){throw Pe({error:u,message:"["+i+"] An error occurred during component creation."})}t.register(i,c)}),r.onComponentsRegistered({lifecycle:r}).then(function(){return t})},Hu=function(n){return N({},n)},Fu="edge.adobedc.net",Bu="adobedc.demdex.net",Vu="ee",ju=function(){return{debugEnabled:W().default(!1),defaultConsent:pr(sn,Cr,Er).default(sn),edgeConfigId:A().unique().required(),edgeDomain:A().domain().default(Fu),edgeBasePath:A().nonEmpty().default(Vu),orgId:A().unique().required(),onBeforeEventSend:fr().default(q),edgeConfigOverrides:ge}},ot=function(e){var n=e.errorPrefix,r=e.logger;return function(t,a){var o=ir(t);if(o.code===wr)return r.warn("The "+a+" could not fully complete. "+o.message),{};throw sr({error:o,message:n+" "+o.message}),o}},Wu=function(e){var n=e.fetch;return function(r,t){return n(r,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},referrerPolicy:"no-referrer-when-downgrade",body:t}).then(function(a){return a.text().then(function(o){return{statusCode:a.status,getHeader:function(s){return a.headers.get(s)},body:o}})})}},zu=function(e){var n=e.XMLHttpRequest;return function(r,t){return new Promise(function(a,o){var i=new n;i.onreadystatechange=function(){i.readyState===4&&(i.status===0?o(new Error("Request aborted.")):a({statusCode:i.status,getHeader:function(c){return i.getResponseHeader(c)},body:i.responseText}))},i.onloadstart=function(){i.responseType="text"},i.open("POST",r,!0),i.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),i.withCredentials=!0,i.onerror=o,i.onabort=o,i.send(t)})}},$u=function(e){var n=e.sendBeacon,r=e.sendFetchRequest,t=e.logger;return function(a,o){var i=new Blob([o],{type:"text/plain; charset=UTF-8"});return n(a,i)?Promise.resolve({statusCode:204,getHeader:function(){return null},body:""}):(t.info("Unable to use `sendBeacon`; falling back to `fetch`."),r(a,o))}},Gu=function(e){var n=e.getDebugEnabled,r=e.console,t=e.getMonitors,a=e.context,o="["+a.instanceName+"]";a.componentName&&(o+=" ["+a.componentName+"]");var i=function(u,d){var l=t();if(l.length>0){var f=N({},a,d);l.forEach(function(v){v[u]&&v[u](f)})}},s=function(u){for(var d=arguments.length,l=new Array(d>1?d-1:0),f=1;f<d;f++)l[f-1]=arguments[f];i("onBeforeLog",{level:u,arguments:l}),n()&&r[u].apply(r,[o].concat(l))};return{get enabled(){return t().length>0||n()},logOnInstanceCreated:function(u){i("onInstanceCreated",u),s("info","Instance initialized.")},logOnInstanceConfigured:function(u){i("onInstanceConfigured",u),s("info","Instance configured. Computed configuration:",u.config)},logOnBeforeCommand:function(u){i("onBeforeCommand",u),s("info","Executing "+u.commandName+" command. Options:",u.options)},logOnCommandResolved:function(u){i("onCommandResolved",u),s("info",u.commandName+" command resolved. Result:",u.result)},logOnCommandRejected:function(u){i("onCommandRejected",u),s("error",u.commandName+" command was rejected. Error:",u.error)},logOnBeforeNetworkRequest:function(u){i("onBeforeNetworkRequest",u),s("info","Request "+u.requestId+": Sending request.",u.payload)},logOnNetworkResponse:function(u){i("onNetworkResponse",u);var d=u.parsedBody||u.body?"response body:":"no response body.";s("info","Request "+u.requestId+": Received response with status code "+u.statusCode+" and "+d,u.parsedBody||u.body)},logOnNetworkError:function(u){i("onNetworkError",u),s("error","Request "+u.requestId+": Network request failed.",u.error)},info:s.bind(null,"info"),warn:s.bind(null,"warn"),error:s.bind(null,"error")}},at="Event was canceled because the onBeforeEventSend callback returned false.",Qu=function(e){var n=e.config,r=e.logger,t=e.lifecycle,a=e.consent,o=e.createEvent,i=e.createDataCollectionRequestPayload,s=e.createDataCollectionRequest,c=e.sendEdgeNetworkRequest,u=e.applyResponse,d=n.onBeforeEventSend,l=n.edgeConfigOverrides;return{createEvent:o,sendEvent:function(v){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=g.renderDecisions,m=p===void 0?!1:p,h=g.decisionScopes,E=g.edgeConfigOverrides,w=g.personalization,y=i(),C=s(y),k=K(),b=K();return y.mergeConfigOverride(l),y.mergeConfigOverride(E),t.onBeforeEvent({event:v,renderDecisions:m,decisionScopes:h,personalization:w,onResponse:k.add,onRequestFailure:b.add}).then(function(){return y.addEvent(v),a.awaitConsent()}).then(function(){try{v.finalize(d)}catch(Qe){var U=function(){throw Qe};return b.add(t.onRequestFailure),b.call({error:Qe}).then(U,U)}if(!v.shouldSend()){b.add(t.onRequestFailure),r.info(at);var X=new Error(at);return b.call({error:X}).then(function(){})}return c({request:C,runOnResponseCallbacks:k.call,runOnRequestFailureCallbacks:b.call})})},applyResponse:function(v){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=g.renderDecisions,m=p===void 0?!1:p,h=g.responseHeaders,E=h===void 0?{}:h,w=g.responseBody,y=w===void 0?{handle:[]}:w,C=i(),k=s(C),b=K();return t.onBeforeEvent({event:v,renderDecisions:m,decisionScopes:[ne],personalization:{},onResponse:b.add,onRequestFailure:q}).then(function(){return C.addEvent(v),u({request:k,responseHeaders:E,responseBody:y,runOnResponseCallbacks:b.call})})}}},Ju="state:store",Xu=function(e){var n=e.cookieJar,r=e.shouldTransferCookie,t=e.apexDomain,a=e.dateProvider;return{cookiesToPayload:function(i,s){var c=Mt(s,t),u={domain:t,cookiesEnabled:!0};if(!c){var d=n.get(),l=Object.keys(d).filter(r).map(function(f){return{key:f,value:d[f]}});l.length&&(u.entries=l)}i.mergeState(u)},responseToCookies:function(i){i.getPayloadsByType(Ju).forEach(function(s){var c={domain:t},u=s.attrs&&s.attrs.SameSite&&s.attrs.SameSite.toLowerCase();s.maxAge!==void 0&&(c.expires=new Date(a().getTime()+s.maxAge*1e3)),u!==void 0&&(c.sameSite=u),u==="none"&&(c.secure=!0),n.set(s.key,s.value,c)})}}},Yu="mboxEdgeCluster",_u="at_qa_mode",Ku="mbox",Zu=function(e){var n=e.orgId,r=e.targetMigrationEnabled;return function(t){return po(n,t)||t===_u||r&&t===Ku}},ed="v1",it=function(e){var n=e.shift()||[],r=e.shift()||[],t=e;return N.apply(void 0,[{}].concat(R(n),R(r),R(t)))},st=function(e){return function(n){var r=function(){throw n};return e.call({error:n}).then(r,r)}},nd=function(e){var n=e.config,r=e.lifecycle,t=e.cookieTransfer,a=e.sendNetworkRequest,o=e.createResponse,i=e.processWarningsAndErrors,s=e.getLocationHint,c=e.getAssuranceValidationTokenParams,u=n.edgeDomain,d=n.edgeBasePath,l=n.edgeConfigId;return function(f){var v=f.request,g=f.runOnResponseCallbacks,p=g===void 0?q:g,m=f.runOnRequestFailureCallbacks,h=m===void 0?q:m,E=K();E.add(r.onResponse),E.add(p);var w=K();return w.add(r.onRequestFailure),w.add(h),r.onBeforeRequest({request:v,onResponse:E.add,onRequestFailure:w.add}).then(function(){var y=v.getUseIdThirdPartyDomain()?Bu:u,C=s(),k=C?d+"/"+C:d,b="https://"+y+"/"+k+"/"+ed+"/"+v.getAction()+"?configId="+l+"&requestId="+v.getId()+c();return t.cookiesToPayload(v.getPayload(),y),a({requestId:v.getId(),url:b,payload:v.getPayload(),useSendBeacon:v.getUseSendBeacon()})}).then(function(y){return i(y),y}).catch(st(w)).then(function(y){var C=y.parsedBody,k=y.getHeader,b=o({content:C,getHeader:k});return t.responseToCookies(b),E.call({response:b}).then(it)})}},rd=204,td=429,od=502,ad=503,id=504,Un="The server responded with a",sd=function(e){var n=e.logger;return function(r){var t=r.statusCode,a=r.body,o=r.parsedBody;if(t<200||t>=300||!o&&t!==rd||o&&!Array.isArray(o.handle)){var i=o?JSON.stringify(o,null,2):a,s=i?`response body:
`+i:"no response body.";throw new Error(Un+" status code "+t+" and "+s)}if(o){var c=o.warnings,u=c===void 0?[]:c,d=o.errors,l=d===void 0?[]:d;u.forEach(function(f){n.warn(Un+" warning:",f)}),l.forEach(function(f){n.error(Un+" non-fatal error:",f)})}}},cd=function(e){var n=e.orgId,r=e.cookieJar,t=tn(n,fo),a=function(){return r.get(t)},o=function(){var s=r.get(Yu);if(s)return"t"+s};return function(){return a()||o()}},ud=3,dd=[td,ad,od,id],ld=function(e){var n=e.response,r=e.retriesAttempted;return r<ud&&V(dd,n.statusCode)},fd=1e3,vd=1e3,gd=.3,pd=function(n){var r=fd+n*vd,t=r*gd,a=r-t,o=r+t,i=Math.round(a+Math.random()*(o-a));return i},md=function(n){var r=n.getHeader(Da),t;if(r){var a=parseInt(r,10);ar(a)?t=a*1e3:t=Math.max(0,new Date(r).getTime()-new Date().getTime())}return t},hd=function(e){var n=e.response,r=e.retriesAttempted,t=md(n);return t===void 0&&(t=pd(r)),t},yd=200,Cd=function(e){var n=e.cookieTransfer,r=e.lifecycle,t=e.createResponse,a=e.processWarningsAndErrors;return function(o){var i=o.request,s=o.responseHeaders,c=o.responseBody,u=o.runOnResponseCallbacks,d=u===void 0?q:u,l=o.runOnRequestFailureCallbacks,f=l===void 0?q:l,v=K();v.add(r.onResponse),v.add(d);var g=K();g.add(r.onRequestFailure),g.add(f);var p=function(h){return s[h]};return r.onBeforeRequest({request:i,onResponse:v.add,onRequestFailure:g.add}).then(function(){return a({statusCode:yd,getHeader:p,body:JSON.stringify(c),parsedBody:c})}).catch(st(g)).then(function(){var m=t({content:c,getHeader:p});return n.responseToCookies(m),v.call({response:m}).then(it)})}},Hn=vo(window),Ge=window,Ed=Ge.console,ct=Ge.fetch,Fn=Ge.navigator,wd=Ge.XMLHttpRequest,Id=function(){return window.__alloyMonitors||[]},bd=ju(),ut=co(window,Y),Bn=z(ct)?Wu({fetch:ct}):zu({XMLHttpRequest:wd}),Sd=ao(),Rd=Pi({window,createNamespacedStorage:Hn}),Dd=function(n){var r=n.instanceName,t=n.logController,a=t.setDebugEnabled,o=t.logger,i=t.createComponentLogger,s=Ea(),c=Ca(s),u=function(p){a(p.enabled,{fromConfig:!1})},d=Xe({logger:o,cookieJar:Y}),l=function(p){var m=Lu({options:p,componentCreators:tt,coreConfigValidators:bd,createConfig:Hu,logger:o,setDebugEnabled:a}),h=m.orgId,E=m.targetMigrationEnabled,w=Zu({orgId:h,targetMigrationEnabled:E}),y=Xu({cookieJar:d,shouldTransferCookie:w,apexDomain:ut,dateProvider:function(){return new Date}}),C=z(Fn.sendBeacon)?$u({sendBeacon:Fn.sendBeacon.bind(Fn),sendFetchRequest:Bn,logger:o}):Bn,k=wa({logger:o,sendFetchRequest:Bn,sendBeaconRequest:C,isRequestRetryable:ld,getRequestRetryDelay:hd}),b=sd({logger:o}),U=Ia({logger:o}),X=Aa({extractEdgeInfo:U}),Qe=cd({orgId:h,cookieJar:Y}),Vn=nd({config:m,lifecycle:c,cookieTransfer:y,sendNetworkRequest:k,createResponse:X,processWarningsAndErrors:b,getLocationHint:Qe,getAssuranceValidationTokenParams:Rd}),Ad=Cd({lifecycle:c,cookieTransfer:y,createResponse:X,processWarningsAndErrors:b}),Pd=ba({logger:o}),dt=Sa({generalConsentState:Pd,logger:o}),Td=Qu({config:m,logger:o,lifecycle:c,consent:dt,createEvent:Ra,createDataCollectionRequestPayload:Ri,createDataCollectionRequest:Si,sendEdgeNetworkRequest:Vn,applyResponse:Ad});return Uu({componentCreators:tt,lifecycle:c,componentRegistry:s,getImmediatelyAvailableTools:function(lt){var ft=i(lt);return{config:m,componentRegistry:s,consent:dt,eventManager:Td,fireReferrerHideableImage:Sd,logger:ft,lifecycle:c,sendEdgeNetworkRequest:Vn,handleError:ot({errorPrefix:"["+r+"] ["+lt+"]",logger:ft}),createNamespacedStorage:Hn,apexDomain:ut}}})},f=ot({errorPrefix:"["+r+"]",logger:o}),v=Pa({logger:o,configureCommand:l,setDebugCommand:u,handleError:f,validateCommandOptions:ka});return v},Od=function(){var e=window.__alloyNS;e&&e.forEach(function(n){var r=pa({console:Ed,locationSearch:window.location.search,createLogger:Gu,instanceName:n,createNamespacedStorage:Hn,getMonitors:Id}),t=Dd({instanceName:n,logController:r}),a=vt(t),o=window[n].q;o.push=a,r.logger.logOnInstanceCreated({instance:a}),o.forEach(a)})};Od()})();
//# sourceMappingURL=alloy.js.map
