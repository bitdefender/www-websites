{"version":3,"mappings":"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","names":["LCP_BLOCKS","SUPPORTED_LANGUAGES","mobileDetectorDiv","name","meta","getLanguageCountryFromPath","currentPathUrl","getLocalizedResourceUrl","resourceName","pathname","lpIsInFolder","pathnameAsArray","basePathIndex","main","picture","next","a","link","overlayPlayButton","event","createModal","modalContainer","up","pictureParent","decorateMain","decorateButtons","decorateLinkedPictures","decorateSections","decorateBlocks","stopAutomaticRefresh","modalContent","path","html","resp","template","closeModal","close","e","stopAutomaticModalRefresh","modalClass","existingModal","element","populateColumns","section","rightColContainer","leftColContainer","el","populateHero","buildTwoColumnsSection","fullWidthContainer","createTag","buildCtaSections","buildCta","loadTrackers","onAdobeMcLoaded","target","loadEager","getPageExperimentKey","resolveNonProductsDataLayer","createMetadata","decorateTemplateAndTheme","templateMetadata","getMetadata","loadCSS","doc","detectModalButtons","loadLazy","pageIsNotInFragmentsFolder","pageIsNotInWebviewFolder","loadHeader","hash","loadFooter","sampleRUM","eventOnDropdownSlider","slider","titles","activeIndex","interval","index","loadingBar","loadingBars","width","moveToNextItem","title","showLoadingBar","startAutomaticMovement","stopAutomaticMovement","loadDelayed","loadPage","StoreResolver","elements","adobeMcAppendVisitorId","AdobeDataLayerService","initMobileDetector"],"ignoreList":[],"sources":["../../src/scripts/scripts.js"],"sourcesContent":["import Launch from '@repobit/dex-launch';\nimport { PageLoadedEvent, AdobeDataLayerService } from '@repobit/dex-data-layer';\nimport { target, adobeMcAppendVisitorId } from './target.js';\nimport page from './page.js';\nimport {\n  sampleRUM,\n  loadHeader,\n  loadFooter,\n  decorateButtons,\n  decorateIcons,\n  decorateTags,\n  decorateSections,\n  decorateBlocks,\n  decorateTemplateAndTheme,\n  waitForLCP,\n  loadBlocks,\n  loadCSS,\n  getMetadata,\n} from './lib-franklin.js';\nimport {\n  resolveNonProductsDataLayer,\n} from './libs/data-layer.js';\nimport { StoreResolver } from './libs/store/index.js';\n\nimport {\n  createTag,\n  getPageExperimentKey,\n  GLOBAL_EVENTS,\n  pushTrialDownloadToDataLayer,\n  generateLDJsonSchema,\n} from './utils/utils.js';\nimport { Constants } from './libs/constants.js';\n\nconst LCP_BLOCKS = ['hero', 'password-generator']; // add your LCP blocks to the list\n\nexport const SUPPORTED_LANGUAGES = ['en'];\n\nwindow.hlx.plugins.add('rum-conversion', {\n  load: 'lazy',\n  url: '../plugins/rum-conversion/src/index.js',\n});\n\nwindow.hlx.plugins.add('experimentation', {\n  condition: () => getMetadata('experiment'),\n  options: {\n    prodHost: 'www.bitdefender.com',\n  },\n  url: '../plugins/experimentation/src/index.js',\n});\n\nwindow.ADOBE_MC_EVENT_LOADED = false;\n\nfunction initMobileDetector(viewport) {\n  const mobileDetectorDiv = document.createElement('div');\n  mobileDetectorDiv.setAttribute(`data-${viewport}-detector`, '');\n  document.body.append(mobileDetectorDiv);\n}\n\n/**\n * Creates a meta tag with the given name and value and appends it to the head.\n * @param {String} name The name of the meta tag\n * @param {String} value The value of the meta tag\n */\nexport function createMetadata(name, value) {\n  const meta = document.createElement('meta');\n  meta.setAttribute('name', name);\n  meta.setAttribute('content', value);\n  document.head.append(meta);\n}\n\nexport function getLanguageCountryFromPath() {\n  const currentPathUrl = window.location.pathname;\n  return {\n    language: currentPathUrl.split('/')[1].split('-')[0],\n    country: currentPathUrl.split('/')[1].split('-')[1],\n  };\n}\n\nexport function getLocalizedResourceUrl(resourceName) {\n  const { pathname } = window.location;\n  const lastCharFromUrl = pathname.charAt(pathname.length - 1);\n  const lpIsInFolder = lastCharFromUrl === '/';\n\n  let pathnameAsArray = pathname.split('/');\n\n  if (lpIsInFolder) {\n    return `${pathnameAsArray.join('/')}${resourceName}`;\n  }\n\n  const basePathIndex = pathname.startsWith('/pages/') ? 3 : 2;\n  pathnameAsArray = pathnameAsArray.slice(0, basePathIndex + 1); // \"/consumer/en\";\n\n  return `${pathnameAsArray.join('/')}/${resourceName}`;\n}\n\n/**\n * Decorates picture elements with a link to a video.\n * @param {Element} main The main element\n */\nexport default function decorateLinkedPictures(main) {\n  main.querySelectorAll('picture').forEach((picture) => {\n    // this condition checks if the picture is part of some content block ( rte )\n    // and not a direct element in some DIV block\n    // that could have different behaviour for some blocks (ex: columns )\n    if (!picture.closest('div.block') && picture.parentElement.tagName !== 'DIV') {\n      const next = picture.parentNode.nextElementSibling;\n      if (next) {\n        const a = next.querySelector('a');\n        const link = a?.textContent;\n        /* Modal video */\n        if (a && link.startsWith('https://') && link.includes('fragments')) {\n          a.innerHTML = '';\n          a.className = 'video-placeholder';\n          a.appendChild(picture);\n          const overlayPlayButton = document.createElement('span');\n          overlayPlayButton.className = 'video-placeholder-play';\n          a.appendChild(overlayPlayButton);\n          a.addEventListener('click', async (event) => {\n            event.preventDefault();\n            // eslint-disable-next-line no-use-before-define\n            const modalContainer = await createModal(link, 'video-modal');\n            document.body.append(modalContainer);\n          });\n          const up = a.parentElement;\n          if (up.childNodes.length === 1 && (up.tagName === 'P' || up.tagName === 'DIV')) {\n            up.classList.add('modal-video-container');\n          }\n          return;\n        }\n        // Basic linked image\n        if (a && link.startsWith('https://')) {\n          a.innerHTML = '';\n          a.className = 'linked-image';\n          const pictureParent = picture.parentNode;\n          a.append(picture);\n          if (pictureParent.children.length === 0) {\n            pictureParent.parentNode.removeChild(pictureParent);\n          }\n          const up = a.parentElement;\n          if (up.childNodes.length === 1 && (up.tagName === 'P' || up.tagName === 'DIV')) {\n            up.classList.add('linked-image-container');\n          }\n        }\n      }\n    }\n  });\n}\n\n/**\n * Decorates the main element.\n * @param {Element} main The main element\n */\n// eslint-disable-next-line import/prefer-default-export\nexport function decorateMain(main) {\n  // hopefully forward compatible button decoration\n  decorateButtons(main);\n  decorateIcons(main);\n  decorateTags(main);\n  decorateLinkedPictures(main);\n  decorateSections(main);\n  decorateBlocks(main);\n}\n\n/**\n *\n * @param {String} path The path to the modal\n * @param {String} template The template to use for the modal styling\n * @param {Boolean} stopAutomaticRefresh Wether the modal refreshes after exiting or not\n * @returns {Promise<Element>}\n * @example\n */\nexport async function createModal(path, template, stopAutomaticRefresh) {\n  const modalContainer = document.createElement('div');\n  modalContainer.classList.add('modal-container');\n\n  // add the class which makes the modal identifiable in the page\n  if (stopAutomaticRefresh) {\n    const modalClass = path.split('/').pop();\n    modalContainer.classList.add(modalClass);\n  }\n\n  const modalContent = document.createElement('div');\n  modalContent.classList.add('modal-content');\n\n  // fetch modal content\n  const resp = await fetch(`${path}.plain.html`);\n\n  if (!resp.ok) {\n    // eslint-disable-next-line no-console\n    console.error(`modal url cannot be loaded: ${path}`);\n    return modalContainer;\n  }\n\n  const html = await resp.text();\n  modalContent.innerHTML = html;\n\n  decorateMain(modalContent);\n  await loadBlocks(modalContent);\n  modalContainer.append(modalContent);\n\n  // add class to modal container for opportunity to add custom modal styling\n  if (template) modalContainer.classList.add(template);\n\n  const closeModal = () => {\n    // if the modal is still supposed to exist just hide it\n    if (stopAutomaticRefresh) {\n      modalContainer.classList.add('global-display-none');\n      return;\n    }\n\n    // if it's supposed to refresh delete it so that it can be rerendered\n    modalContainer.remove();\n  };\n\n  const close = document.createElement('div');\n  close.classList.add('modal-close');\n  close.addEventListener('click', closeModal);\n  modalContent.append(close);\n  return modalContainer;\n}\n\nexport async function detectModalButtons(main) {\n  main.querySelectorAll('a.button.modal').forEach((link) => {\n    link.addEventListener('click', async (e) => {\n      e.preventDefault();\n      const stopAutomaticModalRefresh = link.dataset.stopAutomaticModalRefresh === 'true';\n\n      // if we wish for the button to not generate a new modal everytime\n      if (stopAutomaticModalRefresh) {\n        // we use the last part of the link to identify the modals\n        const modalClass = link.href.split('/').pop();\n\n        // check if the modal exists in the page\n        const existingModal = document.querySelector(`div.modal-container.${modalClass}`);\n        if (existingModal) {\n          // if it exists just display it\n          existingModal.classList.remove('global-display-none');\n          return;\n        }\n      }\n\n      // generate new modal\n      const modalContainer = await createModal(link.href, undefined, stopAutomaticModalRefresh);\n      document.body.append(modalContainer);\n      await StoreResolver.resolve(modalContainer);\n      modalContainer.querySelectorAll('.await-loader').forEach((element) => {\n        element.classList.remove('await-loader');\n      });\n    });\n  });\n}\n\nfunction populateColumns(section) {\n  if (section.querySelectorAll('.columns div div').length === 2) {\n    const rightColContainer = section.querySelector('.columns div div:last-child');\n    rightColContainer.classList.add('right-col');\n    section.querySelector('.columns div div:last-child').classList.add('right-col');\n    const leftColContainer = section.querySelector('.columns div div:first-child');\n    leftColContainer.classList.add('left-col');\n\n    section.querySelectorAll('.right-column').forEach((el) => rightColContainer.append(el));\n    section.querySelectorAll('.left-column').forEach((el) => leftColContainer.append(el));\n  }\n}\n\nfunction populateHero(section) {\n  if (section.querySelectorAll('.hero div div').length === 2) {\n    const rightColContainer = section.querySelector('.hero div div:last-child');\n    rightColContainer.classList.add('right-col');\n    section.querySelector('.hero div div:last-child').classList.add('right-col');\n    const leftColContainer = section.querySelector('.hero div div:first-child');\n    leftColContainer.classList.add('left-col');\n\n    section.querySelectorAll('.right-column').forEach((el) => rightColContainer.append(el));\n    section.querySelectorAll('.left-column').forEach((el) => leftColContainer.append(el));\n  }\n}\n\nfunction buildTwoColumnsSection(main) {\n  main.querySelectorAll('div.section.two-columns').forEach((section) => {\n    populateHero(section);\n    populateColumns(section);\n  });\n}\n\nfunction buildCta(section) {\n  populateColumns(section);\n  const fullWidthContainer = createTag(\n    'div',\n    { class: 'full-width' },\n    '',\n  );\n  [...section.children].forEach((el) => fullWidthContainer.append(el));\n  section.append(fullWidthContainer);\n}\n\nfunction buildCtaSections(main) {\n  main.querySelectorAll('div.section.cta, div.section.footer-cta')\n    .forEach(buildCta);\n}\n\nexport async function loadTrackers() {\n  const isPageNotInDraftsFolder = window.location.pathname.indexOf('/drafts/') === -1;\n\n  const onAdobeMcLoaded = () => {\n    document.dispatchEvent(new Event(GLOBAL_EVENTS.ADOBE_MC_LOADED));\n    window.ADOBE_MC_EVENT_LOADED = true;\n  };\n\n  if (isPageNotInDraftsFolder) {\n    try {\n      await Launch.load(page.environment);\n      onAdobeMcLoaded();\n    } catch {\n      target.abort();\n    }\n  } else {\n    target.abort();\n    onAdobeMcLoaded();\n  }\n}\n\n/**\n * Loads everything needed to get to LCP.\n * @param {Element} doc The container element\n */\nasync function loadEager(doc) {\n  // load trackers early if there is a target experiment on the page\n  if (getPageExperimentKey()) {\n    loadTrackers();\n    await resolveNonProductsDataLayer();\n  }\n\n  createMetadata('nav', `${getLocalizedResourceUrl('nav')}`);\n  createMetadata('footer', `${getLocalizedResourceUrl('footer')}`);\n  decorateTemplateAndTheme();\n\n  const templateMetadata = getMetadata('template');\n  const hasTemplate = getMetadata('template') !== '';\n  if (hasTemplate) {\n    loadCSS(`${window.hlx.codeBasePath}/scripts/template-factories/${templateMetadata}.css`);\n  }\n  const main = doc.querySelector('main');\n  if (main) {\n    decorateMain(main);\n    buildCtaSections(main);\n    buildTwoColumnsSection(main);\n    detectModalButtons(main);\n    document.body.classList.add('appear', 'franklin');\n    if (window.location.href.indexOf('scuderiaferrari') !== -1) {\n      document.body.classList.add('sferrari');\n    }\n    await waitForLCP(LCP_BLOCKS);\n  }\n}\n\n/**\n * Loads everything that doesn't need to be delayed.\n * @param {Element} doc The container element\n */\nasync function loadLazy(doc) {\n  const main = doc.querySelector('main');\n\n  const pageIsNotInFragmentsFolder = window.location.pathname.indexOf('/fragments/') === -1;\n  const pageIsNotInWebviewFolder = window.location.pathname.indexOf('/webview/') === -1;\n  doc.querySelector('header').style.height = '0px';\n\n  if (pageIsNotInFragmentsFolder && pageIsNotInWebviewFolder) {\n    // eslint-disable-next-line no-unused-vars\n    doc.querySelector('header').style.height = 'initial';\n    loadHeader(doc.querySelector('header'));\n  }\n\n  // only call load Trackers here if there is no experiment on the page\n  if (!getPageExperimentKey()) {\n    loadTrackers();\n    await resolveNonProductsDataLayer();\n  }\n\n  // push basic events to dataLayer\n  await loadBlocks(main);\n\n  const { hash } = window.location;\n  const element = hash ? doc.getElementById(hash.substring(1)) : false;\n  if (hash && element) element.scrollIntoView();\n\n  if (pageIsNotInFragmentsFolder && pageIsNotInWebviewFolder) {\n    loadFooter(doc.querySelector('footer'));\n  }\n\n  generateLDJsonSchema();\n\n  loadCSS(`${window.hlx.codeBasePath}/styles/lazy-styles.css`);\n\n  window.hlx.plugins.run('loadLazy');\n\n  const templateMetadata = getMetadata('template');\n  const hasTemplate = getMetadata('template') !== '';\n  if (hasTemplate) {\n    loadCSS(`${window.hlx.codeBasePath}/scripts/template-factories/${templateMetadata}-lazy.css`)\n      .catch(() => {});\n  }\n\n  sampleRUM('lazy');\n  sampleRUM.observe(main.querySelectorAll('div[data-block-name]'));\n  sampleRUM.observe(main.querySelectorAll('picture > img'));\n}\n\n/**\n * Event listener for dropdown slider dropdown-box.js component.\n * This is imported from www-landing-pages repo.\n * @returns {void}\n* */\nfunction eventOnDropdownSlider() {\n  document.querySelectorAll('.dropdown-slider').forEach((slider) => {\n    const titles = slider.querySelectorAll('.title');\n    const loadingBars = slider.querySelectorAll('.loading-bar');\n    let activeIndex = 0;\n    let interval;\n\n    function showLoadingBar(index) {\n      const loadingBar = loadingBars[index];\n      loadingBar.style.width = '0';\n      let width = 0;\n      const interval2 = setInterval(() => {\n        width += 1;\n        loadingBar.style.width = `${width}%`;\n        if (width >= 100) {\n          clearInterval(interval2);\n        }\n      }, 30); // Adjust the interval for smoother animation\n    }\n\n    function moveToNextItem() {\n      titles.forEach((title, index) => {\n        if (index === activeIndex) {\n          title.parentNode.classList.add('active');\n          title.closest('.dropdown-slider').setAttribute('style', `min-height: ${title.parentNode.querySelector('.description').offsetHeight + 50}px`);\n          if (loadingBars.length) {\n            showLoadingBar(index);\n          }\n        } else {\n          title.parentNode.classList.remove('active');\n        }\n      });\n\n      activeIndex = (activeIndex + 1) % titles.length; // Move to the next item and handle wrapping\n    }\n\n    function startAutomaticMovement() {\n      interval = setInterval(moveToNextItem, 4000); // Set the interval\n    }\n\n    function stopAutomaticMovement() {\n      clearInterval(interval); // Clear the interval\n    }\n\n    // Set the initial active item\n    moveToNextItem();\n\n    if (loadingBars.length) {\n      // Start automatic movement after the loading is complete\n      setTimeout(() => {\n        startAutomaticMovement();\n      }, 1000);\n\n      // Click event listener on titles\n      titles.forEach((title, index) => {\n        title.addEventListener('click', () => {\n          stopAutomaticMovement();\n          activeIndex = index;\n          showLoadingBar(index);\n          moveToNextItem();\n          startAutomaticMovement();\n        });\n      });\n    }\n  });\n}\n\n/**\n * Loads everything that happens a lot later,\n * without impacting the user experience.\n */\nfunction loadDelayed() {\n  window.setTimeout(() => {\n    window.hlx.plugins.load('delayed');\n    window.hlx.plugins.run('loadDelayed');\n    // load anything that can be postponed to the latest here\n    eventOnDropdownSlider();\n    // eslint-disable-next-line import/no-cycle\n    return import('./delayed.js');\n  }, 3000);\n}\n\nasync function loadPage() {\n  await window.hlx.plugins.load('eager');\n\n  // specific for webview\n  const urlParams = new URLSearchParams(window.location.search);\n  if (urlParams.get('theme') === 'dark' && window.location.href.includes('canvas')) {\n    document.body.style = 'background-color: #141517';\n  }\n\n  await loadEager(document);\n  await window.hlx.plugins.load('lazy');\n  await Constants.PRODUCT_ID_MAPPINGS_CALL;\n  // eslint-disable-next-line import/no-unresolved\n  await loadLazy(document);\n\n  await StoreResolver.resolve();\n  const elements = document.querySelectorAll('.await-loader');\n  document.dispatchEvent(new Event('bd_page_ready'));\n  window.bd_page_ready = true;\n  elements.forEach((element) => {\n    element.classList.remove('await-loader');\n  });\n\n  // loader circle used in mbox-canvas\n  const loaderCircle = document.querySelectorAll('.loader-circle');\n  loaderCircle.forEach((element) => {\n    element.classList.remove('loader-circle');\n  });\n\n  adobeMcAppendVisitorId('main');\n\n  pushTrialDownloadToDataLayer();\n  // eslint-disable-next-line import/no-unresolved\n  // const fpPromise = import('https://fpjscdn.net/v3/V9XgUXnh11vhRvHZw4dw')\n  //   .then((FingerprintJS) => FingerprintJS.load({\n  //     region: 'eu',\n  //   }));\n\n  // Get the visitorId when you need it.\n  // await fpPromise\n  //   .then((fp) => fp.get())\n  //   .then((result) => {\n  //     const { visitorId } = result;\n  //     AdobeDataLayerService.push(new VisitorIdEvent(visitorId));\n  //   });\n  AdobeDataLayerService.push(new PageLoadedEvent());\n\n  loadDelayed();\n}\n\ninitMobileDetector('mobile');\ninitMobileDetector('tablet');\ninitMobileDetector('desktop');\n\nloadPage();\n"],"file":"scripts/scripts.js"}