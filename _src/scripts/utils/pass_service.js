const c={passwordLength:16,includeLettersUppercase:!0,includeLettersLowercase:!0,includeNumbers:!0,includeSpecialChars:!0,passwordLettersUppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",passwordLettersLowercase:"abcdefghijklmnopqrstuvwxyz",passwordNumbers:"0123456789",passwordSpecialChars:"!@#$%^&*()_+-=[]{}|;:,.<>?"},e={minPasswordLength:8,maxPasswordLength:16,minVariationEnforcePasswordLength:15,minVariationLength:3,variationPenalty:.15,maxScore:100,minScore:0,weakMaxScore:20,poorMaxScore:40,goodMaxScore:80,newPasswordMaxDays:90,digitsKey:"digits",lowerKey:"lower",upperKey:"upper",nonWordsKey:"nonWords",passwordStrengthWeak:"weak",passwordStrengthPoor:"poor",passwordStrengthGood:"good",passwordStrengthStrong:"strong",adviceSetLongerPassword:"SET_LONGER_PASSWORD",adviceSetLongerOrMoreComplexPassword:"SET_LONGER_OR_MORE_COMPLEX_PASSWORD",adviceSetLongerPassword10:"SET_LONGER_PASSWORD_10"};function M(r){if(!r)return{score:e.minScore,advice:e.adviceSetLongerPassword,passwordLength:0,variationCount:0};const s={[e.digitsKey]:/\d/.test(r),[e.lowerKey]:/[a-z]/.test(r),[e.upperKey]:/[A-Z]/.test(r),[e.nonWordsKey]:/\W/.test(r)},n=Object.values(s).filter(Boolean).length;if(r.length<=e.minPasswordLength)return{score:e.minScore,advice:e.adviceSetLongerPassword,passwordLength:r.length,variationCount:n,minPasswordLength:e.minPasswordLength};if(r.length>=e.maxPasswordLength)return{score:e.maxScore,advice:"",passwordLength:r.length,variationCount:n,maxPasswordLength:e.maxPasswordLength};let t=(r.length-e.minPasswordLength)*e.maxScore/(e.maxPasswordLength-e.minPasswordLength);return r.length<=e.minVariationEnforcePasswordLength&&n<e.minVariationLength?(t=t*(1-(e.minVariationLength-n)*e.variationPenalty),t=Math.min(t,e.maxScore),t=Math.max(t,e.minScore),t=Math.round(t*10)/10,{score:t,advice:e.adviceSetLongerOrMoreComplexPassword,passwordLength:r.length,variationCount:n}):(t=Math.min(t,e.maxScore),t=Math.max(t,e.minScore),t=Math.round(t*10)/10,{score:t,advice:e.adviceSetLongerPassword10,passwordLength:r.length,variationCount:n})}function v(r){const s=r.score;return s==null||s<=e.weakMaxScore?e.passwordStrengthWeak:s<e.poorMaxScore?e.passwordStrengthPoor:s<e.goodMaxScore?e.passwordStrengthGood:e.passwordStrengthStrong}function m(r,s=c){if(4>s.passwordLength)return!0;const{includeLettersUppercase:n=!0,includeLettersLowercase:t=!0,includeNumbers:i=!0,includeSpecialChars:a=!0,passwordLettersUppercase:o="",passwordLettersLowercase:p="",passwordNumbers:g="",passwordSpecialChars:w=""}=s,h=r.match(new RegExp("(["+d(o)+"])","g")),l=r.match(new RegExp("(["+d(p)+"])","g")),L=r.match(new RegExp("(["+d(g)+"])","g")),S=r.match(new RegExp("(["+d(w)+"])","g")),P=n?o.length===0||h&&h.length>=1:!0,f=t?p.length===0||l&&l.length>=1:!0,x=i?g.length===0||L&&L.length>=1:!0,C=a?w.length===0||S&&S.length>=1:!0;return P&&f&&x&&C}function d(r){if(typeof r!="string")throw new TypeError("Expected a string");return r.replace(new RegExp("[|\\\\{}()[\\]^$+*?.-]","g"),"\\$&")}function u(r,s){const n=s.length;let t="";const i=new Uint32Array(1);for(let a=0;a<r;a++){window.crypto.getRandomValues(i);const o=Math.floor(i[0]/4294967295*n);t=t+s.charAt(o)}return t}function E(r,s,n,t,i){let a="";const o={passwordLength:r||c.passwordLength,passwordLettersUppercase:s||c.passwordLettersUppercase,passwordLettersLowercase:n||c.passwordLettersLowercase,passwordNumbers:t||c.passwordNumbers,passwordSpecialChars:i||c.passwordSpecialChars,includeLettersUppercase:!!s||c.includeLettersUppercase,includeLettersLowercase:!!n||c.includeLettersLowercase,includeNumbers:!!t||c.includeNumbers,includeSpecialChars:!!i||c.includeSpecialChars};for(;!m(a,o);)a=u(o.passwordLength,o.passwordLettersUppercase+o.passwordLettersLowercase+o.passwordNumbers+o.passwordSpecialChars);return a}function _(r=c){const{includeLettersUppercase:s=!0,includeLettersLowercase:n=!0,includeNumbers:t=!0,includeSpecialChars:i=!0}=r;let a="";s&&(a+=r.passwordLettersUppercase),n&&(a+=r.passwordLettersLowercase),t&&(a+=r.passwordNumbers),i&&(a+=r.passwordSpecialChars);let o="";for(;!m(o,r);)o=u(r.passwordLength,a);return o}function R(r,s,n,t){e.passwordStrengthWeak=r,e.passwordStrengthPoor=s,e.passwordStrengthGood=n,e.passwordStrengthStrong=t}const y={generatePassword:u,generate:E,generateWithSettings:_,ratePasswordFromPasswordInfo:M,fromRating:v,updatePasswordStrengthTexts:R,SecurityReportConstants:e};export{y as default};
//# sourceMappingURL=pass_service.js.map
