{"version":3,"file":"breadcrumbs.js","sources":["../../src/scripts/breadcrumbs.js"],"sourcesContent":["import {\n  createTag,\n  fetchIndex,\n  fixExcelFilterZeroes,\n  getDomain,\n  decorateBlockWithRegionId,\n} from './utils/utils.js';\n\nfunction prependSlash(path) {\n  return path.startsWith('/') ? path : `/${path}`;\n}\n\nfunction getName(pageIndex, path, part, current) {\n  const pg = pageIndex.find((page) => page.path.replace(/^\\/[^/]+/, '') === path.replace(/^\\/[^/]+/, ''));\n  if (pg && pg.breadcrumbtitle && pg.breadcrumbtitle !== '0') {\n    return pg.breadcrumbtitle;\n  }\n\n  if (pg && pg.title && pg.title !== '0') {\n    return pg.title;\n  }\n\n  if (current) {\n    return document.title;\n  }\n\n  return part;\n}\n\nfunction renderBreadcrumb(breadcrumbs) {\n  return createTag(\n    'a',\n    { href: breadcrumbs.url_path ? breadcrumbs.url_path : '#' },\n    breadcrumbs.name,\n  );\n}\n\nasync function createBreadcrumbs(container) {\n  const { pathname } = window.location;\n  const pathSeparator = '/';\n  // split pathname into parts add / at the end and remove empty parts\n  const domain = getDomain();\n  const pathSplit = pathname.split('/').filter((item) => item !== domain).reduce((acc, curr, index, array) => {\n    if (index < array.length - 1) {\n      acc.push(`${curr}/`);\n    } else if (curr !== '') {\n      acc.push(curr);\n    }\n    return acc;\n  }, []);\n\n  const pageIndex = (await fetchIndex('query-index')).data;\n  fixExcelFilterZeroes(pageIndex);\n  // eslint-disable-next-line max-len\n  const urlForIndex = (index) => prependSlash(pathSplit.slice(1, index + 2).join(pathSeparator));\n\n  const breadcrumbs = [\n    {\n      name: 'Home',\n      url_path: `/${domain}/`,\n    },\n    ...pathSplit.slice(1, -1).map((part, index) => {\n      const url = urlForIndex(index);\n      return {\n        name: getName(pageIndex, `/${domain}${url}`, part, false, domain),\n        url_path: `/${domain}${url}`,\n      };\n    }),\n    {\n      // get the breadcrumb title from the metadata; if the metadata does not contain it,\n      // the last part of the path is used as the breadcrumb title\n      name: getName(pageIndex, pathname, pathSplit[pathSplit.length - 1], true, domain),\n    },\n  ];\n\n  breadcrumbs.forEach((crumb) => {\n    if (crumb.name) {\n      container.append(renderBreadcrumb(crumb));\n    }\n  });\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport async function loadBreadcrumbs() {\n  const breadcrumb = document.querySelector('.breadcrumb');\n  decorateBlockWithRegionId(breadcrumb, 'Hero|Breadcrumb');\n\n  // check if breadcrumb div exists\n  if (breadcrumb) {\n    await createBreadcrumbs(breadcrumb);\n  }\n}\n"],"names":[],"mappings":"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"}